cscope 15 $HOME/Desktop/hao_dance/fraig -q 0000001035 0000144423
	@src/cir/cirCmd.cpp

9 
	~<ÿs£¹
>

10 
	~<io¡»am
>

11 
	~<iomª
>

12 
	~"cœMgr.h
"

13 
	~"cœG©e.h
"

14 
	~"cœCmd.h
"

15 
	~"utž.h
"

17 
usšg
 
Çme¥aû
 
	g¡d
;

19 
CœMgr
* 
cœMgr
;

20 
effLim™
;

22 
boÞ


23 
	$š™CœCmd
()

25 ià(!(
cmdMgr
->
	`»gCmd
("CIRR—d", 4, 
Ãw
 
CœR—dCmd
) &&

26 
cmdMgr
->
	`»gCmd
("CIRPršt", 4, 
Ãw
 
CœPrštCmd
) &&

27 
cmdMgr
->
	`»gCmd
("CIRG©e", 4, 
Ãw
 
CœG©eCmd
) &&

28 
cmdMgr
->
	`»gCmd
("CIRSW“p", 5, 
Ãw
 
CœSw“pCmd
) &&

29 
cmdMgr
->
	`»gCmd
("CIROPTimize", 6, 
Ãw
 
CœO±Cmd
) &&

30 
cmdMgr
->
	`»gCmd
("CIRSTRash", 6, 
Ãw
 
CœSŒashCmd
) &&

31 
cmdMgr
->
	`»gCmd
("CIRSIMuÏ‹", 6, 
Ãw
 
CœSimCmd
) &&

32 
cmdMgr
->
	`»gCmd
("CIRF¿ig", 4, 
Ãw
 
CœF¿igCmd
) &&

33 
cmdMgr
->
	`»gCmd
("CIRWr™e", 4, 
Ãw
 
CœWr™eCmd
)

35 
û¼
 << "Regi¡”šg \"cœ\" commªd çžs...ƒx™šg" << 
’dl
;

36  
çl£
;

38  
Œue
;

39 
	}
}

41 
	eCœCmdS‹


44 
	mCIRINIT
,

45 
	mCIRREAD
,

46 
	mCIROPT
,

47 
	mCIRSTRASH
,

48 
	mCIRSIMULATE
,

49 
	mCIRFRAIG
,

51 
	mCIRCMDTOT


54 
CœCmdS‹
 
	gcurCmd
 = 
CIRINIT
;

59 
CmdExecStus


60 
	gCœR—dCmd
::
	$exec
(cÚ¡ 
¡ršg
& 
ÝtiÚ
)

63 
veùÜ
<
¡ršg
> 
ÝtiÚs
;

64 ià(!
CmdExec
::
	`ËxO±iÚs
(
ÝtiÚ
, 
ÝtiÚs
))

65  
CMD_EXEC_ERROR
;

66 ià(
ÝtiÚs
.
	`em±y
())

67  
CmdExec
::
	`”rÜO±iÚ
(
CMD_OPT_MISSING
, "");

69 
boÞ
 
doR•Ïû
 = 
çl£
;

70 
¡ršg
 
fžeName
;

71 
size_t
 
i
 = 0, 
n
 = 
ÝtiÚs
.
	`size
(); i <‚; ++i) {

72 ià(
	`mySŒNCmp
("-R•Ïû", 
ÝtiÚs
[
i
], 2) == 0) {

73 ià(
doR•Ïû
è 
CmdExec
::
	`”rÜO±iÚ
(
CMD_OPT_EXTRA
,
ÝtiÚs
[
i
]);

74 
doR•Ïû
 = 
Œue
;

77 ià(
fžeName
.
	`size
())

78  
CmdExec
::
	`”rÜO±iÚ
(
CMD_OPT_ILLEGAL
, 
ÝtiÚs
[
i
]);

79 
fžeName
 = 
ÝtiÚs
[
i
];

83 ià(
cœMgr
 != 0) {

84 ià(
doR•Ïû
) {

85 
û¼
 << "NÙe: origš® cœcu™ i »¶aûd..." << 
’dl
;

86 
curCmd
 = 
CIRINIT
;

87 
d–‘e
 
cœMgr
; cirMgr = 0;

90 
û¼
 << "E¼Ü: cœcu™‡Ì—dyƒxi¡s!!" << 
’dl
;

91  
CMD_EXEC_ERROR
;

94 
cœMgr
 = 
Ãw
 
CœMgr
;

96 ià(!
cœMgr
->
	`»adCœcu™
(
fžeName
)) {

97 
curCmd
 = 
CIRINIT
;

98 
d–‘e
 
cœMgr
; cirMgr = 0;

99  
CMD_EXEC_ERROR
;

102 
curCmd
 = 
CIRREAD
;

104  
CMD_EXEC_DONE
;

105 
	}
}

108 
	gCœR—dCmd
::
	$u§ge
(
o¡»am
& 
os
) const

110 
os
 << "U§ge: CIRR—d <(¡ršg fžeName)> [-R•Ïû]" << 
’dl
;

111 
	}
}

114 
	gCœR—dCmd
::
	$h–p
() const

116 
cout
 << 
	`£tw
(15è<< 
Ëá
 << "CIRRead: "

117 << "»ad iÀ¨cœcu™‡nd cÚ¡ruùhÃŽi¡" << 
’dl
;

118 
	}
}

123 
CmdExecStus


124 
	gCœPrštCmd
::
	$exec
(cÚ¡ 
¡ršg
& 
ÝtiÚ
)

127 
¡ršg
 
tok’
;

128 ià(!
CmdExec
::
	`ËxSšgËO±iÚ
(
ÝtiÚ
, 
tok’
))

129  
CMD_EXEC_ERROR
;

131 ià(!
cœMgr
) {

132 
û¼
 << "E¼Ü: cœcu™ i nÙ y‘ cÚ¡ruùed!!" << 
’dl
;

133  
CMD_EXEC_ERROR
;

135 ià(
tok’
.
	`em±y
(è|| 
	`mySŒNCmp
("-Summary",oken, 2) == 0)

136 
cœMgr
->
	`´štSumm¬y
();

137 ià(
	`mySŒNCmp
("-N‘li¡", 
tok’
, 2) == 0)

138 
cœMgr
->
	`´štN‘li¡
();

139 ià(
	`mySŒNCmp
("-PI", 
tok’
, 3) == 0)

140 
cœMgr
->
	`´štPIs
();

141 ià(
	`mySŒNCmp
("-PO", 
tok’
, 3) == 0)

142 
cœMgr
->
	`´štPOs
();

143 ià(
	`mySŒNCmp
("-FLßtšg", 
tok’
, 3) == 0)

144 
cœMgr
->
	`´štFlßtG©es
();

145 ià(
	`mySŒNCmp
("-FEC·œs", 
tok’
, 4) == 0)

146 
cœMgr
->
	`´štFECPaœs
();

148  
CmdExec
::
	`”rÜO±iÚ
(
CMD_OPT_ILLEGAL
, 
tok’
);

150  
CMD_EXEC_DONE
;

151 
	}
}

154 
	gCœPrštCmd
::
	$u§ge
(
o¡»am
& 
os
) const

156 
os
 << "Usage: CIRPrint [-Summary | -Netlist | -PI | -PO | -FLoating "

157 << "| -FEC·œs]" << 
’dl
;

158 
	}
}

161 
	gCœPrštCmd
::
	$h–p
() const

163 
cout
 << 
	`£tw
(15è<< 
Ëá
 << "CIRPrint: " << "print circuit\n";

164 
	}
}

169 
CmdExecStus


170 
	gCœG©eCmd
::
	$exec
(cÚ¡ 
¡ršg
& 
ÝtiÚ
)

172 ià(!
cœMgr
) {

173 
û¼
 << "E¼Ü: cœcu™ ha nÙ b“À»ad!!" << 
’dl
;

174  
CMD_EXEC_ERROR
;

178 
veùÜ
<
¡ršg
> 
ÝtiÚs
;

179 ià(!
CmdExec
::
	`ËxO±iÚs
(
ÝtiÚ
, 
ÝtiÚs
))

180  
CMD_EXEC_ERROR
;

182 ià(
ÝtiÚs
.
	`em±y
())

183  
CmdExec
::
	`”rÜO±iÚ
(
CMD_OPT_MISSING
, "");

185 
g©eId
 = -1, 
Ëv–
 = 0;

186 
boÞ
 
doFªš
 = 
çl£
, 
doFªout
 = false;

187 
CœG©e
* 
thisG©e
 = 0;

188 
size_t
 
i
 = 0, 
n
 = 
ÝtiÚs
.
	`size
(); i <‚; ++i) {

189 
boÞ
 
checkLev–
 = 
çl£
;

190 ià(
	`mySŒNCmp
("-FANIn", 
ÝtiÚs
[
i
], 5) == 0) {

191 ià(
doFªš
 || 
doFªout
)

192  
CmdExec
::
	`”rÜO±iÚ
(
CMD_OPT_ILLEGAL
, 
ÝtiÚs
[
i
]);

193 
doFªš
 = 
Œue
;

194 
checkLev–
 = 
Œue
;

196 ià(
	`mySŒNCmp
("-FANOut", 
ÝtiÚs
[
i
], 5) == 0) {

197 ià(
doFªš
 || 
doFªout
)

198  
CmdExec
::
	`”rÜO±iÚ
(
CMD_OPT_ILLEGAL
, 
ÝtiÚs
[
i
]);

199 
doFªout
 = 
Œue
;

200 
checkLev–
 = 
Œue
;

202 ià(!
thisG©e
) {

203 ià(!
	`mySŒ2IÁ
(
ÝtiÚs
[
i
], 
g©eId
) || gateId < 0)

204  
CmdExec
::
	`”rÜO±iÚ
(
CMD_OPT_ILLEGAL
, 
ÝtiÚs
[
i
]);

205 
thisG©e
 = 
cœMgr
->
	`g‘G©e
(
g©eId
);

206 ià(!
thisG©e
) {

207 
û¼
 << "E¼Ü: G©e(" << 
g©eId
 << "ènÙ found!!" << 
’dl
;

208  
CmdExec
::
	`”rÜO±iÚ
(
CMD_OPT_ILLEGAL
, 
ÝtiÚs
[0]);

211 ià(
thisG©e
)

212  
CmdExec
::
	`”rÜO±iÚ
(
CMD_OPT_EXTRA
, 
ÝtiÚs
[
i
]);

214  
CmdExec
::
	`”rÜO±iÚ
(
CMD_OPT_ILLEGAL
, 
ÝtiÚs
[
i
]);

215 ià(
checkLev–
) {

216 ià(++
i
 =ð
n
)

217  
CmdExec
::
	`”rÜO±iÚ
(
CMD_OPT_MISSING
, 
ÝtiÚs
[
i
-1]);

218 ià(!
	`mySŒ2IÁ
(
ÝtiÚs
[
i
], 
Ëv–
) ||†evel < 0)

219  
CmdExec
::
	`”rÜO±iÚ
(
CMD_OPT_ILLEGAL
, 
ÝtiÚs
[
i
]);

220 
checkLev–
 = 
Œue
;

224 ià(!
thisG©e
) {

225 
û¼
 << "E¼Ü: G©id i nÙ s³cif›d!!" << 
’dl
;

226  
CmdExec
::
	`”rÜO±iÚ
(
CMD_OPT_MISSING
, 
ÝtiÚs
.
	`back
());

229 ià(
doFªš
)

230 
thisG©e
->
	`»pÜtFªš
(
Ëv–
);

231 ià(
doFªout
)

232 
thisG©e
->
	`»pÜtFªout
(
Ëv–
);

234 
thisG©e
->
	`»pÜtG©e
();

236  
CMD_EXEC_DONE
;

237 
	}
}

240 
	gCœG©eCmd
::
	$u§ge
(
o¡»am
& 
os
) const

242 
os
 << "Usage: CIRGate <<(int gateId)> [<-FANIn | -FANOut><(int†evel)>]>"

243 << 
’dl
;

244 
	}
}

247 
	gCœG©eCmd
::
	$h–p
() const

249 
cout
 << 
	`£tw
(15è<< 
Ëá
 << "CIRGate: " << "report‡ gate\n";

250 
	}
}

255 
CmdExecStus


256 
	gCœSw“pCmd
::
	$exec
(cÚ¡ 
¡ršg
& 
ÝtiÚ
)

258 ià(!
cœMgr
) {

259 
û¼
 << "E¼Ü: cœcu™ i nÙ y‘ cÚ¡ruùed!!" << 
’dl
;

260  
CMD_EXEC_ERROR
;

263 
veùÜ
<
¡ršg
> 
ÝtiÚs
;

264 
CmdExec
::
	`ËxO±iÚs
(
ÝtiÚ
, 
ÝtiÚs
);

266 ià(!
ÝtiÚs
.
	`em±y
())

267  
CmdExec
::
	`”rÜO±iÚ
(
CMD_OPT_EXTRA
, 
ÝtiÚs
[0]);

269 
	`as£¹
(
curCmd
 !ð
CIRINIT
);

270 
cœMgr
->
	`sw“p
();

272  
CMD_EXEC_DONE
;

273 
	}
}

276 
	gCœSw“pCmd
::
	$u§ge
(
o¡»am
& 
os
) const

278 
os
 << "U§ge: CIRSW“p" << 
’dl
;

279 
	}
}

282 
	gCœSw“pCmd
::
	$h–p
() const

284 
cout
 << 
	`£tw
(15è<< 
Ëá
 << "CIRSWeep: "

286 
	}
}

291 
CmdExecStus


292 
	gCœO±Cmd
::
	$exec
(cÚ¡ 
¡ršg
& 
ÝtiÚ
)

294 ià(!
cœMgr
) {

295 
û¼
 << "E¼Ü: cœcu™ i nÙ y‘ cÚ¡ruùed!!" << 
’dl
;

296  
CMD_EXEC_ERROR
;

299 
veùÜ
<
¡ršg
> 
ÝtiÚs
;

300 
CmdExec
::
	`ËxO±iÚs
(
ÝtiÚ
, 
ÝtiÚs
);

302 ià(!
ÝtiÚs
.
	`em±y
())

303  
CmdExec
::
	`”rÜO±iÚ
(
CMD_OPT_EXTRA
, 
ÝtiÚs
[0]);

305 
	`as£¹
(
curCmd
 !ð
CIRINIT
);

306 ià(
curCmd
 =ð
CIRSIMULATE
) {

307 
û¼
 << "Error: circuit has been simulated!! Do \"CIRFraig\" first!!"

308 << 
’dl
;

309  
CMD_EXEC_ERROR
;

311 
cœMgr
->
	`Ýtimize
();

312 
curCmd
 = 
CIROPT
;

314  
CMD_EXEC_DONE
;

315 
	}
}

318 
	gCœO±Cmd
::
	$u§ge
(
o¡»am
& 
os
) const

320 
os
 << "U§ge: CIROPTimize" << 
’dl
;

321 
	}
}

324 
	gCœO±Cmd
::
	$h–p
() const

326 
cout
 << 
	`£tw
(15è<< 
Ëá
 << "CIROPTimize: "

328 
	}
}

333 
CmdExecStus


334 
	gCœSŒashCmd
::
	$exec
(cÚ¡ 
¡ršg
& 
ÝtiÚ
)

336 ià(!
cœMgr
) {

337 
û¼
 << "E¼Ü: cœcu™ i nÙ y‘ cÚ¡ruùed!!" << 
’dl
;

338  
CMD_EXEC_ERROR
;

341 
veùÜ
<
¡ršg
> 
ÝtiÚs
;

342 
CmdExec
::
	`ËxO±iÚs
(
ÝtiÚ
, 
ÝtiÚs
);

344 ià(!
ÝtiÚs
.
	`em±y
())

345  
CmdExec
::
	`”rÜO±iÚ
(
CMD_OPT_EXTRA
, 
ÝtiÚs
[0]);

347 
	`as£¹
(
curCmd
 !ð
CIRINIT
);

348 ià(
curCmd
 =ð
CIRSTRASH
) {

349 
û¼
 << "E¼Ü: cœcu™ ha b“À¡¿shed!!" << 
’dl
;

350  
CMD_EXEC_ERROR
;

352 ià(
curCmd
 =ð
CIRSIMULATE
) {

353 
û¼
 << "Error: circuit has been simulated!! Do \"CIRFraig\" first!!"

354 << 
’dl
;

355  
CMD_EXEC_ERROR
;

357 
cœMgr
->
	`¡¿sh
();

358 
curCmd
 = 
CIRSTRASH
;

360  
CMD_EXEC_DONE
;

361 
	}
}

364 
	gCœSŒashCmd
::
	$u§ge
(
o¡»am
& 
os
) const

366 
os
 << "U§ge: CIRSTRash" << 
’dl
;

367 
	}
}

370 
	gCœSŒashCmd
::
	$h–p
() const

372 
cout
 << 
	`£tw
(15è<< 
Ëá
 << "CIRSTRash: "

374 
	}
}

380 
CmdExecStus


381 
	gCœSimCmd
::
	$exec
(cÚ¡ 
¡ršg
& 
ÝtiÚ
)

383 ià(!
cœMgr
) {

384 
û¼
 << "E¼Ü: cœcu™ i nÙ y‘ cÚ¡ruùed!!" << 
’dl
;

385  
CMD_EXEC_ERROR
;

388 
veùÜ
<
¡ršg
> 
ÝtiÚs
;

389 
CmdExec
::
	`ËxO±iÚs
(
ÝtiÚ
, 
ÝtiÚs
);

391 
if¡»am
 
·‰”nFže
;

392 
of¡»am
 
logFže
;

393 
boÞ
 
doRªdom
 = 
çl£
, 
doFže
 = f®£, 
doLog
 = false;

394 
size_t
 
i
 = 0, 
n
 = 
ÝtiÚs
.
	`size
(); i <‚; ++i) {

395 ià(
	`mySŒNCmp
("-Rªdom", 
ÝtiÚs
[
i
], 2) == 0) {

396 ià(
doRªdom
 || 
doFže
)

397  
CmdExec
::
	`”rÜO±iÚ
(
CMD_OPT_ILLEGAL
, 
ÝtiÚs
[
i
]);

398 
doRªdom
 = 
Œue
;

400 ià(
	`mySŒNCmp
("-Fže", 
ÝtiÚs
[
i
], 2) == 0) {

401 ià(
doRªdom
 || 
doFže
)

402  
CmdExec
::
	`”rÜO±iÚ
(
CMD_OPT_ILLEGAL
, 
ÝtiÚs
[
i
]);

403 ià(++
i
 =ð
n
)

404  
CmdExec
::
	`”rÜO±iÚ
(
CMD_OPT_MISSING
, 
ÝtiÚs
[
i
-1]);

405 
·‰”nFže
.
	`Ý’
(
ÝtiÚs
[
i
].
	`c_¡r
(), 
ios
::
š
);

406 ià(!
·‰”nFže
)

407  
CmdExec
::
	`”rÜO±iÚ
(
CMD_OPT_FOPEN_FAIL
, 
ÝtiÚs
[
i
]);

408 
doFže
 = 
Œue
;

410 ià(
	`mySŒNCmp
("-Ouut", 
ÝtiÚs
[
i
], 2) == 0) {

411 ià(
doLog
)

412  
CmdExec
::
	`”rÜO±iÚ
(
CMD_OPT_ILLEGAL
, 
ÝtiÚs
[
i
]);

413 ià(++
i
 =ð
n
)

414  
CmdExec
::
	`”rÜO±iÚ
(
CMD_OPT_MISSING
, 
ÝtiÚs
[
i
-1]);

415 
logFže
.
	`Ý’
(
ÝtiÚs
[
i
].
	`c_¡r
(), 
ios
::
out
);

416 ià(!
logFže
)

417  
CmdExec
::
	`”rÜO±iÚ
(
CMD_OPT_FOPEN_FAIL
, 
ÝtiÚs
[
i
]);

418 
doLog
 = 
Œue
;

421  
CmdExec
::
	`”rÜO±iÚ
(
CMD_OPT_ILLEGAL
, 
ÝtiÚs
[
i
]);

424 ià(!
doRªdom
 && !
doFže
)

425  
CmdExec
::
	`”rÜO±iÚ
(
CMD_OPT_MISSING
, "");

427 
	`as£¹
 (
curCmd
 !ð
CIRINIT
);

428 ià(
doLog
)

429 
cœMgr
->
	`£tSimLog
(&
logFže
);

430 
cœMgr
->
	`£tSimLog
(0);

432 ià(
doRªdom
)

433 
cœMgr
->
	`¿ndomSim
();

435 
cœMgr
->
	`fžeSim
(
·‰”nFže
);

436 
cœMgr
->
	`£tSimLog
(0);

437 
curCmd
 = 
CIRSIMULATE
;

439  
CMD_EXEC_DONE
;

440 
	}
}

443 
	gCœSimCmd
::
	$u§ge
(
o¡»am
& 
os
) const

445 
os
 << "Usage: CIRSIMulate <-Random | -File <string…atternFile>>\n"

446 << " [-Ouuˆ(¡ršg†ogFže)]" << 
’dl
;

447 
	}
}

450 
	gCœSimCmd
::
	$h–p
() const

452 
cout
 << 
	`£tw
(15è<< 
Ëá
 << "CIRSIMulate: "

454 
	}
}

459 
CmdExecStus


460 
	gCœF¿igCmd
::
	$exec
(cÚ¡ 
¡ršg
& 
ÝtiÚ
)

462 ià(!
cœMgr
) {

463 
û¼
 << "E¼Ü: cœcu™ i nÙ y‘ cÚ¡ruùed!!" << 
’dl
;

464  
CMD_EXEC_ERROR
;

467 
veùÜ
<
¡ršg
> 
ÝtiÚs
;

468 
CmdExec
::
	`ËxO±iÚs
(
ÝtiÚ
, 
ÝtiÚs
);

470 ià(!
ÝtiÚs
.
	`em±y
())

471  
CmdExec
::
	`”rÜO±iÚ
(
CMD_OPT_EXTRA
, 
ÝtiÚs
[0]);

473 ià(
curCmd
 !ð
CIRSIMULATE
) {

474 
û¼
 << "E¼Ü: cœcu™ i nÙ y‘ simuÏ‹d!!" << 
’dl
;

475  
CMD_EXEC_ERROR
;

477 
cœMgr
->
	`äaig
();

478 
curCmd
 = 
CIRFRAIG
;

480  
CMD_EXEC_DONE
;

481 
	}
}

484 
	gCœF¿igCmd
::
	$u§ge
(
o¡»am
& 
os
) const

486 
os
 << "U§ge: CIRF¿ig" << 
’dl
;

487 
	}
}

490 
	gCœF¿igCmd
::
	$h–p
() const

492 
cout
 << 
	`£tw
(15è<< 
Ëá
 << "CIRFraig: "

494 
	}
}

499 
CmdExecStus


500 
	gCœWr™eCmd
::
	$exec
(cÚ¡ 
¡ršg
& 
ÝtiÚ
)

502 ià(!
cœMgr
) {

503 
û¼
 << "E¼Ü: cœcu™ i nÙ y‘ cÚ¡ruùed!!" << 
’dl
;

504  
CMD_EXEC_ERROR
;

507 
veùÜ
<
¡ršg
> 
ÝtiÚs
;

508 
CmdExec
::
	`ËxO±iÚs
(
ÝtiÚ
, 
ÝtiÚs
);

510 ià(
ÝtiÚs
.
	`em±y
()) {

511 
cœMgr
->
	`wr™eAag
(
cout
);

512  
CMD_EXEC_DONE
;

514 
boÞ
 
hasFže
 = 
çl£
;

515 
g©eId
;

516 
CœG©e
 *
thisG©e
 = 
NULL
;

517 
of¡»am
 
outfže
;

518 
size_t
 
i
 = 0, 
n
 = 
ÝtiÚs
.
	`size
(); i <‚; ++i) {

519 ià(
	`mySŒNCmp
("-Ouut", 
ÝtiÚs
[
i
], 2) == 0) {

520 ià(
hasFže
)

521  
CmdExec
::
	`”rÜO±iÚ
(
CMD_OPT_EXTRA
, 
ÝtiÚs
[
i
]);

522 ià(++
i
 =ð
n
)

523  
CmdExec
::
	`”rÜO±iÚ
(
CMD_OPT_MISSING
, 
ÝtiÚs
[
i
-1]);

524 
outfže
.
	`Ý’
(
ÝtiÚs
[
i
].
	`c_¡r
(), 
ios
::
out
);

525 ià(!
outfže
)

526  
CmdExec
::
	`”rÜO±iÚ
(
CMD_OPT_FOPEN_FAIL
, 
ÝtiÚs
[1]);

527 
hasFže
 = 
Œue
;

529 ià(
	`mySŒ2IÁ
(
ÝtiÚs
[
i
], 
g©eId
) && gateId >= 0) {

530 ià(
thisG©e
 !ð
NULL
)

531  
CmdExec
::
	`”rÜO±iÚ
(
CMD_OPT_EXTRA
, 
ÝtiÚs
[
i
]);

532 
thisG©e
 = 
cœMgr
->
	`g‘G©e
(
g©eId
);

533 ià(!
thisG©e
) {

534 
û¼
 << "E¼Ü: G©e(" << 
g©eId
 << "ènÙ found!!" << 
’dl
;

535  
CmdExec
::
	`”rÜO±iÚ
(
CMD_OPT_ILLEGAL
, 
ÝtiÚs
[
i
]);

537 ià(!
thisG©e
->
	`isAig
()) {

538 
û¼
 << "E¼Ü: G©e(" << 
g©eId
 << "èi NOT‡ÀAIG!!" << 
’dl
;

539  
CmdExec
::
	`”rÜO±iÚ
(
CMD_OPT_ILLEGAL
, 
ÝtiÚs
[
i
]);

542  
CmdExec
::
	`”rÜO±iÚ
(
CMD_OPT_ILLEGAL
, 
ÝtiÚs
[
i
]);

545 ià(!
thisG©e
) {

546 
	`as£¹
 (
hasFže
);

547 
cœMgr
->
	`wr™eAag
(
outfže
);

549 ià(
hasFže
è
cœMgr
->
	`wr™eG©e
(
outfže
, 
thisG©e
);

550 
cœMgr
->
	`wr™eG©e
(
cout
, 
thisG©e
);

552  
CMD_EXEC_DONE
;

553 
	}
}

556 
	gCœWr™eCmd
::
	$u§ge
(
o¡»am
& 
os
) const

558 
os
 << "U§ge: CIRWr™[(šˆg©eId)][-Ouuˆ(¡ršg‡agFže)]" << 
’dl
;

559 
	}
}

562 
	gCœWr™eCmd
::
	$h–p
() const

564 
cout
 << 
	`£tw
(15è<< 
Ëá
 << "CIRWrite: "

566 
	}
}

	@src/cir/cirCmd.h

9 #iâdeà
CIR_CMD_H


10 
	#CIR_CMD_H


	)

12 
	~"cmdP¬£r.h
"

14 
CmdCÏss
(
CœR—dCmd
);

15 
CmdCÏss
(
CœPrštCmd
);

16 
CmdCÏss
(
CœG©eCmd
);

17 
CmdCÏss
(
CœSw“pCmd
);

18 
CmdCÏss
(
CœO±Cmd
);

19 
CmdCÏss
(
CœSŒashCmd
);

20 
CmdCÏss
(
CœSimCmd
);

21 
CmdCÏss
(
CœF¿igCmd
);

22 
CmdCÏss
(
CœWr™eCmd
);

	@src/cir/cirDef.h

9 #iâdeà
CIR_DEF_H


10 
	#CIR_DEF_H


	)

12 
	~<veùÜ
>

13 
	~"myHashM­.h
"

14 
	~<unÜd”ed_£t
>

15 
	~<£t
>

16 
	~<unÜd”ed_m­
>

17 
	~<iomª
>

19 
usšg
 
Çme¥aû
 
	g¡d
;

23 
þass
 
	gCœG©e
;

24 
þass
 
	gCœMgr
;

25 
þass
 
	gS©SÞv”
;

27 
	gveùÜ
<
	tCœG©e
*> 
	tG©eLi¡
;

28 
	gveùÜ
<> 
	tIdLi¡
;

29 
	gveùÜ
< 
	t·œ
<
	tCœG©e
*, CœG©e*> > 
	tCœG©ePaœLi¡
;

30 
	gunÜd”ed_£t
<> 
	tUnS‘
;

31 
	gunÜd”ed_m­
<, 
	tCœG©e
*> 
	tUnM­
;

33 
	eG©eTy³
{

34 
	mUNDEF_GATE
 = 0,

35 
	mPI_GATE
 = 1,

36 
	mPO_GATE
 = 2,

37 
	mAIG_GATE
 = 3,

38 
	mCONST_GATE
 = 4,

40 
	mTOT_GATE


	@src/cir/cirFraig.cpp

9 
	~<ÿs£¹
>

10 
	~"cœMgr.h
"

11 
	~"cœG©e.h
"

12 
	~"§t.h
"

13 
	~"myHashM­.h
"

14 
	~"utž.h
"

16 
usšg
 
Çme¥aû
 
	g¡d
;

35 
	gCœMgr
::
	$¡¿sh
()

37 
	`dfsSŒash
(
_piLi¡
, 
_myHashM­
);

38 
	}
}

40 
	gCœMgr
::
dfsSŒash
(cÚ¡ 
G©eLi¡
& 
sškLi¡
, 
HashM­
<
HashKey
, 
CœG©eV
>& 
hash
){

41 
UnS‘
 
	gdfsLi¡
;

42 
size_t
 
	gi
=0; i<
	g_dfsLi¡
.
size
(); ++i)

43 
	gdfsLi¡
.
š£¹
(
_dfsLi¡
[
i
]->
_id
);

45 
UnS‘
 
	gd–‘ed
;

46 
	gCœG©e
::
£tGlob®Ref
();

47 
size_t
 
	gi
=0; i<
	gsškLi¡
.
size
(); ++i)

48 
	gsškLi¡
[
i
]->
dfsSŒash
(
hash
, 
dfsLi¡
, 
d–‘ed
);

50 
	gUnS‘
::
™”©Ü
 
d–It
;

51 
	gd–It
=
d–‘ed
.
begš
(); d–It!=d–‘ed.
’d
(); ++delIt){

52 
CœG©e
* 
	gtmp
 = 
g‘G©e
(*
d–It
);

53 
d–‘e
 
	gtmp
;

54 
	gtmp
 = 0;

55 
	g_tÙ®Li¡
.
”a£
(*
d–It
);

58 
	g_dfsLi¡
.
þ—r
();

59 
	g_fbLi¡
.
þ—r
();

60 
dfsT¿v”§l
(
_poLi¡
);

64 
	gCœMgr
::
	$äaig
()

66 
	}
}

	@src/cir/cirGate.cpp

9 
	~<io¡»am
>

10 
	~<iomª
>

11 
	~<s¡»am
>

12 
	~<¡d¬g.h
>

13 
	~<ÿs£¹
>

14 
	~"cœG©e.h
"

15 
	~"cœMgr.h
"

16 
	~"utž.h
"

18 
usšg
 
Çme¥aû
 
	g¡d
;

24 
CœMgr
 *
cœMgr
;

25 
þass
 
	gHashKey
;

27 
	gCœG©e
::
_glob®Ref
 = 0;

33 
	gCœG©e
::
	$»pÜtG©e
() const

35 
i
=0; i<80; ++iè
cout
 << "=";

36 
cout
 << 
’dl
;

38 
cout
 << "ð" << 
this
->
	`g‘Ty³SŒ
(è<< "(" <<his->
_id
 << ")";

39 if(!
this
->
_symbÞ
.
	`em±y
()è
cout
 << "\"" <<his->_symbol << "\"";

40 
cout
 << ",†š" << 
this
->
_lše
 << 
’dl
;

42 
cout
 << "ðFECs:" << 
’dl
;

44 
cout
 << "ðV®ue:" << 
’dl
;

46 
i
=0; i<80; ++iè
cout
 << "=";

47 
cout
 << 
’dl
;

48 
	}
}

51 
	gCœG©e
::
	$»pÜtFªš
(
Ëv–
)

53 
	`as£¹
 (
Ëv–
 >= 0);

55 
UnS‘
 
uS‘
;

56 
	`´štFªš
(
this
, 
Ëv–
, 0, 
uS‘
, 0);

57 
	}
}

60 
	gCœG©e
::
	$»pÜtFªout
(
Ëv–
)

62 
	`as£¹
 (
Ëv–
 >= 0);

64 
UnS‘
 
uS‘
;

65 
	`´štFªout
(
this
, 
Ëv–
, 0, 
uS‘
, 0);

66 
	}
}

68 
	gCœG©e
::
	$´štG©e
(){

69 
cout
 << 
	`£tw
(4è<< 
Ëá
 << 
	`g‘Ty³SŒ
(è<< 
_id
;

70 
	`g‘Ty³
()){

71 
PI_GATE
:

73 if(!
_symbÞ
.
	`em±y
()è
cout
 << " (" << _symbol << ")";

76 
PO_GATE
:

78 
cout
 << " ";

79 
PoG©e
* 
poG©e
 = 
dyÇmic_ÿ¡
<PoG©e*>(
this
);

80 if(
poG©e
->
_çnšLi¡
[0].
	`isInv
()è
cout
 << "!";

81 
cout
 << 
poG©e
->
_çnšLi¡
[0].
	`g©e
()->
_id
;

82 if(!
_symbÞ
.
	`em±y
()è
cout
 << " (" << _symbol << ")";

85 
AIG_GATE
:

87 
AigG©e
* 
aigG©e
 = 
dyÇmic_ÿ¡
<AigG©e*>(
this
);

88 
i
=0; i<2; ++i){

89 
cout
 << " ";

90 if(
aigG©e
->
_çnšLi¡
[
i
].
	`isInv
()è
cout
 << "!";

91 
cout
 << 
aigG©e
->
_çnšLi¡
[
i
].
	`g©e
()->
_id
;

99 
cout
 << 
’dl
;

100 
	}
}

102 
	gCœG©e
::
	$´štFªš
(
CœG©e
* 
g©e
, & 
Ëv–
, 
Ëv–CouÁ
, 
UnS‘
& 
£t
, CœG©e* 
ogG©e
){

103 if(
Ëv–CouÁ
 > 
Ëv–
) ;

105 ++
Ëv–CouÁ
;

106 
i
=0; i<
Ëv–CouÁ
-1; ++iè
cout
 << " ";

108 
UnS‘
::
™”©Ü
 
™
;

109 
g©e
->
	`g‘Ty³
()){

110 
UNDEF_GATE
:

111 
CONST_GATE
:

112 
PI_GATE
:

114 if(
ogG©e
 == 0) {}

115 if(
ogG©e
->
	`g‘Ty³SŒ
() == "PO"){

116 if(
dyÇmic_ÿ¡
<
PoG©e
*>(
ogG©e
)->
_çnšLi¡
[0].
	`isInv
()è
cout
 << "!";

118 if(
ogG©e
->
	`g‘Ty³SŒ
() == "AIG"){

119 
AigG©e
* 
aigG©e
 = 
dyÇmic_ÿ¡
<AigG©e*>(
ogG©e
);

120 if(
aigG©e
->
_çnšLi¡
[0].
	`g©e
()==
g©e
 &&‡igG©e->_çnšLi¡[0].
	`isInv
()è
cout
 << "!";

121 if(
aigG©e
->
_çnšLi¡
[1].
	`g©e
()==
g©e
 &&‡igG©e->_çnšLi¡[1].
	`isInv
()è
cout
 << "!";

124 if(
ogG©e
è
£t
.
	`š£¹
(ogG©e->
_id
);

125 
cout
 << 
g©e
->
	`g‘Ty³SŒ
(è<< " " << g©e->
_id
 << 
’dl
;

129 
PO_GATE
:

131 
™
 = 
£t
.
	`fšd
(
g©e
->
_id
);

132 if(
™
 !ð
£t
.
	`’d
())

133 
cout
 << "PO " << 
g©e
->
_id
 << " (*)" << 
’dl
;

135 
cout
 << "PO " << 
g©e
->
_id
 << 
’dl
;

136 if(
ogG©e
è
£t
.
	`š£¹
(ogG©e->
_id
);

137 
PoG©e
* 
poG©e
 = 
dyÇmic_ÿ¡
<PoG©e*>(
g©e
);

138 
	`´štFªš
(
poG©e
->
_çnšLi¡
[0].
	`g©e
(), 
Ëv–
, 
Ëv–CouÁ
, 
£t
, 
g©e
);

143 
AIG_GATE
:

145 if(
ogG©e
 == 0) {}

146 if(
ogG©e
->
	`g‘Ty³SŒ
() == "PO"){

147 if(
dyÇmic_ÿ¡
<
PoG©e
*>(
ogG©e
)->
_çnšLi¡
[0].
	`isInv
()è
cout
 << "!";

149 if(
ogG©e
->
	`g‘Ty³SŒ
() == "AIG"){

150 
AigG©e
* 
aigG©e
 = 
dyÇmic_ÿ¡
<AigG©e*>(
ogG©e
);

151 if(
aigG©e
->
_çnšLi¡
[0].
	`g©e
()==
g©e
 &&‡igG©e->_çnšLi¡[0].
	`isInv
()è
cout
 << "!";

152 if(
aigG©e
->
_çnšLi¡
[1].
	`g©e
()==
g©e
 &&‡igG©e->_çnšLi¡[1].
	`isInv
()è
cout
 << "!";

155 
™
 = 
£t
.
	`fšd
(
g©e
->
_id
);

156 if(
™
 !ð
£t
.
	`’d
())

157 
cout
 << "AIG " << 
g©e
->
_id
 << " (*)" << 
’dl
;

159 
cout
 << "AIG " << 
g©e
->
_id
 << 
’dl
;

160 if(
ogG©e
è
£t
.
	`š£¹
(ogG©e->
_id
);

161 
AigG©e
* 
aigG©e
 = 
dyÇmic_ÿ¡
<AigG©e*>(
g©e
);

162 
i
=0; i<2; ++i)

163 
	`´štFªš
(
aigG©e
->
_çnšLi¡
[
i
].
	`g©e
(), 
Ëv–
, 
Ëv–CouÁ
, 
£t
, 
g©e
);

171 
	}
}

173 
	gCœG©e
::
	$´štFªout
(
CœG©e
* 
g©e
, & 
Ëv–
, 
Ëv–CouÁ
, 
UnS‘
& 
£t
, CœG©e* 
ogG©e
){

174 if(
Ëv–CouÁ
 > 
Ëv–
) ;

176 ++
Ëv–CouÁ
;

177 
i
=0; i<
Ëv–CouÁ
-1; ++iè
cout
 << " ";

179 
UnS‘
::
™”©Ü
 
™
;

180 
g©e
->
	`g‘Ty³
()){

181 
PO_GATE
:

183 if(
ogG©e
 == 0) {}

184 if(
dyÇmic_ÿ¡
<
PoG©e
*>(
g©e
)->
_çnšLi¡
[0].
	`isInv
()è
cout
 << "!";

186 if(
ogG©e
è
£t
.
	`š£¹
(ogG©e->
_id
);

187 
cout
 << "PO " << 
g©e
->
_id
 << 
’dl
;

191 
AIG_GATE
:

193 
AigG©e
* 
aigG©e
 = 
dyÇmic_ÿ¡
<AigG©e*>(
g©e
);

194 if(
ogG©e
 == 0) {}

195 if(
aigG©e
->
_çnšLi¡
[0].
	`g©e
()==
ogG©e
 &&‡igG©e->_çnšLi¡[0].
	`isInv
()è
cout
 << "!";

196 if(
aigG©e
->
_çnšLi¡
[1].
	`g©e
()==
ogG©e
 &&‡igG©e->_çnšLi¡[1].
	`isInv
()è
cout
 << "!";

198 
™
 = 
£t
.
	`fšd
(
g©e
->
_id
);

199 if(
™
 !ð
£t
.
	`’d
())

200 
cout
 << "AIG " << 
g©e
->
_id
 << " (*)" << 
’dl
;

202 
cout
 << "AIG " << 
g©e
->
_id
 << 
’dl
;

203 if(
ogG©e
è
£t
.
	`š£¹
(ogG©e->
_id
);

204 
i
=
aigG©e
->
_çnoutLi¡
.
	`size
()-1; i>=0; --i)

205 
	`´štFªout
(
aigG©e
->
_çnoutLi¡
[
i
], 
Ëv–
, 
Ëv–CouÁ
, 
£t
, 
g©e
);

210 
PI_GATE
:

212 
™
 = 
£t
.
	`fšd
(
g©e
->
_id
);

213 if(
™
 !ð
£t
.
	`’d
())

214 
cout
 << "PI " << 
g©e
->
_id
 << " (*)" << 
’dl
;

216 
cout
 << "PI " << 
g©e
->
_id
 << 
’dl
;

217 if(
ogG©e
è
£t
.
	`š£¹
(ogG©e->
_id
);

218 
PiG©e
* 
piG©e
 = 
dyÇmic_ÿ¡
<PiG©e*>(
g©e
);

219 
i
=
piG©e
->
_çnoutLi¡
.
	`size
()-1; i>=0; --i)

220 
	`´štFªout
(
piG©e
->
_çnoutLi¡
[
i
], 
Ëv–
, 
Ëv–CouÁ
, 
£t
, 
g©e
);

225 
CONST_GATE
:

227 
™
 = 
£t
.
	`fšd
(
g©e
->
_id
);

228 if(
™
 !ð
£t
.
	`’d
())

229 
cout
 << "CONST " << 
g©e
->
_id
 << " (*)" << 
’dl
;

231 
cout
 << "CONST " << 
g©e
->
_id
 << 
’dl
;

232 if(
ogG©e
è
£t
.
	`š£¹
(ogG©e->
_id
);

233 
CÚ¡G©e
* 
cÚ¡G©e
 = 
dyÇmic_ÿ¡
<CÚ¡G©e*>(
g©e
);

234 
i
=
cÚ¡G©e
->
_çnoutLi¡
.
	`size
()-1; i>=0; --i)

235 
	`´štFªout
(
cÚ¡G©e
->
_çnoutLi¡
[
i
], 
Ëv–
, 
Ëv–CouÁ
, 
£t
, 
g©e
);

240 
UNDEF_GATE
:

242 
™
 = 
£t
.
	`fšd
(
g©e
->
_id
);

243 if(
™
 !ð
£t
.
	`’d
())

244 
cout
 << "UNDEF " << 
g©e
->
_id
 << " (*)" << 
’dl
;

246 
cout
 << "UNDEF " << 
g©e
->
_id
 << 
’dl
;

247 if(
ogG©e
è
£t
.
	`š£¹
(ogG©e->
_id
);

248 
UndefG©e
* 
undefG©e
 = 
dyÇmic_ÿ¡
<UndefG©e*>(
g©e
);

249 
i
=
undefG©e
->
_çnoutLi¡
.
	`size
()-1; i>=0; --i)

250 
	`´štFªout
(
undefG©e
->
_çnoutLi¡
[
i
], 
Ëv–
, 
Ëv–CouÁ
, 
£t
, 
g©e
);

258 
	}
}

260 
	gCœG©e
::
	$dfsT¿v”§l
(
G©eLi¡
& 
dfsLi¡
, 
CœG©ePaœLi¡
& 
fbLi¡
){

261 
	`as£¹
(
this
 != 0);

263 
this
->
	`g‘Ty³
()){

264 
UNDEF_GATE
:

266 
PI_GATE
:

267 
CONST_GATE
:

269 
dfsLi¡
.
	`push_back
(
this
);

272 
PO_GATE
:

274 
PoG©e
* 
poG©e
 = 
dyÇmic_ÿ¡
<PoG©e*>(
this
);

275 
size_t
 
i
=0; i<
poG©e
->
_çnšLi¡
.
	`size
(); ++i){

276 if(!
poG©e
->
_çnšLi¡
[
i
].
	`g©e
()->
	`isGlob®Ref
()){

277 
poG©e
->
_çnšLi¡
[
i
].
	`g©e
()->
	`£tToGlob®Ref
();

278 
poG©e
->
_aùive
 = 
Œue
;

279 
poG©e
->
_çnšLi¡
[
i
].
	`g©e
()->
	`dfsT¿v”§l
(
dfsLi¡
, 
fbLi¡
);

280 
poG©e
->
_aùive
 = 
çl£
;

282 if(
poG©e
->
_çnšLi¡
[
i
].
	`g©e
()->
_aùive
)

283 
fbLi¡
.
	`push_back
(
	`make_·œ
(
this
, 
poG©e
->
_çnšLi¡
[
i
].
	`g©e
()));

286 
dfsLi¡
.
	`push_back
(
this
);

289 
AIG_GATE
:

291 
AigG©e
* 
aigG©e
 = 
dyÇmic_ÿ¡
<AigG©e*>(
this
);

292 
size_t
 
i
=0; i<
aigG©e
->
_çnšLi¡
.
	`size
(); ++i){

293 if(!
aigG©e
->
_çnšLi¡
[
i
].
	`g©e
()->
	`isGlob®Ref
()){

294 
aigG©e
->
_çnšLi¡
[
i
].
	`g©e
()->
	`£tToGlob®Ref
();

295 
aigG©e
->
_aùive
 = 
Œue
;

296 
aigG©e
->
_çnšLi¡
[
i
].
	`g©e
()->
	`dfsT¿v”§l
(
dfsLi¡
, 
fbLi¡
);

297 
aigG©e
->
_aùive
 = 
çl£
;

299 if(
aigG©e
->
_çnšLi¡
[
i
].
	`g©e
()->
_aùive
)

300 
fbLi¡
.
	`push_back
(
	`make_·œ
(
this
, 
aigG©e
->
_çnšLi¡
[
i
].
	`g©e
()));

303 
dfsLi¡
.
	`push_back
(
this
);

309 
	}
}

311 
	gCœG©e
::
	$dfsO±imize
(
UnS‘
& 
d–‘ed
){

312 
this
->
	`g‘Ty³
()){

313 
AIG_GATE
:

315 
AigG©e
* 
aigG©e
 = 
dyÇmic_ÿ¡
<AigG©e*>(
this
);

316 
size_t
 
i
=0; i<
aigG©e
->
_çnšLi¡
.
	`size
(); ++i){

317 if(!
aigG©e
->
_çnšLi¡
[
i
].
	`g©e
()->
	`isGlob®Ref
()){

318 
aigG©e
->
_çnšLi¡
[
i
].
	`g©e
()->
	`£tToGlob®Ref
();

319 
aigG©e
->
_aùive
 = 
Œue
;

320 
aigG©e
->
_çnšLi¡
[
i
].
	`g©e
()->
	`dfsO±imize
(
d–‘ed
);

321 
aigG©e
->
_aùive
 = 
çl£
;

324 
aigG©e
->
	`sim¶ifyCÚ¡
(
d–‘ed
);

325 
aigG©e
->
	`sim¶ifyFªš
(
d–‘ed
);

329 
PO_GATE
:

331 
PoG©e
* 
poG©e
 = 
dyÇmic_ÿ¡
<PoG©e*>(
this
);

332 
size_t
 
i
=0; i<
poG©e
->
_çnšLi¡
.
	`size
(); ++i){

333 if(!
poG©e
->
_çnšLi¡
[
i
].
	`g©e
()->
	`isGlob®Ref
()){

334 
poG©e
->
_çnšLi¡
[
i
].
	`g©e
()->
	`£tToGlob®Ref
();

335 
poG©e
->
_aùive
 = 
Œue
;

336 
poG©e
->
_çnšLi¡
[
i
].
	`g©e
()->
	`dfsO±imize
(
d–‘ed
);

337 
poG©e
->
_aùive
 = 
çl£
;

346 
	}
}

348 
	gAigG©e
::
	$sim¶ifyCÚ¡
(
UnS‘
& 
d–‘ed
){

349 
AigG©e
* 
aigG©e
 = 
dyÇmic_ÿ¡
<AigG©e*>(
this
);

350 
boÞ
 
hasCÚ¡0
 = 
çl£
, 
hasCÚ¡1
 = false;

351 
id0
 = -1, 
id1
 = -1;

353 
i
=0; i<2; ++i)

354 if(
aigG©e
->
_çnšLi¡
[
i
].
	`g©e
()->
	`g‘Ty³SŒ
() == "CONST"){

355 if(
aigG©e
->
_çnšLi¡
[
i
].
	`isInv
()è{ 
hasCÚ¡1
 = 
Œue
; 
id1
 = i; }

356 { 
hasCÚ¡0
 = 
Œue
; 
id0
 = 
i
; }

359 if(
hasCÚ¡0
){

360 
	`as£¹
(
id0
 >= 0);

362 
UnS‘
::
™”©Ü
 
™
 = 
d–‘ed
.
	`fšd
(
this
->
_id
);

363 if(
™
 =ð
d–‘ed
.
	`’d
()){

364 
d–‘ed
.
	`š£¹
(
this
->
_id
);

365 
cout
 << "Sim¶ifyšg: 0 m”gšg " << 
this
->
_id
 << "..." << 
’dl
;

369 
CÚ¡G©e
* 
cÚ¡G©e
 = 
dyÇmic_ÿ¡
<CÚ¡G©e*>(
aigG©e
->
_çnšLi¡
[
id0
].
	`g©e
());

370 
size_t
 
i
=0; i<
cÚ¡G©e
->
_çnoutLi¡
.
	`size
(); ++i)

371 if(
cÚ¡G©e
->
_çnoutLi¡
[
i
] =ð
this
){

372 
cÚ¡G©e
->
_çnoutLi¡
.
	`”a£
(cÚ¡G©e->_çnoutLi¡.
	`begš
()+
i
);

375 
size_t
 
i
=0; i<
aigG©e
->
_çnoutLi¡
.
	`size
(); ++i)

376 
cÚ¡G©e
->
_çnoutLi¡
.
	`push_back
(
aigG©e
->_çnoutLi¡[
i
]);

379 
size_t
 
i
=0; i<
aigG©e
->
_çnoutLi¡
.
	`size
(); ++i){

380 
aigG©e
->
_çnoutLi¡
[
i
]->
	`g‘Ty³
()){

381 
AIG_GATE
:

383 
AigG©e
* 
ÃxtG©e
 = 
dyÇmic_ÿ¡
<AigG©e*>(
aigG©e
->
_çnoutLi¡
[
i
]);

384 
size_t
 
j
=0; j<2; ++j)

385 if(
ÃxtG©e
->
_çnšLi¡
[
j
].
	`g©e
(è=ð
this
){

386 if(
ÃxtG©e
->
_çnšLi¡
[
j
].
	`isInv
()){

387 
ÃxtG©e
->
_çnšLi¡
[
j
].
	`£tG©e
(
aigG©e
->_çnšLi¡[
id0
].
	`g©e
(), 
Œue
);

388 
ÃxtG©e
->
_çnš
[
j
] = 1;

391 
ÃxtG©e
->
_çnšLi¡
[
j
].
	`£tG©e
(
aigG©e
->_çnšLi¡[
id0
].
	`g©e
(), 
çl£
);

392 
ÃxtG©e
->
_çnš
[
j
] = 0;

398 
PO_GATE
:

400 
PoG©e
* 
ÃxtG©e
 = 
dyÇmic_ÿ¡
<PoG©e*>(
aigG©e
->
_çnoutLi¡
[
i
]);

401 if(
ÃxtG©e
->
_çnšLi¡
[0].
	`g©e
(è=ð
this
){

402 if(
ÃxtG©e
->
_çnšLi¡
[0].
	`isInv
()){

403 
ÃxtG©e
->
_çnšLi¡
[0].
	`£tG©e
(
aigG©e
->_çnšLi¡[
id0
].
	`g©e
(), 
Œue
);

404 
ÃxtG©e
->
_çnš
[0] = 1;

407 
ÃxtG©e
->
_çnšLi¡
[0].
	`£tG©e
(
aigG©e
->_çnšLi¡[
id0
].
	`g©e
(), 
çl£
);

408 
ÃxtG©e
->
_çnš
[0] = 1;

420 if(
hasCÚ¡1
){

421 
	`as£¹
(
id1
 >= 0);

423 
UnS‘
::
™”©Ü
 
™
 = 
d–‘ed
.
	`fšd
(
this
->
_id
);

424 if(
™
 =ð
d–‘ed
.
	`’d
()){

425 
d–‘ed
.
	`š£¹
(
this
->
_id
);

426 
cout
 << "Sim¶ifyšg: " << 
aigG©e
->
_çnšLi¡
[1-
id1
].
	`g©e
()->
_id
 << " merging ";

427 if(
aigG©e
->
_çnšLi¡
[1-
id1
].
	`isInv
()è
cout
 << "!";

428 
cout
 << 
this
->
_id
 << "..." << 
’dl
;

432 
CÚ¡G©e
* 
cÚ¡G©e
 = 
dyÇmic_ÿ¡
<CÚ¡G©e*>(
aigG©e
->
_çnšLi¡
[
id1
].
	`g©e
());

433 
size_t
 
i
=0; i<
cÚ¡G©e
->
_çnoutLi¡
.
	`size
(); ++i)

434 if(
cÚ¡G©e
->
_çnoutLi¡
[
i
] =ð
this
){

435 
cÚ¡G©e
->
_çnoutLi¡
.
	`”a£
(cÚ¡G©e->_çnoutLi¡.
	`begš
()+
i
);

439 
aigG©e
->
_çnšLi¡
[1-
id1
].
	`g©e
()->
	`g‘Ty³
()){

440 
UNDEF_GATE
:

442 
UndefG©e
* 
´evG©e
 = 
dyÇmic_ÿ¡
<UndefG©e*>(
aigG©e
->
_çnšLi¡
[1-
id1
].
	`g©e
());

443 
size_t
 
i
=0; i<
´evG©e
->
_çnoutLi¡
.
	`size
(); ++i)

444 if(
´evG©e
->
_çnoutLi¡
[
i
] =ð
this
){

445 
´evG©e
->
_çnoutLi¡
.
	`”a£
Õ»vG©e->_çnoutLi¡.
	`begš
()+
i
);

449 
size_t
 
i
=0; i<
aigG©e
->
_çnoutLi¡
.
	`size
(); ++i)

450 
´evG©e
->
_çnoutLi¡
.
	`push_back
(
aigG©e
->_çnoutLi¡[
i
]);

454 
PI_GATE
:

456 
PiG©e
* 
´evG©e
 = 
dyÇmic_ÿ¡
<PiG©e*>(
aigG©e
->
_çnšLi¡
[1-
id1
].
	`g©e
());

457 
size_t
 
i
=0; i<
´evG©e
->
_çnoutLi¡
.
	`size
(); ++i)

458 if(
´evG©e
->
_çnoutLi¡
[
i
] =ð
this
){

459 
´evG©e
->
_çnoutLi¡
.
	`”a£
Õ»vG©e->_çnoutLi¡.
	`begš
()+
i
);

463 
size_t
 
i
=0; i<
aigG©e
->
_çnoutLi¡
.
	`size
(); ++i)

464 
´evG©e
->
_çnoutLi¡
.
	`push_back
(
aigG©e
->_çnoutLi¡[
i
]);

468 
AIG_GATE
:

470 
AigG©e
* 
´evG©e
 = 
dyÇmic_ÿ¡
<AigG©e*>(
aigG©e
->
_çnšLi¡
[1-
id1
].
	`g©e
());

471 
size_t
 
i
=0; i<
´evG©e
->
_çnoutLi¡
.
	`size
(); ++i)

472 if(
´evG©e
->
_çnoutLi¡
[
i
] =ð
this
){

473 
´evG©e
->
_çnoutLi¡
.
	`”a£
Õ»vG©e->_çnoutLi¡.
	`begš
()+
i
);

477 
size_t
 
i
=0; i<
aigG©e
->
_çnoutLi¡
.
	`size
(); ++i)

478 
´evG©e
->
_çnoutLi¡
.
	`push_back
(
aigG©e
->_çnoutLi¡[
i
]);

482 
CONST_GATE
:

484 
CÚ¡G©e
* 
´evG©e
 = 
dyÇmic_ÿ¡
<CÚ¡G©e*>(
aigG©e
->
_çnšLi¡
[1-
id1
].
	`g©e
());

485 
size_t
 
i
=0; i<
´evG©e
->
_çnoutLi¡
.
	`size
(); ++i)

486 if(
´evG©e
->
_çnoutLi¡
[
i
] =ð
this
){

487 
´evG©e
->
_çnoutLi¡
.
	`”a£
Õ»vG©e->_çnoutLi¡.
	`begš
()+
i
);

491 
size_t
 
i
=0; i<
aigG©e
->
_çnoutLi¡
.
	`size
(); ++i)

492 
´evG©e
->
_çnoutLi¡
.
	`push_back
(
aigG©e
->_çnoutLi¡[
i
]);

501 
size_t
 
i
=0; i<
aigG©e
->
_çnoutLi¡
.
	`size
(); ++i){

502 
aigG©e
->
_çnoutLi¡
[
i
]->
	`g‘Ty³
()){

503 
AIG_GATE
:

505 
AigG©e
* 
ÃxtG©e
 = 
dyÇmic_ÿ¡
<AigG©e*>(
aigG©e
->
_çnoutLi¡
[
i
]);

506 
j
=0; j<2; ++j)

507 if(
ÃxtG©e
->
_çnšLi¡
[
j
].
	`g©e
(è=ð
this
){

508 if((
ÃxtG©e
->
_çnšLi¡
[
j
].
	`isInv
(è&& 
aigG©e
->_çnšLi¡[1-
id1
].isInv())

509 || (!
ÃxtG©e
->
_çnšLi¡
[
j
].
	`isInv
(è&& !
aigG©e
->_çnšLi¡[1-
id1
].isInv())){

510 
ÃxtG©e
->
_çnšLi¡
[
j
].
	`£tG©e
(
aigG©e
->_çnšLi¡[1-
id1
].
	`g©e
(), 
çl£
);

511 
ÃxtG©e
->
_çnš
[
j
] = 2*
aigG©e
->
_çnšLi¡
[1-
id1
].
	`g©e
()->
_id
;

514 
ÃxtG©e
->
_çnšLi¡
[
j
].
	`£tG©e
(
aigG©e
->_çnšLi¡[1-
id1
].
	`g©e
(), 
Œue
);

515 
ÃxtG©e
->
_çnš
[
j
] = 2*
aigG©e
->
_çnšLi¡
[1-
id1
].
	`g©e
()->
_id
+1;

521 
PO_GATE
:

523 
PoG©e
* 
ÃxtG©e
 = 
dyÇmic_ÿ¡
<PoG©e*>(
aigG©e
->
_çnoutLi¡
[
i
]);

524 
	`as£¹
(
ÃxtG©e
->
_çnšLi¡
[0].
	`g©e
(è=ð
this
);

525 if((
ÃxtG©e
->
_çnšLi¡
[0].
	`isInv
(è&& 
aigG©e
->_çnšLi¡[1-
id1
].isInv())

526 || (!
ÃxtG©e
->
_çnšLi¡
[0].
	`isInv
(è&& !
aigG©e
->_çnšLi¡[1-
id1
].isInv())){

527 
ÃxtG©e
->
_çnšLi¡
[0].
	`£tG©e
(
aigG©e
->_çnšLi¡[1-
id1
].
	`g©e
(), 
çl£
);

528 
ÃxtG©e
->
_çnš
[0] = 2*
aigG©e
->
_çnšLi¡
[1-
id1
].
	`g©e
()->
_id
;

531 
ÃxtG©e
->
_çnšLi¡
[0].
	`£tG©e
(
aigG©e
->_çnšLi¡[1-
id1
].
	`g©e
(), 
Œue
);

532 
ÃxtG©e
->
_çnš
[0] = 2*
aigG©e
->
_çnšLi¡
[1-
id1
].
	`g©e
()->
_id
+1;

542 
	}
}

544 
	gAigG©e
::
	$sim¶ifyFªš
(
UnS‘
& 
d–‘ed
){

545 
AigG©e
* 
aigG©e
 = 
dyÇmic_ÿ¡
<AigG©e*>(
this
);

547 if((
aigG©e
->
_çnšLi¡
[0].
	`g©e
() ==‡igGate->_faninList[1].gate())

548 && (
aigG©e
->
_çnšLi¡
[0].
	`isInv
() ==‡igGate->_faninList[1].isInv())){

549 
UnS‘
::
™”©Ü
 
™
 = 
d–‘ed
.
	`fšd
(
this
->
_id
);

550 if(
™
 =ð
d–‘ed
.
	`’d
()){

551 
d–‘ed
.
	`š£¹
(
this
->
_id
);

552 
cout
 << "Sim¶ifyšg: " << 
aigG©e
->
_çnšLi¡
[0].
	`g©e
()->
_id
 << " merging ";

553 if(
aigG©e
->
_çnšLi¡
[0].
	`isInv
()è
cout
 << "!";

554 
cout
 << 
this
->
_id
 << "..." << 
’dl
;

556 
boÞ
 
šv
 = 
aigG©e
->
_çnšLi¡
[0].
	`isInv
();

559 
aigG©e
->
_çnšLi¡
[0].
	`g©e
()->
	`g‘Ty³
()){

560 
CONST_GATE
:

562 
CÚ¡G©e
* 
´evG©e
 = 
dyÇmic_ÿ¡
<CÚ¡G©e*>(
aigG©e
->
_çnšLi¡
[0].
	`g©e
());

563 
size_t
 
i
=0; i<
´evG©e
->
_çnoutLi¡
.
	`size
(); ++i)

564 if(
´evG©e
->
_çnoutLi¡
[
i
] =ð
this
){

565 
´evG©e
->
_çnoutLi¡
.
	`”a£
Õ»vG©e->_çnoutLi¡.
	`begš
()+
i
);

568 
size_t
 
i
=0; i<
aigG©e
->
_çnoutLi¡
.
	`size
(); ++i)

569 
´evG©e
->
_çnoutLi¡
.
	`push_back
(
aigG©e
->_çnoutLi¡[
i
]);

573 
PI_GATE
:

575 
PiG©e
* 
´evG©e
 = 
dyÇmic_ÿ¡
<PiG©e*>(
aigG©e
->
_çnšLi¡
[0].
	`g©e
());

576 
size_t
 
i
=0; i<
´evG©e
->
_çnoutLi¡
.
	`size
(); ++i)

577 if(
´evG©e
->
_çnoutLi¡
[
i
] =ð
this
){

578 
´evG©e
->
_çnoutLi¡
.
	`”a£
Õ»vG©e->_çnoutLi¡.
	`begš
()+
i
);

581 
size_t
 
i
=0; i<
aigG©e
->
_çnoutLi¡
.
	`size
(); ++i)

582 
´evG©e
->
_çnoutLi¡
.
	`push_back
(
aigG©e
->_çnoutLi¡[
i
]);

586 
AIG_GATE
:

588 
AigG©e
* 
´evG©e
 = 
dyÇmic_ÿ¡
<AigG©e*>(
aigG©e
->
_çnšLi¡
[0].
	`g©e
());

589 
size_t
 
i
=0; i<
´evG©e
->
_çnoutLi¡
.
	`size
(); ++i)

590 if(
´evG©e
->
_çnoutLi¡
[
i
] =ð
this
){

591 
´evG©e
->
_çnoutLi¡
.
	`”a£
Õ»vG©e->_çnoutLi¡.
	`begš
()+
i
);

594 
size_t
 
i
=0; i<
aigG©e
->
_çnoutLi¡
.
	`size
(); ++i)

595 
´evG©e
->
_çnoutLi¡
.
	`push_back
(
aigG©e
->_çnoutLi¡[
i
]);

599 
UNDEF_GATE
:

601 
UndefG©e
* 
´evG©e
 = 
dyÇmic_ÿ¡
<UndefG©e*>(
aigG©e
->
_çnšLi¡
[0].
	`g©e
());

602 
size_t
 
i
=0; i<
´evG©e
->
_çnoutLi¡
.
	`size
(); ++i)

603 if(
´evG©e
->
_çnoutLi¡
[
i
] =ð
this
){

604 
´evG©e
->
_çnoutLi¡
.
	`”a£
Õ»vG©e->_çnoutLi¡.
	`begš
()+
i
);

607 
size_t
 
i
=0; i<
aigG©e
->
_çnoutLi¡
.
	`size
(); ++i)

608 
´evG©e
->
_çnoutLi¡
.
	`push_back
(
aigG©e
->_çnoutLi¡[
i
]);

618 
size_t
 
i
=0; i<
aigG©e
->
_çnoutLi¡
.
	`size
(); ++i){

619 
aigG©e
->
_çnoutLi¡
[
i
]->
	`g‘Ty³
()){

620 
PO_GATE
:

622 
PoG©e
* 
ÃxtG©e
 = 
dyÇmic_ÿ¡
<PoG©e*>(
aigG©e
->
_çnoutLi¡
[
i
]);

623 if((
ÃxtG©e
->
_çnšLi¡
[0].
	`isInv
(è&& 
šv
)

624 || (!
ÃxtG©e
->
_çnšLi¡
[0].
	`isInv
(è&& !
šv
)){

625 
ÃxtG©e
->
_çnšLi¡
[0].
	`£tG©e
(
aigG©e
->_çnšLi¡[0].
	`g©e
(), 
çl£
);

626 
ÃxtG©e
->
_çnš
[0] = 2*
aigG©e
->
_çnšLi¡
[0].
	`g©e
()->
_id
;

629 
ÃxtG©e
->
_çnšLi¡
[0].
	`£tG©e
(
aigG©e
->_çnšLi¡[0].
	`g©e
(), 
Œue
);

630 
ÃxtG©e
->
_çnš
[0] = 2*
aigG©e
->
_çnšLi¡
[0].
	`g©e
()->
_id
+1;

635 
AIG_GATE
:

637 
AigG©e
* 
ÃxtG©e
 = 
dyÇmic_ÿ¡
<AigG©e*>(
aigG©e
->
_çnoutLi¡
[
i
]);

638 
j
=0; j<2; ++j){

639 if(
ÃxtG©e
->
_çnšLi¡
[
j
].
	`g©e
(è=ð
this
){

640 if((
ÃxtG©e
->
_çnšLi¡
[
j
].
	`isInv
(è&& 
šv
)

641 || (!
ÃxtG©e
->
_çnšLi¡
[
j
].
	`isInv
(è&& !
šv
)){

642 
ÃxtG©e
->
_çnšLi¡
[
j
].
	`£tG©e
(
aigG©e
->_çnšLi¡[0].
	`g©e
(), 
çl£
);

643 
ÃxtG©e
->
_çnš
[
j
] = 2*
aigG©e
->
_çnšLi¡
[0].
	`g©e
()->
_id
;

646 
ÃxtG©e
->
_çnšLi¡
[
j
].
	`£tG©e
(
aigG©e
->_çnšLi¡[0].
	`g©e
(), 
Œue
);

647 
ÃxtG©e
->
_çnš
[
j
] = 2*
aigG©e
->
_çnšLi¡
[0].
	`g©e
()->
_id
+1;

662 if((
aigG©e
->
_çnšLi¡
[0].
	`g©e
() ==‡igGate->_faninList[1].gate())

663 && (
aigG©e
->
_çnšLi¡
[0].
	`isInv
() !=‡igGate->_faninList[1].isInv())){

664 
UnS‘
::
™”©Ü
 
™
 = 
d–‘ed
.
	`fšd
(
this
->
_id
);

665 if(
™
 =ð
d–‘ed
.
	`’d
()){

666 
d–‘ed
.
	`š£¹
(
this
->
_id
);

667 
cout
 << "Sim¶ifyšg: 0 m”gšg " << 
this
->
_id
 << "..." << 
’dl
;

671 
aigG©e
->
_çnšLi¡
[0].
	`g©e
()->
	`g‘Ty³
()){

672 
PI_GATE
:

674 
PiG©e
* 
´evG©e
 = 
dyÇmic_ÿ¡
<PiG©e*>(
aigG©e
->
_çnšLi¡
[0].
	`g©e
());

675 
size_t
 
i
=0; i<
´evG©e
->
_çnoutLi¡
.
	`size
(); ++i)

676 if(
´evG©e
->
_çnoutLi¡
[
i
] =ð
this
){

677 
´evG©e
->
_çnoutLi¡
.
	`”a£
Õ»vG©e->_çnoutLi¡.
	`begš
()+
i
);

683 
UNDEF_GATE
:

685 
UndefG©e
* 
´evG©e
 = 
dyÇmic_ÿ¡
<UndefG©e*>(
aigG©e
->
_çnšLi¡
[0].
	`g©e
());

686 
size_t
 
i
=0; i<
´evG©e
->
_çnoutLi¡
.
	`size
(); ++i)

687 if(
´evG©e
->
_çnoutLi¡
[
i
] =ð
this
){

688 
´evG©e
->
_çnoutLi¡
.
	`”a£
Õ»vG©e->_çnoutLi¡.
	`begš
()+
i
);

694 
AIG_GATE
:

696 
AigG©e
* 
´evG©e
 = 
dyÇmic_ÿ¡
<AigG©e*>(
aigG©e
->
_çnšLi¡
[0].
	`g©e
());

697 
size_t
 
i
=0; i<
´evG©e
->
_çnoutLi¡
.
	`size
(); ++i)

698 if(
´evG©e
->
_çnoutLi¡
[
i
] =ð
this
){

699 
´evG©e
->
_çnoutLi¡
.
	`”a£
Õ»vG©e->_çnoutLi¡.
	`begš
()+
i
);

709 
CÚ¡G©e
* 
cÚ¡G©e
 = 
dyÇmic_ÿ¡
<CÚ¡G©e*>(
cœMgr
->
	`g‘G©e
(0));

710 
size_t
 
i
=0; i<
aigG©e
->
_çnoutLi¡
.
	`size
(); ++i)

711 
cÚ¡G©e
->
_çnoutLi¡
.
	`push_back
(
aigG©e
->_çnoutLi¡[
i
]);

715 
size_t
 
i
=0; i<
aigG©e
->
_çnoutLi¡
.
	`size
(); ++i){

716 
aigG©e
->
_çnoutLi¡
[
i
]->
	`g‘Ty³
()){

717 
PO_GATE
:

719 
PoG©e
* 
ÃxtG©e
 = 
dyÇmic_ÿ¡
<PoG©e*>(
aigG©e
->
_çnoutLi¡
[
i
]);

720 if(
ÃxtG©e
->
_çnšLi¡
[0].
	`isInv
()){

721 
ÃxtG©e
->
_çnšLi¡
[0].
	`£tG©e
(
cœMgr
->
	`g‘G©e
(0), 
Œue
);

722 
ÃxtG©e
->
_çnš
[0] = 1;

725 
ÃxtG©e
->
_çnšLi¡
[0].
	`£tG©e
(
cœMgr
->
	`g‘G©e
(0), 
çl£
);

726 
ÃxtG©e
->
_çnš
[0] = 0;

730 
AIG_GATE
:

732 
AigG©e
* 
ÃxtG©e
 = 
dyÇmic_ÿ¡
<AigG©e*>(
aigG©e
->
_çnoutLi¡
[
i
]);

733 
i
=0; i<2; ++i){

734 if(
ÃxtG©e
->
_çnšLi¡
[
i
].
	`g©e
(è=ð
this
){

735 if(
ÃxtG©e
->
_çnšLi¡
[
i
].
	`isInv
()){

736 
ÃxtG©e
->
_çnšLi¡
[
i
].
	`£tG©e
(
cœMgr
->
	`g‘G©e
(0), 
Œue
);

737 
ÃxtG©e
->
_çnš
[
i
] = 1;

740 
ÃxtG©e
->
_çnšLi¡
[
i
].
	`£tG©e
(
cœMgr
->
	`g‘G©e
(0), 
çl£
);

741 
ÃxtG©e
->
_çnš
[
i
] = 0;

753 
	}
}

755 
	gCœG©e
::
dfsSŒash
(
HashM­
<
HashKey
, 
CœG©eV
>& 
hash
, 
UnS‘
& 
dfsLi¡
, UnS‘& 
d–‘ed
){

756 
	gUnS‘
::
™”©Ü
 
™
 = 
dfsLi¡
.
fšd
(
this
->
_id
);

757 if(
	g™
 =ð
dfsLi¡
.
’d
()) ;

759 
	gthis
->
g‘Ty³
()){

760 
	gPI_GATE
:

762 
PiG©e
* 
piG©e
 = 
dyÇmic_ÿ¡
<PiG©e*>(
this
);

763 
size_t
 
	gi
=0; i<
	gpiG©e
->
	g_çnoutLi¡
.
size
(); ++i)

764 if(!
	gpiG©e
->
	g_çnoutLi¡
[
i
]->
isGlob®Ref
()){

765 
	gpiG©e
->
	g_çnoutLi¡
[
i
]->
£tToGlob®Ref
();

766 
	gpiG©e
->
	g_çnoutLi¡
[
i
]->
	g_aùive
 = 
Œue
;

767 
	gpiG©e
->
	g_çnoutLi¡
[
i
]->
dfsSŒash
(
hash
, 
dfsLi¡
, 
d–‘ed
);

768 
	gpiG©e
->
	g_çnoutLi¡
[
i
]->
	g_aùive
 = 
çl£
;

773 
	gCONST_GATE
:

775 
CÚ¡G©e
* 
cÚ¡G©e
 = 
dyÇmic_ÿ¡
<CÚ¡G©e*>(
this
);

776 
size_t
 
	gi
=0; i<
	gcÚ¡G©e
->
	g_çnoutLi¡
.
size
(); ++i)

777 if(!
	gcÚ¡G©e
->
	g_çnoutLi¡
[
i
]->
isGlob®Ref
()){

778 
	gcÚ¡G©e
->
	g_çnoutLi¡
[
i
]->
£tToGlob®Ref
();

779 
	gcÚ¡G©e
->
	g_çnoutLi¡
[
i
]->
	g_aùive
 = 
Œue
;

780 
	gcÚ¡G©e
->
	g_çnoutLi¡
[
i
]->
dfsSŒash
(
hash
, 
dfsLi¡
, 
d–‘ed
);

781 
	gcÚ¡G©e
->
	g_çnoutLi¡
[
i
]->
	g_aùive
 = 
çl£
;

786 
	gAIG_GATE
:

788 
AigG©e
* 
aigG©e
 = 
dyÇmic_ÿ¡
<AigG©e*>(
this
);

789 
size_t
 
	gi
=0; i<
	gaigG©e
->
	g_çnoutLi¡
.
size
(); ++i)

790 if(!
	gaigG©e
->
	g_çnoutLi¡
[
i
]->
isGlob®Ref
()){

791 
	gaigG©e
->
	g_çnoutLi¡
[
i
]->
£tToGlob®Ref
();

792 
	gaigG©e
->
	g_çnoutLi¡
[
i
]->
	g_aùive
 = 
Œue
;

793 
	gaigG©e
->
	g_çnoutLi¡
[
i
]->
dfsSŒash
(
hash
, 
dfsLi¡
, 
d–‘ed
);

794 
	gaigG©e
->
	g_çnoutLi¡
[
i
]->
	g_aùive
 = 
çl£
;

797 
	gaigG©e
->
sim¶ifySŒash
(
hash
, 
d–‘ed
);

807 
	gAigG©e
::
sim¶ifySŒash
(
HashM­
<
HashKey
, 
CœG©eV
>& 
hash
, 
UnS‘
& 
d–‘ed
){

808 
HashKey
 
k
(
this
->
_çnš
[0],his->_fanin[1]);

809 
CœG©eV
 
m”geG©e
((
CœG©e
*)
this
);

811 if(
	ghash
.
check
(
k
)){

812 
CœG©eV
 
node
(
this
);

813 
	ghash
.
qu”y
(
k
, 
node
);

814 if(
	gnode
.
g©e
(è=ð
m”geG©e
.gate()) ;

816 
AigG©e
* 
	gm”gšgG©e
 = 
this
;

817 
AigG©e
* 
	gg©e
 = 
dyÇmic_ÿ¡
<AigG©e*>(
node
.
g©e
());

819 
	gd–‘ed
.
š£¹
(
node
.
g©e
()->
_id
);

820 
	gcout
 << "SŒashšg: " << 
	gm”gšgG©e
->
	g_id
 << " m”gšg " << 
	gg©e
->_id << "..." << 
	g’dl
;

822 
	gi
=0; i<2; ++i){

823 
	gg©e
->
	g_çnšLi¡
[
i
].
g©e
()->
g‘Ty³
()){

824 
	gUNDEF_GATE
:

826 
UndefG©e
* 
undefG©e
 = 
dyÇmic_ÿ¡
<UndefG©e*>(
g©e
->
_çnšLi¡
[
i
].gate());

827 
size_t
 
	gj
=0; j<
	gundefG©e
->
	g_çnoutLi¡
.
size
(); ++j)

828 if(
	gundefG©e
->
	g_çnoutLi¡
[
j
] =ð
g©e
){

829 
undefG©e
->
_çnoutLi¡
.
”a£
(undefG©e->_çnoutLi¡.
begš
()+
j
);

835 
	gCONST_GATE
:

837 
CÚ¡G©e
* 
cÚ¡G©e
 = 
dyÇmic_ÿ¡
<CÚ¡G©e*>(
g©e
->
_çnšLi¡
[
i
].gate());

838 
size_t
 
	gj
=0; j<
	gcÚ¡G©e
->
	g_çnoutLi¡
.
size
(); ++j)

839 if(
	gcÚ¡G©e
->
	g_çnoutLi¡
[
j
] =ð
g©e
){

840 
cÚ¡G©e
->
_çnoutLi¡
.
”a£
(cÚ¡G©e->_çnoutLi¡.
begš
()+
j
);

846 
	gPI_GATE
:

848 
PiG©e
* 
piG©e
 = 
dyÇmic_ÿ¡
<PiG©e*>(
g©e
->
_çnšLi¡
[
i
].gate());

849 
size_t
 
	gj
=0; j<
	gpiG©e
->
	g_çnoutLi¡
.
size
(); ++j)

850 if(
	gpiG©e
->
	g_çnoutLi¡
[
j
] =ð
g©e
){

851 
piG©e
->
_çnoutLi¡
.
”a£
ÕiG©e->_çnoutLi¡.
begš
()+
j
);

857 
	gAIG_GATE
:

859 
AigG©e
* 
aigG©e
 = 
dyÇmic_ÿ¡
<AigG©e*>(
g©e
->
_çnšLi¡
[
i
].gate());

860 
size_t
 
	gj
=0; j<
	gaigG©e
->
	g_çnoutLi¡
.
size
(); ++j)

861 if(
	gaigG©e
->
	g_çnoutLi¡
[
j
] =ð
g©e
){

862 
aigG©e
->
_çnoutLi¡
.
”a£
×igG©e->_çnoutLi¡.
begš
()+
j
);

874 
size_t
 
	gi
=0; i<
	gg©e
->
	g_çnoutLi¡
.
size
(); ++i){

875 
	gm”gšgG©e
->
	g_çnoutLi¡
.
push_back
(
g©e
->
_çnoutLi¡
[
i
]);

877 
	gg©e
->
	g_çnoutLi¡
[
i
]->
g‘Ty³
()){

878 
	gAIG_GATE
:

880 
AigG©e
* 
aigG©e
 = 
dyÇmic_ÿ¡
<AigG©e*>(
g©e
->
_çnoutLi¡
[
i
]);

881 
	gj
=0; j<2; ++j)

882 if(
	gaigG©e
->
	g_çnšLi¡
[
j
].
g©e
() == gate){

883 if(
aigG©e
->
_çnšLi¡
[
j
].
isInv
()){

884 
aigG©e
->
_çnšLi¡
[
j
].
£tG©e
((
CœG©e
*)
m”gšgG©e
, 
Œue
);

885 
	gaigG©e
->
	g_çnš
[
j
] = 2*
m”gšgG©e
->
_id
+1;

888 
	gaigG©e
->
	g_çnšLi¡
[
j
].
£tG©e
((
CœG©e
*)
m”gšgG©e
, 
çl£
);

889 
	gaigG©e
->
	g_çnš
[
j
] = 2*
m”gšgG©e
->
_id
;

895 
	gPO_GATE
:

897 
PoG©e
* 
poG©e
 = 
dyÇmic_ÿ¡
<PoG©e*>(
g©e
->
_çnoutLi¡
[
i
]);

898 if(
	gpoG©e
->
	g_çnšLi¡
[0].
isInv
()){

899 
	gpoG©e
->
	g_çnšLi¡
[0].
£tG©e
((
CœG©e
*)
m”gšgG©e
, 
Œue
);

900 
	gpoG©e
->
	g_çnš
[0] = 2*
m”gšgG©e
->
_id
+1;

903 
	gpoG©e
->
	g_çnšLi¡
[0].
£tG©e
((
CœG©e
*)
m”gšgG©e
, 
çl£
);

904 
	gpoG©e
->
	g_çnš
[0] = 2*
m”gšgG©e
->
_id
;

914 
	ghash
.
upd©e
(
k
, 
m”geG©e
);

916 
	ghash
.
š£¹
(
k
, 
m”geG©e
);

	@src/cir/cirGate.h

9 #iâdeà
CIR_GATE_H


10 
	#CIR_GATE_H


	)

12 
	~<¡ršg
>

13 
	~<veùÜ
>

14 
	~<io¡»am
>

15 
	~"cœDef.h
"

16 
	~"§t.h
"

18 
usšg
 
Çme¥aû
 
	g¡d
;

22 
þass
 
	gCœG©e
;

23 
þass
 
	gCœG©eV
;

28 þas 
	cCœG©e


30 
ä›nd
 
þass
 
	mCœMgr
;

31 
ä›nd
 
þass
 
	mAigG©e
;

33 
	mpublic
:

34 
	$CœG©e
(): 
	`_»f
(0), 
	$_aùive
(
çl£
) {}

35 
vœtu®
 ~
	$CœG©e
(è{
	}
}

38 
vœtu®
 
¡ršg
 
	$g‘Ty³SŒ
() const = 0;

39 
	$g‘LšeNo
(ècÚ¡ {  
_lše
; 
	}
}

40 
vœtu®
 
boÞ
 
	$isAig
(ècÚ¡ { if(
	`g‘Ty³SŒ
()=="AIG"è 
Œue
;  
çl£
; 
	}
}

43 
vœtu®
 
´štG©e
();

44 
	$»pÜtG©e
() const;

45 
	`»pÜtFªš
(
Ëv–
);

46 
	`»pÜtFªout
(
Ëv–
);

50 
boÞ
 
	$isGlob®Ref
(ècÚ¡ {  
_»f
 =ð
_glob®Ref
; 
	}
}

51 
	$£tToGlob®Ref
(è{ 
_»f
 = 
_glob®Ref
; 
	}
}

52 
	$£tGlob®Ref
(è{ ++
_glob®Ref
; 
	}
}

53 
	$£tIdLšeCÞ
(cÚ¡ & 
i
, cÚ¡ & 
l
, cÚ¡ & 
c
){

54 
_id
 = 
i
; 
_lše
 = 
l
; 
_cÞ
 = 
c
;

55 
	}
}

56 
vœtu®
 
G©eTy³
 
	$g‘Ty³
() const = 0;

57 
	`dfsT¿v”§l
(
G©eLi¡
&, 
CœG©ePaœLi¡
&);

58 
	`´štFªš
(
CœG©e
*, &, , 
UnS‘
&, CirGate*);

59 
	`´štFªout
(
CœG©e
*, &, , 
UnS‘
&, CirGate*);

61 
	`dfsO±imize
(
UnS‘
&);

62 
	`dfsSŒash
(
HashM­
<
HashKey
, 
CœG©eV
>&, 
UnS‘
&, UnSet&);

64 
´iv©e
:

65 
_glob®Ref
;

66 
_»f
;

68 
´Ùeùed
:

69 
boÞ
 
_aùive
;

70 
¡ršg
 
_symbÞ
;

72 
_id
;

73 
_lše
;

74 
_cÞ
;

75 
	}
};

78 þas 
	cCœG©eV
{

79 
	#NEG
 0x1

	)

80 
	mpublic
:

81 
	$CœG©eV
(
CœG©e
* 
g
, 
size_t
 
pha£
 = 0): 
	`_g©eV
(
	`size_t
(g)+phase) {}

82 ~
	$CœG©eV
(è{
	}
}

84 
CœG©e
* 
	$g©e
(ècÚ¡ {  (
CœG©e
*)(
_g©eV
 & ~
	`size_t
(
NEG
)); 
	}
}

85 
boÞ
 
	$isInv
(ècÚ¡ {  (
_g©eV
 & 
NEG
); 
	}
}

86 
	$£tG©e
(
CœG©e
* 
g©e
, 
boÞ
 
šv
){

87 if(
šv
è
_g©eV
 = (
	`size_t
(
g©e
) + 0x1);

88 
_g©eV
 = (
	`size_t
(
g©e
) + 0x0);

89 
	}
}

90 
boÞ
 
	gÝ”©Ü
 =ð(cÚ¡ 
CœG©eV
& 
c
ècÚ¡ {  
_g©eV
 == c._gateV; }

92 
	g´iv©e
:

93 
size_t
 
_g©eV
;

97 þas 
	cUndefG©e
 : 
public
 
CœG©e
{

98 
ä›nd
 
þass
 
CœMgr
;

99 
ä›nd
 
þass
 
	mCœG©e
;

100 
ä›nd
 
þass
 
	mAigG©e
;

102 
	mpublic
:

103 
	$UndefG©e
() {}

104 ~
	$UndefG©e
(è{
	}
}

106 
¡ršg
 
	$g‘Ty³SŒ
(ècÚ¡ {  "UNDEF"; 
	}
}

107 
G©eTy³
 
	$g‘Ty³
(ècÚ¡ {  
	`G©eTy³
(
UNDEF_GATE
); 
	}
}

109 
	g´iv©e
:

110 
G©eLi¡
 
_çnoutLi¡
;

113 þas 
	cPiG©e
 : 
public
 
CœG©e
{

114 
ä›nd
 
þass
 
CœMgr
;

115 
ä›nd
 
þass
 
	mCœG©e
;

116 
ä›nd
 
þass
 
	mAigG©e
;

118 
	mpublic
:

119 
	$PiG©e
() {}

120 ~
	$PiG©e
(è{
	}
}

122 
¡ršg
 
	$g‘Ty³SŒ
(ècÚ¡ {  "PI"; 
	}
}

123 
G©eTy³
 
	$g‘Ty³
(ècÚ¡ {  
	`G©eTy³
(
PI_GATE
); 
	}
}

125 
	g´iv©e
:

126 
G©eLi¡
 
_çnoutLi¡
;

129 þas 
	cPoG©e
 : 
public
 
CœG©e
{

130 
ä›nd
 
þass
 
CœMgr
;

131 
ä›nd
 
þass
 
	mCœG©e
;

132 
ä›nd
 
þass
 
	mAigG©e
;

134 
	mpublic
:

135 
	$PoG©e
() {}

136 ~
	$PoG©e
(è{
	}
}

138 
¡ršg
 
	$g‘Ty³SŒ
(ècÚ¡ {  "PO"; 
	}
}

139 
G©eTy³
 
	$g‘Ty³
(ècÚ¡ {  
	`G©eTy³
(
PO_GATE
); 
	}
}

141 
	g´iv©e
:

142 
veùÜ
<
CœG©eV
> 
_çnšLi¡
;

143 
IdLi¡
 
	g_çnš
;

146 þas 
	cAigG©e
 : 
public
 
CœG©e
{

147 
ä›nd
 
þass
 
CœMgr
;

148 
ä›nd
 
þass
 
	mCœG©e
;

150 
	mpublic
:

151 
	$AigG©e
() {}

152 ~
	$AigG©e
(è{
	}
}

154 
¡ršg
 
	$g‘Ty³SŒ
(ècÚ¡ {  "AIG"; 
	}
}

155 
G©eTy³
 
	$g‘Ty³
(ècÚ¡ {  
	`G©eTy³
(
AIG_GATE
); 
	}
}

156 
sim¶ifyCÚ¡
(
UnS‘
&);

157 
sim¶ifyFªš
(
UnS‘
&);

158 
sim¶ifySŒash
(
HashM­
<
HashKey
, 
CœG©eV
>&, 
UnS‘
&);

160 
	g´iv©e
:

161 
veùÜ
<
CœG©eV
> 
_çnšLi¡
;

162 
G©eLi¡
 
	g_çnoutLi¡
;

163 
IdLi¡
 
	g_çnš
;

166 þas 
	cCÚ¡G©e
 : 
public
 
CœG©e
{

167 
ä›nd
 
þass
 
CœMgr
;

168 
ä›nd
 
þass
 
	mCœG©e
;

169 
ä›nd
 
þass
 
	mAigG©e
;

171 
	mpublic
:

172 
	$CÚ¡G©e
() {}

173 ~
	$CÚ¡G©e
(è{
	}
}

175 
¡ršg
 
	$g‘Ty³SŒ
(ècÚ¡ {  "CONST"; 
	}
}

176 
G©eTy³
 
	$g‘Ty³
(ècÚ¡ {  
	`G©eTy³
(
CONST_GATE
); 
	}
}

178 
	g´iv©e
:

179 
G©eLi¡
 
_çnoutLi¡
;

	@src/cir/cirMgr.cpp

9 
	~<io¡»am
>

10 
	~<iomª
>

11 
	~<®gÜ™hm
>

12 
	~<c¡dio
>

13 
	~<ùy³.h
>

14 
	~<ÿs£¹
>

15 
	~<c¡ršg
>

16 
	~<s¡»am
>

17 
	~"cœMgr.h
"

18 
	~"cœG©e.h
"

19 
	~"utž.h
"

20 
	~<¡ack
>

22 
usšg
 
Çme¥aû
 
	g¡d
;

29 
CœMgr
* 
	gcœMgr
 = 0;

31 
	eCœP¬£E¼Ü
 {

32 
	mEXTRA_SPACE
,

33 
	mMISSING_SPACE
,

34 
	mILLEGAL_WSPACE
,

35 
	mILLEGAL_NUM
,

36 
	mILLEGAL_IDENTIFIER
,

37 
	mILLEGAL_SYMBOL_TYPE
,

38 
	mILLEGAL_SYMBOL_NAME
,

39 
	mMISSING_NUM
,

40 
	mMISSING_IDENTIFIER
,

41 
	mMISSING_NEWLINE
,

42 
	mMISSING_DEF
,

43 
	mCANNOT_INVERTED
,

44 
	mMAX_LIT_ID
,

45 
	mREDEF_GATE
,

46 
	mREDEF_SYMBOLIC_NAME
,

47 
	mREDEF_CONST
,

48 
	mNUM_TOO_SMALL
,

49 
	mNUM_TOO_BIG
,

51 
	mDUMMY_END


57 
	glšeNo
 = 0;

58 
	gcÞNo
 = 0;

59 
	gbuf
[1024];

60 
¡ršg
 
	g”rMsg
;

61 
	g”rIÁ
;

62 
CœG©e
 *
	g”rG©e
;

64 
boÞ


65 
	$·r£E¼Ü
(
CœP¬£E¼Ü
 
”r
)

67 
”r
) {

68 
EXTRA_SPACE
:

69 
û¼
 << "[ERROR] Lš" << 
lšeNo
+1 << ", CÞ " << 
cÞNo
+1

70 << ": ExŒ¨¥aû ch¬aù” i d‘eùed!!" << 
’dl
;

72 
MISSING_SPACE
:

73 
û¼
 << "[ERROR] Lš" << 
lšeNo
+1 << ", CÞ " << 
cÞNo
+1

74 << ": Missšg s·û ch¬aù”!!" << 
’dl
;

76 
ILLEGAL_WSPACE
:

77 
û¼
 << "[ERROR] Lš" << 
lšeNo
+1 << ", CÞ " << 
cÞNo
+1

78 << ": IÎeg® wh™¥aû ch¬(" << 
”rIÁ


79 << "èi d‘eùed!!" << 
’dl
;

81 
ILLEGAL_NUM
:

82 
û¼
 << "[ERROR] Lš" << 
lšeNo
+1 << ": Illegal "

83 << 
”rMsg
 << "!!" << 
’dl
;

85 
ILLEGAL_IDENTIFIER
:

86 
û¼
 << "[ERROR] Lš" << 
lšeNo
+1 << ": Illegal identifier \""

87 << 
”rMsg
 << "\"!!" << 
’dl
;

89 
ILLEGAL_SYMBOL_TYPE
:

90 
û¼
 << "[ERROR] Lš" << 
lšeNo
+1 << ", CÞ " << 
cÞNo
+1

91 << ": IÎeg® symbÞy³ (" << 
”rMsg
 << ")!!" << 
’dl
;

93 
ILLEGAL_SYMBOL_NAME
:

94 
û¼
 << "[ERROR] Lš" << 
lšeNo
+1 << ", CÞ " << 
cÞNo
+1

95 << ": SymbÞiøÇmcÚš un-´šbË ch¬(" << 
”rIÁ


96 << ")!!" << 
’dl
;

98 
MISSING_NUM
:

99 
û¼
 << "[ERROR] Lš" << 
lšeNo
+1 << ", CÞ " << 
cÞNo
+1

100 << ": Missšg " << 
”rMsg
 << "!!" << 
’dl
;

102 
MISSING_IDENTIFIER
:

103 
û¼
 << "[ERROR] Lš" << 
lšeNo
+1 << ": Missing \""

104 << 
”rMsg
 << "\"!!" << 
’dl
;

106 
MISSING_NEWLINE
:

107 
û¼
 << "[ERROR] Lš" << 
lšeNo
+1 << ", CÞ " << 
cÞNo
+1

108 << ": A‚ew†ši ex³ùed h”e!!" << 
’dl
;

110 
MISSING_DEF
:

111 
û¼
 << "[ERROR] Lš" << 
lšeNo
+1 << ": Missšg " << 
”rMsg


112 << " defš™iÚ!!" << 
’dl
;

114 
CANNOT_INVERTED
:

115 
û¼
 << "[ERROR] Lš" << 
lšeNo
+1 << ", CÞ " << 
cÞNo
+1

116 << ": " << 
”rMsg
 << " " << 
”rIÁ
 << "(" <<ƒrrInt/2

117 << "èÿÂÙ bšv”‹d!!" << 
’dl
;

119 
MAX_LIT_ID
:

120 
û¼
 << "[ERROR] Lš" << 
lšeNo
+1 << ", CÞ " << 
cÞNo
+1

121 << ": L™”® \"" << 
”rIÁ
 << "\"ƒxceeds maximum valid ID!!"

122 << 
’dl
;

124 
REDEF_GATE
:

125 
û¼
 << "[ERROR] Lš" << 
lšeNo
+1 << ": L™”® \"" << 
”rIÁ


127 << 
”rG©e
->
	`g‘Ty³SŒ
(è<< " iÀlš" <<ƒ¼G©e->
	`g‘LšeNo
()

128 << "!!" << 
’dl
;

130 
REDEF_SYMBOLIC_NAME
:

131 
û¼
 << "[ERROR] Lš" << 
lšeNo
+1 << ": Symbolic‚ame for \""

132 << 
”rMsg
 << 
”rIÁ
 << "\" i »defšed!!" << 
’dl
;

134 
REDEF_CONST
:

135 
û¼
 << "[ERROR] Lš" << 
lšeNo
+1 << ", CÞ " << 
cÞNo
+1

136 << ": CªnÙ„edefšcÚ¡ (" << 
”rIÁ
 << ")!!" << 
’dl
;

138 
NUM_TOO_SMALL
:

139 
û¼
 << "[ERROR] Lš" << 
lšeNo
+1 << ": " << 
”rMsg


140 << " i toØsm®È(" << 
”rIÁ
 << ")!!" << 
’dl
;

142 
NUM_TOO_BIG
:

143 
û¼
 << "[ERROR] Lš" << 
lšeNo
+1 << ": " << 
”rMsg


144 << " i toØbig (" << 
”rIÁ
 << ")!!" << 
’dl
;

148  
çl£
;

149 
	}
}

154 
boÞ


155 
	gCœMgr
::
	$»adCœcu™
(cÚ¡ 
¡ršg
& 
fžeName
)

157 
f¡»am
 
	`fš
(
fžeName
);

158 if(!
fš
){

159 
û¼
 << "CªnÙ o³Àdesign\"" << 
fžeName
 << "\"!!" << 
’dl
;

160  
çl£
;

163 
couÁ
 = 0;

164 
boÞ
 
comm’ts
 = 
çl£
;

165 
fš
.
	`g‘lše
(
buf
, 1024)){

166 if(
buf
[0] == '\0') ;

167 
¡ršg¡»am
 
	`ss
(
buf
);

168 
¡ršg
 
¡r
;

169 
veùÜ
<
¡ršg
> 
šputs
;

170 
	`g‘lše
(
ss
, 
¡r
, ' '))

171 
šputs
.
	`push_back
(
¡r
);

174 if(
couÁ
 < 1){

175 
size_t
 
i
=1; i<6; ++i){

176 
tmp
;

177 if(
	`mySŒ2IÁ
(
šputs
[
i
], 
tmp
))

178 
_MILOA
.
	`push_back
(
tmp
);

180 ++
couÁ
;

184 if(
couÁ
 < 1+
_MILOA
[1]){

185 
tmp
;

186 if(
	`mySŒ2IÁ
(
šputs
[0], 
tmp
)){

187 
CœG©e
* 
g©e
 = 
Ãw
 
PiG©e
;

188 
g©e
->
	`£tIdLšeCÞ
(
tmp
/2, 1+
couÁ
, 1);

189 
_piLi¡
.
	`push_back
(
g©e
);

190 
_tÙ®Li¡
.
	`š£¹
(
	`make_·œ
(
g©e
->
_id
, gate));

192 ++
couÁ
;

196 if(
couÁ
 < 1+
_MILOA
[1]+_MILOA[3]){

197 
tmp
;

198 if(
	`mySŒ2IÁ
(
šputs
[0], 
tmp
)){

199 
CœG©e
* 
g©e
 = 
Ãw
 
PoG©e
;

200 
g©e
->
	`£tIdLšeCÞ
(
_MILOA
[0]+1+
_poLi¡
.
	`size
(), 1+
couÁ
, 1);

201 
dyÇmic_ÿ¡
<
PoG©e
*>(
g©e
)->
_çnš
.
	`push_back
(
tmp
);

202 
_poLi¡
.
	`push_back
(
g©e
);

203 
_tÙ®Li¡
.
	`š£¹
(
	`make_·œ
(
g©e
->
_id
, gate));

205 ++
couÁ
;

209 if(
couÁ
 < 1+
_MILOA
[1]+_MILOA[3]+_MILOA[4]){

210 
tmp1
, 
tmp2
, 
tmp3
;

211 if(
	`mySŒ2IÁ
(
šputs
[0],
tmp1
)

212 && 
	`mySŒ2IÁ
(
šputs
[1], 
tmp2
)

213 && 
	`mySŒ2IÁ
(
šputs
[2], 
tmp3
)){

214 
CœG©e
* 
g©e
 = 
Ãw
 
AigG©e
;

215 
g©e
->
	`£tIdLšeCÞ
(
tmp1
/2, 1+
couÁ
, 1);

216 
dyÇmic_ÿ¡
<
AigG©e
*>(
g©e
)->
_çnš
.
	`push_back
(
tmp2
);

217 
dyÇmic_ÿ¡
<
AigG©e
*>(
g©e
)->
_çnš
.
	`push_back
(
tmp3
);

218 
_tÙ®Li¡
.
	`š£¹
(
	`make_·œ
(
g©e
->
_id
, gate));

220 ++
couÁ
;

224 if(
šputs
[0]!="c" && !
comm’ts
){

225 ++
couÁ
;

226 if(
šputs
[0][0] == 'i'){

227 
id
 = 
	`¡oi
(
šputs
[0].
	`sub¡r
(1, iÅuts[0].
	`size
()-1));

228 
¡ršg
 
¡r
;

229 
size_t
 
i
=1; i<
šputs
.
	`size
(); ++i){

230 if(
i
 =ð1è
¡r
 +ð
šputs
[i];

231 
¡r
 +ð" "+
šputs
[
i
];

233 
_piLi¡
[
id
]->
_symbÞ
 = 
¡r
;

235 if(
šputs
[0][0] == 'o'){

236 
id
 = 
	`¡oi
(
šputs
[0].
	`sub¡r
(1, iÅuts[0].
	`size
()-1));

237 
¡ršg
 
¡r
;

238 
size_t
 
i
=1; i<
šputs
.
	`size
(); ++i){

239 if(
i
 =ð1è
¡r
 +ð
šputs
[i];

240 
¡r
 +ð" "+
šputs
[
i
];

242 
_poLi¡
[
id
]->
_symbÞ
 = 
¡r
;

247 if(
šputs
[0] == "c"){

248 
comm’ts
 = 
Œue
;

249 
_comm’ts
.
	`push_back
(
šputs
[0]);

254 
¡ršg
 
¡r
;

255 
size_t
 
i
=0; i<
šputs
.
	`size
(); ++i){

256 if(
i
 =ð0è
¡r
 +ð
šputs
[i];

257 
¡r
 +ð" "+
šputs
[
i
];

259 
_comm’ts
.
	`push_back
(
¡r
);

263 
	`cÚ¡ruùN‘
();

264 
	`dfsT¿v”§l
(
_poLi¡
);

266  
Œue
;

267 
	}
}

269 
	gCœMgr
::
	$cÚ¡ruùN‘
(){

270 
UnM­
::
™”©Ü
 
™
;

271 
™
=
_tÙ®Li¡
.
	`begš
(); it!=_tÙ®Li¡.
	`’d
(); ++it){

272 if(
™
->
£cÚd
->
	`g‘Ty³SŒ
() != "AIG") ;

274 
AigG©e
* 
aigG©e
 = 
dyÇmic_ÿ¡
<AigG©e*>(
™
->
£cÚd
);

275 
i
=0; i<2; ++i){

276 
CœG©e
* 
çnšG©e
 = 
	`g‘G©e
(
aigG©e
->
_çnš
[
i
]/2);

277 if(
çnšG©e
 == 0){

278 
çnšG©e
 = 
Ãw
 
UndefG©e
;

279 
çnšG©e
->
	`£tIdLšeCÞ
(
aigG©e
->
_çnš
[
i
]/2, 0, 0);

280 
_tÙ®Li¡
.
	`š£¹
(
	`make_·œ
(
çnšG©e
->
_id
, faninGate));

283 if(
aigG©e
->
_çnš
[
i
] % 2){

284 
CœG©eV
 
	`g©e
(
çnšG©e
, 0x1);

285 
aigG©e
->
_çnšLi¡
.
	`push_back
(
g©e
);

288 
CœG©eV
 
	`g©e
(
çnšG©e
, 0x0);

289 
aigG©e
->
_çnšLi¡
.
	`push_back
(
g©e
);

292 
çnšG©e
->
	`g‘Ty³
()){

293 
PO_GATE
:

295 
PI_GATE
:

296 
dyÇmic_ÿ¡
<
PiG©e
*>(
çnšG©e
)->
_çnoutLi¡
.
	`push_back
(
™
->
£cÚd
);

298 
AIG_GATE
:

299 
dyÇmic_ÿ¡
<
AigG©e
*>(
çnšG©e
)->
_çnoutLi¡
.
	`push_back
(
™
->
£cÚd
);

301 
CONST_GATE
:

302 
dyÇmic_ÿ¡
<
CÚ¡G©e
*>(
çnšG©e
)->
_çnoutLi¡
.
	`push_back
(
™
->
£cÚd
);

304 
UNDEF_GATE
:

305 
dyÇmic_ÿ¡
<
UndefG©e
*>(
çnšG©e
)->
_çnoutLi¡
.
	`push_back
(
™
->
£cÚd
);

313 
size_t
 
i
=0; i<
_poLi¡
.
	`size
(); ++i){

314 
PoG©e
* 
poG©e
 = 
dyÇmic_ÿ¡
<PoG©e*>(
_poLi¡
[
i
]);

315 
CœG©e
* 
çnšG©e
 = 
	`g‘G©e
(
poG©e
->
_çnš
[0]/2);

316 if(
çnšG©e
 == 0){

317 
çnšG©e
 = 
Ãw
 
UndefG©e
;

318 
çnšG©e
->
	`£tIdLšeCÞ
(
poG©e
->
_çnš
[0]/2, 0, 0);

319 
_tÙ®Li¡
.
	`š£¹
(
	`make_·œ
(
çnšG©e
->
_id
, faninGate));

322 if(
poG©e
->
_çnš
[0] % 2){

323 
CœG©eV
 
	`g©e
(
çnšG©e
, 0x1);

324 
poG©e
->
_çnšLi¡
.
	`push_back
(
g©e
);

327 
CœG©eV
 
	`g©e
(
çnšG©e
, 0x0);

328 
poG©e
->
_çnšLi¡
.
	`push_back
(
g©e
);

331 
çnšG©e
->
	`g‘Ty³
()){

332 
PO_GATE
:

334 
PI_GATE
:

335 
dyÇmic_ÿ¡
<
PiG©e
*>(
çnšG©e
)->
_çnoutLi¡
.
	`push_back
(
_poLi¡
[
i
]);

337 
AIG_GATE
:

338 
dyÇmic_ÿ¡
<
AigG©e
*>(
çnšG©e
)->
_çnoutLi¡
.
	`push_back
(
_poLi¡
[
i
]);

340 
CONST_GATE
:

341 
dyÇmic_ÿ¡
<
CÚ¡G©e
*>(
çnšG©e
)->
_çnoutLi¡
.
	`push_back
(
_poLi¡
[
i
]);

343 
UNDEF_GATE
:

344 
dyÇmic_ÿ¡
<
UndefG©e
*>(
çnšG©e
)->
_çnoutLi¡
.
	`push_back
(
_poLi¡
[
i
]);

350 
	}
}

352 
	gCœMgr
::
	$dfsT¿v”§l
(cÚ¡ 
G©eLi¡
& 
sškLi¡
){

353 
CœG©e
::
	`£tGlob®Ref
();

354 
size_t
 
i
=0; i<
sškLi¡
.
	`size
(); ++i)

355 
sškLi¡
[
i
]->
	`dfsT¿v”§l
(
_dfsLi¡
, 
_fbLi¡
);

356 
	}
}

371 
	gCœMgr
::
	$´štSumm¬y
() const

373 
cout
 << 
’dl
;

374 
aigCouÁ
 = 0;

375 
UnM­
::
cÚ¡_™”©Ü
 
™
;

376 
™
=
_tÙ®Li¡
.
	`begš
(); it!=_tÙ®Li¡.
	`’d
(); ++it)

377 if(
™
->
£cÚd
->
	`g‘Ty³SŒ
(è=ð"AIG"è++
aigCouÁ
;

379 
cout
 << "Cœcu™ Sti¡ics" << 
’dl
;

380 
cout
 << "==================" << 
’dl
;

381 
cout
 << 
	`£tw
(7è<< 
Ëá
 << " PI" << s‘w(9è<< 
right
 << 
_piLi¡
.
	`size
(è<< 
’dl
;

382 
cout
 << 
	`£tw
(7è<< 
Ëá
 << " PO" << s‘w(9è<< 
right
 << 
_poLi¡
.
	`size
(è<< 
’dl
;

383 
cout
 << 
	`£tw
(7è<< 
Ëá
 << " AIG" << s‘w(9è<< 
right
 << 
aigCouÁ
 << 
’dl
;

384 
cout
 << "------------------" << 
’dl
;

385 
cout
 << 
	`£tw
(7è<< 
Ëá
 << " TOTAL" << s‘w(9è<< 
right
 << 
_piLi¡
.
	`size
()+
_poLi¡
.size()+
aigCouÁ
 << 
’dl
;

386 
	}
}

389 
	gCœMgr
::
	$´štN‘li¡
() const

391 
cout
 << 
’dl
;

392 
i
=0, 
n
=
_dfsLi¡
.
	`size
(); i<n; ++i) {

393 
cout
 << "[" << 
i
 << "] ";

394 
_dfsLi¡
[
i
]->
	`´štG©e
();

396 
	}
}

399 
	gCœMgr
::
	$´štPIs
() const

401 
cout
 << "PIs ofhe circuit:";

402 
size_t
 
i
=0; i<
_piLi¡
.
	`size
(); ++i)

403 
cout
 << " " << 
_piLi¡
[
i
]->
_id
;

404 
cout
 << 
’dl
;

405 
	}
}

408 
	gCœMgr
::
	$´štPOs
() const

410 
cout
 << "POs ofhe circuit:";

411 
size_t
 
i
=0; i<
_poLi¡
.
	`size
(); ++i)

412 
cout
 << " " << 
_poLi¡
[
i
]->
_id
;

413 
cout
 << 
’dl
;

414 
	}
}

417 
	gCœMgr
::
	$´štFlßtG©es
() const

419 
veùÜ
<> 
æßtšg
, 
unu£d
;

420 
UnM­
::
cÚ¡_™”©Ü
 
™
;

421 
™
=
_tÙ®Li¡
.
	`begš
(); it!=_tÙ®Li¡.
	`’d
(); ++it){

422 
™
->
£cÚd
->
	`g‘Ty³
()){

423 
UNDEF_GATE
:

425 
UndefG©e
* 
undefG©e
 = 
dyÇmic_ÿ¡
<UndefG©e*>(
™
->
£cÚd
);

426 if(!
undefG©e
->
_çnoutLi¡
.
	`em±y
())

427 
size_t
 
i
=0; i<
undefG©e
->
_çnoutLi¡
.
	`size
(); ++i)

428 
æßtšg
.
	`push_back
(
undefG©e
->
_çnoutLi¡
[
i
]->
_id
);

431 
PI_GATE
:

433 if(
dyÇmic_ÿ¡
<
PiG©e
*>(
™
->
£cÚd
)->
_çnoutLi¡
.
	`em±y
())

434 
unu£d
.
	`push_back
(
™
->
fœ¡
);

437 
AIG_GATE
:

439 if(
dyÇmic_ÿ¡
<
AigG©e
*>(
™
->
£cÚd
)->
_çnoutLi¡
.
	`em±y
())

440 
unu£d
.
	`push_back
(
™
->
fœ¡
);

448 if(!
æßtšg
.
	`em±y
()){

449 
cout
 << "Gates with floating fanin(s):";

450 
i
=
æßtšg
.
	`size
()-1; i>=0; --i)

451 
cout
 << " " << 
æßtšg
[
i
];

452 
cout
 << 
’dl
;

455 if(!
unu£d
.
	`em±y
()){

456 
cout
 << "Gates defined but‚ot used :";

457 
i
=
unu£d
.
	`size
()-1; i>=0; --i)

458 
cout
 << " " << 
unu£d
[
i
];

459 
cout
 << 
’dl
;

461 
	}
}

464 
	gCœMgr
::
	$´štFECPaœs
() const

466 
	}
}

469 
CœMgr
::
	$wr™eAag
(
o¡»am
& 
outfže
) const

471 
outfže
 << "aag";

472 
i
=0; i<5; ++iè
cout
 << " " << 
_MILOA
[i];

473 
outfže
 << 
’dl
;

475 
size_t
 
i
=0; i<
_piLi¡
.
	`size
(); ++i)

476 
outfže
 << 
_piLi¡
[
i
]->
_id
 * 2 << 
’dl
;

478 
size_t
 
i
=0; i<
_poLi¡
.
	`size
(); ++i)

479 
outfže
 << 
dyÇmic_ÿ¡
<
PoG©e
*>(
_poLi¡
[
i
])->
_çnš
[0] << 
’dl
;

481 
¡ack
<
CœG©e
*> 
aigRev”£
;

482 
UnM­
::
cÚ¡_™”©Ü
 
™
;

483 
™
=
_tÙ®Li¡
.
	`begš
(); it!=_tÙ®Li¡.
	`’d
(); ++it){

484 if(
™
->
£cÚd
->
	`g‘Ty³SŒ
() == "AIG")

485 
aigRev”£
.
	`push
(
™
->
£cÚd
);

486 !
aigRev”£
.
	`em±y
()){

487 
outfže
 << 
aigRev”£
.
	`tÝ
()->
_id
 * 2;

488 
outfže
 << 
dyÇmic_ÿ¡
<
AigG©e
*>(
aigRev”£
.
	`tÝ
())->
_çnš
[0];

489 
outfže
 << 
dyÇmic_ÿ¡
<
AigG©e
*>(
aigRev”£
.
	`tÝ
())->
_çnš
[1];

490 
aigRev”£
.
	`pÝ
();

494 
size_t
 
i
=0; i<
_piLi¡
.
	`size
(); ++i)

495 if(!
_piLi¡
[
i
]->
_symbÞ
.
	`em±y
())

496 
outfže
 << "i" << 
i
 << " " << 
_piLi¡
[i]->
_symbÞ
 << 
’dl
;

498 
size_t
 
i
=0; i<
_poLi¡
.
	`size
(); ++i)

499 if(!
_poLi¡
[
i
]->
_symbÞ
.
	`em±y
())

500 
outfže
 << "i" << 
i
 << " " << 
_poLi¡
[i]->
_symbÞ
 << 
’dl
;

502 
size_t
 
i
=0; i<
_comm’ts
.
	`size
(); ++i)

503 
outfže
 << 
_comm’ts
[
i
] << 
’dl
;

504 
	}
}

507 
	gCœMgr
::
	$wr™eG©e
(
o¡»am
& 
outfže
, 
CœG©e
 *
g
) const

509 
	}
}

511 
	gCœMgr
::
	$š™
(){

512 
CœG©e
* 
g©e
 = 
Ãw
 
CÚ¡G©e
;

513 
g©e
->
	`£tIdLšeCÞ
(0, 0, 0);

514 
_tÙ®Li¡
.
	`š£¹
(
	`make_·œ
(
g©e
->
_id
, gate));

516 
_piLi¡
.
	`»£rve
(10000);

517 
_poLi¡
.
	`»£rve
(10000);

518 
_tÙ®Li¡
.
	`»£rve
(100000);

519 
_dfsLi¡
.
	`»£rve
(100000);

520 
	}
}

522 
	gCœMgr
::
	$þ—r
(){

523 
UnM­
::
™”©Ü
 
™
;

524 
™
=
_tÙ®Li¡
.
	`begš
(); it!=_tÙ®Li¡.
	`’d
(); ++it){

525 
d–‘e
 
™
->
£cÚd
;

526 
™
->
£cÚd
 = 0;

528 
	}
}

	@src/cir/cirMgr.h

9 #iâdeà
CIR_MGR_H


10 
	#CIR_MGR_H


	)

12 
	~<veùÜ
>

13 
	~<¡ršg
>

14 
	~<f¡»am
>

15 
	~<io¡»am
>

17 
usšg
 
Çme¥aû
 
	g¡d
;

21 
	~"cœDef.h
"

22 
	~"cœG©e.h
"

24 
CœMgr
 *
cœMgr
;

26 þas 
	cCœMgr


28 
	mpublic
:

29 
	$CœMgr
(): 
	$_myHashM­
(10000è{ 
	`š™
(); }

30 ~
	$CœMgr
(è{ 
	`þ—r
(); 
	}
}

34 
CœG©e
* 
	$g‘G©e
(
gid
) const {

35 
UnM­
::
cÚ¡_™”©Ü
 
™
;

36 
™
 = 
_tÙ®Li¡
.
	`fšd
(
gid
);

37 if(
™
 !ð
_tÙ®Li¡
.
	`’d
()è it->
£cÚd
;

39 
	}
}

42 
boÞ
 
»adCœcu™
(cÚ¡ 
¡ršg
&);

43 
cÚ¡ruùN‘
();

44 
dfsT¿v”§l
(cÚ¡ 
G©eLi¡
&);

47 
sw“p
();

48 
Ýtimize
();

51 
¿ndomSim
();

52 
fžeSim
(
if¡»am
&);

53 
	$£tSimLog
(
of¡»am
 *
logFže
è{ 
_simLog
 =†ogFže; 
	}
}

56 
¡¿sh
();

57 
	$´štFEC
() const;

58 
	`äaig
();

61 
	$´štSumm¬y
() const;

62 
	$´štN‘li¡
() const;

63 
	$´štPIs
() const;

64 
	$´štPOs
() const;

65 
	$´štFlßtG©es
() const;

66 
	$´štFECPaœs
() const;

67 
	$wr™eAag
(
o¡»am
&) const;

68 
	$wr™eG©e
(
o¡»am
&, 
CœG©e
*) const;

72 
	`š™
();

73 
	`þ—r
();

74 
	`dfsO±imize
(cÚ¡ 
G©eLi¡
&, 
UnS‘
&);

75 
	`dfsSŒash
(cÚ¡ 
G©eLi¡
&, 
HashM­
<
HashKey
, 
CœG©eV
>&);

77 
´iv©e
:

78 
of¡»am
 *
_simLog
;

80 
G©eLi¡
 
_piLi¡
;

81 
G©eLi¡
 
_poLi¡
;

82 
UnM­
 
_tÙ®Li¡
;

84 
G©eLi¡
 
_dfsLi¡
;

85 
CœG©ePaœLi¡
 
_fbLi¡
;

87 
IdLi¡
 
_MILOA
;

89 
veùÜ
<
¡ršg
> 
_comm’ts
;

91 
HashM­
<
HashKey
, 
CœG©eV
> 
_myHashM­
;

92 
	}
};

	@src/cir/cirOpt.cpp

9 
	~<ÿs£¹
>

10 
	~"cœMgr.h
"

11 
	~"cœG©e.h
"

12 
	~"utž.h
"

14 
usšg
 
Çme¥aû
 
	g¡d
;

34 
	gCœMgr
::
	$sw“p
()

36 
UnS‘
 
u£t
;

37 
size_t
 
i
=0; i<
_dfsLi¡
.
	`size
(); ++i)

38 
u£t
.
	`š£¹
(
_dfsLi¡
[
i
]->
_id
);

40 
£t
<> 
d–‘ed
;

41 
UnM­
::
™”©Ü
 
™
;

42 
UnS‘
::
™”©Ü
 
£tIt
;

43 
™
=
_tÙ®Li¡
.
	`begš
(); it!=_tÙ®Li¡.
	`’d
(); ++it){

44 
£tIt
 = 
u£t
.
	`fšd
(
™
->
fœ¡
);

45 if(
£tIt
 =ð
u£t
.
	`’d
()){

46 
™
->
£cÚd
->
	`g‘Ty³
()){

47 
AIG_GATE
:

49 
AigG©e
* 
aigG©e
 = 
dyÇmic_ÿ¡
<AigG©e*>(
™
->
£cÚd
);

50 
i
=0; i<2; ++i){

51 
CœG©e
* 
´evG©e
 = 
aigG©e
->
_çnšLi¡
[
i
].
	`g©e
();

52 
´evG©e
->
	`g‘Ty³
()){

53 
AIG_GATE
:

55 
AigG©e
* 
aigG©e
 = 
dyÇmic_ÿ¡
<AigG©e*>(
´evG©e
);

56 
size_t
 
j
=0; j<
aigG©e
->
_çnoutLi¡
.
	`size
(); ++j)

57 if(
aigG©e
->
_çnoutLi¡
[
j
] =ð
™
->
£cÚd
){

58 
aigG©e
->
_çnoutLi¡
.
	`”a£
×igG©e->_çnoutLi¡.
	`begš
()+
j
);

64 
CONST_GATE
:

66 
CÚ¡G©e
* 
cÚ¡G©e
 = 
dyÇmic_ÿ¡
<CÚ¡G©e*>(
´evG©e
);

67 
size_t
 
j
=0; j<
cÚ¡G©e
->
_çnoutLi¡
.
	`size
(); ++j)

68 if(
cÚ¡G©e
->
_çnoutLi¡
[
j
] =ð
™
->
£cÚd
){

69 
cÚ¡G©e
->
_çnoutLi¡
.
	`”a£
(cÚ¡G©e->_çnoutLi¡.
	`begš
()+
j
);

74 
PI_GATE
:

76 
PiG©e
* 
piG©e
 = 
dyÇmic_ÿ¡
<PiG©e*>(
´evG©e
);

77 
size_t
 
j
=0; j<
piG©e
->
_çnoutLi¡
.
	`size
(); ++j)

78 if(
piG©e
->
_çnoutLi¡
[
j
] =ð
™
->
£cÚd
){

79 
piG©e
->
_çnoutLi¡
.
	`”a£
ÕiG©e->_çnoutLi¡.
	`begš
()+
j
);

84 
UNDEF_GATE
:

86 
UndefG©e
* 
undefG©e
 = 
dyÇmic_ÿ¡
<UndefG©e*>(
´evG©e
);

87 
size_t
 
j
=0; j<
undefG©e
->
_çnoutLi¡
.
	`size
(); ++j)

88 if(
undefG©e
->
_çnoutLi¡
[
j
] =ð
™
->
£cÚd
){

89 
undefG©e
->
_çnoutLi¡
.
	`”a£
(undefG©e->_çnoutLi¡.
	`begš
()+
j
);

98 
d–‘ed
.
	`š£¹
(
™
->
fœ¡
);

101 
UNDEF_GATE
:

103 
UndefG©e
* 
undefG©e
 = 
dyÇmic_ÿ¡
<UndefG©e*>(
™
->
£cÚd
);

104 
size_t
 
i
=0; i<
undefG©e
->
_çnoutLi¡
.
	`size
(); ++i){

105 
CœG©e
* 
ÃxtG©e
 = 
undefG©e
->
_çnoutLi¡
[
i
];

106 
ÃxtG©e
->
	`g‘Ty³
()){

107 
PO_GATE
:

109 
PoG©e
* 
poG©e
 = 
dyÇmic_ÿ¡
<PoG©e*>(
ÃxtG©e
);

110 
poG©e
->
_çnšLi¡
.
	`þ—r
();

111 
poG©e
->
_çnš
.
	`þ—r
();

118 
d–‘ed
.
	`š£¹
(
™
->
fœ¡
);

121 
CONST_GATE
:

123 
CÚ¡G©e
* 
cÚ¡G©e
 = 
dyÇmic_ÿ¡
<CÚ¡G©e*>(
™
->
£cÚd
);

124 
cÚ¡G©e
->
_çnoutLi¡
.
	`þ—r
();

127 
PI_GATE
:

129 
PiG©e
* 
piG©e
 = 
dyÇmic_ÿ¡
<PiG©e*>(
™
->
£cÚd
);

130 
piG©e
->
_çnoutLi¡
.
	`þ—r
();

139 
£t
<>::
™”©Ü
 
d–It
;

140 
d–It
=
d–‘ed
.
	`begš
(); d–It!=d–‘ed.
	`’d
(); ++delIt){

141 
CœG©e
* 
tmp
 = 
	`g‘G©e
(*
d–It
);

142 
cout
 << "Sw“pšg: " << 
tmp
->
	`g‘Ty³SŒ
(è<< "(" <<mp->
_id
 << "è»moved..." << 
’dl
;

143 
d–‘e
 
tmp
;

144 
tmp
 = 0;

145 
_tÙ®Li¡
.
	`”a£
(*
d–It
);

147 
	}
}

153 
	gCœMgr
::
	$Ýtimize
()

155 
UnS‘
 
d–‘ed
;

156 
	`dfsO±imize
(
_poLi¡
, 
d–‘ed
);

158 
UnS‘
::
™”©Ü
 
d–It
;

159 
d–It
=
d–‘ed
.
	`begš
(); d–It!=d–‘ed.
	`’d
(); ++delIt){

160 
CœG©e
* 
tmp
 = 
	`g‘G©e
(*
d–It
);

161 
d–‘e
 
tmp
;

162 
tmp
 = 0;

163 
_tÙ®Li¡
.
	`”a£
(*
d–It
);

166 
_dfsLi¡
.
	`þ—r
();

167 
_fbLi¡
.
	`þ—r
();

168 
	`dfsT¿v”§l
(
_poLi¡
);

169 
	}
}

171 
	gCœMgr
::
	$dfsO±imize
(cÚ¡ 
G©eLi¡
& 
sškLi¡
, 
UnS‘
& 
d–‘ed
){

172 
CœG©e
::
	`£tGlob®Ref
();

173 
size_t
 
i
=0; i<
sškLi¡
.
	`size
(); ++i)

174 
sškLi¡
[
i
]->
	`dfsO±imize
(
d–‘ed
);

175 
	}
}

	@src/cir/cirSim.cpp

9 
	~<f¡»am
>

10 
	~<io¡»am
>

11 
	~<iomª
>

12 
	~<®gÜ™hm
>

13 
	~<ÿs£¹
>

14 
	~"cœMgr.h
"

15 
	~"cœG©e.h
"

16 
	~"utž.h
"

18 
usšg
 
Çme¥aû
 
	g¡d
;

35 
	gCœMgr
::
	$¿ndomSim
()

37 
	}
}

40 
CœMgr
::
	$fžeSim
(
if¡»am
& 
·‰”nFže
)

42 
	}
}

	@src/cmd/cmdCharDef.h

8 #iâdeà
CMD_CHAR_DEF_H


9 
	#CMD_CHAR_DEF_H


	)

11 
	~<þim™s
>

15 
	#TA_LINE_BEGIN_KEY
 1

	)

16 
	#TA_LINE_END_KEY
 5

	)

17 
	#TA_INPUT_END_KEY
 4

	)

18 
	#TA_TAB_KEY
 ('\t')

	)

19 
	#TA_NEWLINE_KEY
 ('\n')

	)

20 
	#TA_ESC_KEY
 27

	)

21 
	#TA_BACK_SPACE_KEY
 127

	)

22 
	#TA_ARROW_KEY_FLAG
 (1 << 8)

	)

23 
	#TA_ARROW_KEY_INT
 91

	)

24 
	#TA_ARROW_UP_KEY
 (65 + 
TA_ARROW_KEY_FLAG
)

	)

25 
	#TA_ARROW_DOWN_KEY
 (66 + 
TA_ARROW_KEY_FLAG
)

	)

26 
	#TA_ARROW_RIGHT_KEY
 (67 + 
TA_ARROW_KEY_FLAG
)

	)

27 
	#TA_ARROW_LEFT_KEY
 (68 + 
TA_ARROW_KEY_FLAG
)

	)

28 
	#TA_ARROW_KEY_BEGIN
 
TA_ARROW_UP_KEY


	)

29 
	#TA_ARROW_KEY_END
 
TA_ARROW_LEFT_KEY


	)

30 
	#TA_MOD_KEY_FLAG
 (1 << 9)

	)

31 
	#TA_MOD_KEY_INT
 91

	)

32 
	#TA_HOME_KEY
 (49 + 
TA_MOD_KEY_FLAG
)

	)

33 
	#TA_INSERT_KEY
 (50 + 
TA_MOD_KEY_FLAG
)

	)

34 
	#TA_DELETE_KEY
 (51 + 
TA_MOD_KEY_FLAG
)

	)

35 
	#TA_END_KEY
 (52 + 
TA_MOD_KEY_FLAG
)

	)

36 
	#TA_PG_UP_KEY
 (53 + 
TA_MOD_KEY_FLAG
)

	)

37 
	#TA_PG_DOWN_KEY
 (54 + 
TA_MOD_KEY_FLAG
)

	)

38 
	#TA_MOD_KEY_BEGIN
 
TA_HOME_KEY


	)

39 
	#TA_MOD_KEY_END
 
TA_PG_DOWN_KEY


	)

40 
	#TA_MOD_KEY_DUMMY
 126

	)

41 
	#TA_UNDEFINED_KEY
 
INT_MAX


	)

42 
	#TA_BEEP_CHAR
 7

	)

43 
	#TA_BACK_SPACE_CHAR
 8

	)

46 #iâdeà
TA_KB_SETTING


55 
	eP¬£Ch¬


59 
	mLINE_BEGIN_KEY
 = 1,

60 
	mLINE_END_KEY
 = 5,

61 
	mINPUT_END_KEY
 = 4,

62 
	mTAB_KEY
 = ('\t'),

63 
	mNEWLINE_KEY
 = ('\n'),

64 
	mESC_KEY
 = 27,

79 
	mBACK_SPACE_KEY
 = 127,

83 
	mARROW_KEY_FLAG
 = 1 << 8,

84 
	mARROW_KEY_INT
 = 91,

85 
	mARROW_UP_KEY
 = 65 + 
ARROW_KEY_FLAG
,

86 
	mARROW_DOWN_KEY
 = 66 + 
ARROW_KEY_FLAG
,

87 
	mARROW_RIGHT_KEY
 = 67 + 
ARROW_KEY_FLAG
,

88 
	mARROW_LEFT_KEY
 = 68 + 
ARROW_KEY_FLAG
,

89 
	mARROW_KEY_BEGIN
 = 
ARROW_UP_KEY
,

90 
	mARROW_KEY_END
 = 
ARROW_LEFT_KEY
,

96 
	mMOD_KEY_FLAG
 = 1 << 9,

97 
	mMOD_KEY_INT
 = 91,

98 
	mHOME_KEY
 = 49 + 
MOD_KEY_FLAG
,

99 
	mINSERT_KEY
 = 50 + 
MOD_KEY_FLAG
,

100 
	mDELETE_KEY
 = 51 + 
MOD_KEY_FLAG
,

101 
	mEND_KEY
 = 52 + 
MOD_KEY_FLAG
,

102 
	mPG_UP_KEY
 = 53 + 
MOD_KEY_FLAG
,

103 
	mPG_DOWN_KEY
 = 54 + 
MOD_KEY_FLAG
,

104 
	mMOD_KEY_BEGIN
 = 
HOME_KEY
,

105 
	mMOD_KEY_END
 = 
PG_DOWN_KEY
,

106 
	mMOD_KEY_DUMMY
 = 126,

110 
	mUNDEFINED_KEY
 = 
INT_MAX
,

113 
	mBEEP_CHAR
 = 7,

114 
	mBACK_SPACE_CHAR
 = 8,

117 
	mPARSE_CHAR_END


127 
	eP¬£Ch¬


131 
	mLINE_BEGIN_KEY
 = 
TA_LINE_BEGIN_KEY
,

132 
	mLINE_END_KEY
 = 
TA_LINE_END_KEY
,

133 
	mINPUT_END_KEY
 = 
TA_INPUT_END_KEY
,

134 
	mTAB_KEY
 = 
TA_TAB_KEY
,

135 
	mNEWLINE_KEY
 = 
TA_NEWLINE_KEY
,

136 
	mESC_KEY
 = 
TA_ESC_KEY
,

151 
	mBACK_SPACE_KEY
 = 
TA_BACK_SPACE_KEY
,

155 
	mARROW_KEY_FLAG
 = 
TA_ARROW_KEY_FLAG
,

156 
	mARROW_KEY_INT
 = 
TA_ARROW_KEY_INT
,

157 
	mARROW_UP_KEY
 = 
TA_ARROW_UP_KEY
,

158 
	mARROW_DOWN_KEY
 = 
TA_ARROW_DOWN_KEY
,

159 
	mARROW_RIGHT_KEY
 = 
TA_ARROW_RIGHT_KEY
,

160 
	mARROW_LEFT_KEY
 = 
TA_ARROW_LEFT_KEY
,

161 
	mARROW_KEY_BEGIN
 = 
TA_ARROW_KEY_BEGIN
,

162 
	mARROW_KEY_END
 = 
TA_ARROW_KEY_END
,

168 
	mMOD_KEY_FLAG
 = 
TA_MOD_KEY_FLAG
,

169 
	mMOD_KEY_INT
 = 
TA_MOD_KEY_INT
,

170 
	mHOME_KEY
 = 
TA_HOME_KEY
,

171 
	mINSERT_KEY
 = 
TA_INSERT_KEY
,

172 
	mDELETE_KEY
 = 
TA_DELETE_KEY
,

173 
	mEND_KEY
 = 
TA_END_KEY
,

174 
	mPG_UP_KEY
 = 
TA_PG_UP_KEY
,

175 
	mPG_DOWN_KEY
 = 
TA_PG_DOWN_KEY
,

176 
	mMOD_KEY_BEGIN
 = 
TA_MOD_KEY_BEGIN
,

177 
	mMOD_KEY_END
 = 
TA_MOD_KEY_END
,

178 
	mMOD_KEY_DUMMY
 = 
TA_MOD_KEY_DUMMY
,

182 
	mUNDEFINED_KEY
 = 
TA_UNDEFINED_KEY
,

185 
	mBEEP_CHAR
 = 
TA_BEEP_CHAR
,

186 
	mBACK_SPACE_CHAR
 = 
TA_BACK_SPACE_CHAR
,

189 
	mPARSE_CHAR_END


	@src/cmd/cmdParser.h

8 #iâdeà
CMD_PARSER_H


9 
	#CMD_PARSER_H


	)

11 
	~<io¡»am
>

12 
	~<f¡»am
>

13 
	~<¡ršg
>

14 
	~<veùÜ
>

15 
	~<m­
>

16 
	~<¡ack
>

18 
	~"cmdCh¬Def.h
"

20 
usšg
 
Çme¥aû
 
	g¡d
;

26 
þass
 
	gCmdExec
;

27 
þass
 
	gCmdP¬£r
;

33 
CmdP¬£r
* 
cmdMgr
;

39 
	eCmdExecStus


41 
	mCMD_EXEC_DONE
 = 0,

42 
	mCMD_EXEC_ERROR
 = 1,

43 
	mCMD_EXEC_QUIT
 = 2,

44 
	mCMD_EXEC_NOP
 = 3,

47 
	mCMD_EXEC_TOT


50 
	eCmdO±iÚE¼Ü


52 
	mCMD_OPT_MISSING
 = 0,

53 
	mCMD_OPT_EXTRA
 = 1,

54 
	mCMD_OPT_ILLEGAL
 = 2,

55 
	mCMD_OPT_FOPEN_FAIL
 = 3,

58 
	mCMD_OPT_ERROR_TOT


66 þas 
	cCmdExec


68 
	mpublic
:

69 
	$CmdExec
() {}

70 
vœtu®
 ~
	$CmdExec
(è{
	}
}

72 
vœtu®
 
CmdExecStus
 
exec
(cÚ¡ 
¡ršg
&) = 0;

73 
vœtu®
 
	$u§ge
(
o¡»am
&) const = 0;

74 
vœtu®
 
	$h–p
() const = 0;

76 
	$£tO±Cmd
(cÚ¡ 
¡ršg
& 
¡r
è{ 
_ÝtCmd
 = sŒ; 
	}
}

77 
boÞ
 
	$checkO±Cmd
(cÚ¡ 
¡ršg
& 
check
) const;

78 cÚ¡ 
¡ršg
& 
	$g‘O±Cmd
(ècÚ¡ {  
_ÝtCmd
; 
	}
}

80 
	g´Ùeùed
:

81 
boÞ
 
	$ËxSšgËO±iÚ
(cÚ¡ 
¡ršg
&, sŒšg&, 
boÞ
 
ÝtiÚ®
 = 
Œue
) const;

82 
boÞ
 
	`ËxO±iÚs
(cÚ¡ 
¡ršg
&, 
veùÜ
<¡ršg>&, 
size_t
 
nO±s
 = 0) const;

83 
CmdExecStus
 
	$”rÜO±iÚ
(
CmdO±iÚE¼Ü
 
”r
, cÚ¡ 
¡ršg
& 
Ýt
) const;

85 
´iv©e
:

86 
¡ršg
 
_ÝtCmd
;

87 
	}
};

89 
	#CmdCÏss
(
T
) \

90 
þass
 
T
: 
public
 
CmdExec
 \

92 
public
: \

93 
	`T
() {} \

94 ~
	`T
() {} \

95 
CmdExecStus
 
	`exec
(cÚ¡ 
¡ršg
& 
ÝtiÚ
); \

96 
	`u§ge
(
o¡»am
& 
os
) const; \

97 
	`h–p
() const; \

98 }

	)

105 þas 
	cCmdP¬£r


107 
	#READ_BUF_SIZE
 65536

	)

108 
	#PG_OFFSET
 10

	)

110 
	mm­
<cÚ¡ 
	t¡ršg
, 
	tCmdExec
*> 
	tCmdM­
;

111 
	m·œ
<cÚ¡ 
	t¡ršg
, 
	tCmdExec
*> 
	tCmdRegPaœ
;

113 
	mpublic
:

114 
	$CmdP¬£r
(cÚ¡ 
¡ršg
& 
p
è: 
	`_´om±
Õ), 
	`_dofže
(0),

115 
	`_»adBufPŒ
(
_»adBuf
), 
	`_»adBufEnd
(_readBuf),

116 
	`_hi¡ÜyIdx
(0), 
	`_bP»ssCouÁ
(0), 
	$_‹mpCmdStÜed
(
çl£
) {}

117 
vœtu®
 ~
	$CmdP¬£r
(è{
	}
}

119 
boÞ
 
Ý’Dofže
(cÚ¡ 
¡ršg
& 
dof
);

120 
þo£Dofže
();

122 
boÞ
 
»gCmd
(cÚ¡ 
¡ršg
&, , 
CmdExec
*);

123 
CmdExecStus
 
execOÃCmd
();

124 
	$´štH–ps
() const;

127 
	`´štHi¡Üy
(
nPršt
 = -1) const;

128 
CmdExec
* 
	`g‘Cmd
(
¡ršg
);

130 
´iv©e
:

132 
	$»£tBufAndPrštProm±
() {

133 
_»adBufPŒ
 = 
_»adBufEnd
 = 
_»adBuf
;

134 *
_»adBufPŒ
 = 0;

135 
_bP»ssCouÁ
 = 0;

136 
	`´štProm±
();

137 
	}
}

138 
P¬£Ch¬
 
	$g‘Ch¬
(
i¡»am
&) const;

139 
boÞ
 
	`»adCmd
(
i¡»am
&);

140 
CmdExec
* 
	`·r£Cmd
(
¡ršg
&);

141 
	`li¡Cmd
(cÚ¡ 
¡ršg
&);

142 
boÞ
 
	`li¡CmdDœ
(cÚ¡ 
¡ršg
&);

143 
	$´štProm±
(ècÚ¡ { 
cout
 << 
_´om±
; 
	}
}

144 
boÞ
 
pushDofže
();

145 
boÞ
 
pÝDofže
();

148 
boÞ
 
moveBufPŒ
(* const);

149 
boÞ
 
d–‘eCh¬
();

150 
š£¹Ch¬
(, = 1);

151 
d–‘eLše
();

152 
»´štCmd
();

153 
moveToHi¡Üy
(
šdex
);

154 
boÞ
 
addHi¡Üy
();

155 
»Œ›veHi¡Üy
();

156 #ifdeà
TA_KB_SETTING


157 
	$Te¡OÆy
(è{
	}
}

161 cÚ¡ 
¡ršg
 
	g_´om±
;

162 
if¡»am
* 
	g_dofže
;

163 
	g_»adBuf
[
READ_BUF_SIZE
];

165 * 
	g_»adBufPŒ
;

167 * 
	g_»adBufEnd
;

169 
	gveùÜ
<
	g¡ršg
> 
	g_hi¡Üy
;

170 
	g_hi¡ÜyIdx
;

174 
size_t
 
	g_bP»ssCouÁ
;

175 
boÞ
 
	g_‹mpCmdStÜed
;

179 
CmdM­
 
	g_cmdM­
;

180 
	g¡ack
<
	gif¡»am
*> 
	g_dofžeSck
;

	@src/main/main.cpp

9 
	~"utž.h
"

10 
	~"cmdP¬£r.h
"

12 
usšg
 
Çme¥aû
 
	g¡d
;

17 
CmdP¬£r
* 
	gcmdMgr
 = 
Ãw
 CmdParser("fraig> ");

19 
boÞ
 
š™CommÚCmd
();

20 
boÞ
 
š™CœCmd
();

23 
	$u§ge
()

25 
cout
 << "U§ge: cœTe¡ [ -Fž< doFž> ]" << 
’dl
;

26 
	}
}

29 
	$myex™
()

31 
	`u§ge
();

32 
	`ex™
(-1);

33 
	}
}

36 
	$maš
(
¬gc
, ** 
¬gv
)

38 
myU§ge
.
	`»£t
();

40 
if¡»am
 
dof
;

42 ià(
¬gc
 == 3) {

43 ià(
	`mySŒNCmp
("-Fže", 
¬gv
[1], 2) == 0) {

44 ià(!
cmdMgr
->
	`Ý’Dofže
(
¬gv
[2])) {

45 
û¼
 << "E¼Ü: cªnÙ o³Àfž\"" << 
¬gv
[2] << "\"!!\n";

46 
	`myex™
();

50 
û¼
 << "E¼Ü: unknowÀ¬gum’ˆ\"" << 
¬gv
[1] << "\"!!\n";

51 
	`myex™
();

54 ià(
¬gc
 != 1) {

55 
û¼
 << "E¼Ü: iÎeg®‚umb” oà¬gum’ˆ(" << 
¬gc
 << ")!!\n";

56 
	`myex™
();

59 ià(!
	`š™CommÚCmd
(è|| !
	`š™CœCmd
())

62 
CmdExecStus
 
¡©us
 = 
CMD_EXEC_DONE
;

63 
¡©us
 !ð
CMD_EXEC_QUIT
) {

64 
¡©us
 = 
cmdMgr
->
	`execOÃCmd
();

65 
cout
 << 
’dl
;

69 
	}
}

	@src/sat/File.cpp

1 
	~"Fže.h
"

3 
	gFže
::
	$Ý’
(
fže_desü
, 
FžeMode
 
m
, 
boÞ
 
own
)

5 ià(
fd
 !ð-1è::
	`þo£
(fd);

6 
fd
 = 
fže_desü
;

7 
mode
 = 
m
;

8 
own_fd
 = 
own
;

9 
pos
 = 0;

10 
buf
 = 
xm®loc
<
uch¬
>(
Fže_BufSize
);

11 ià(
mode
 =ð
READ
è
size
 = 
	`»ad
(
fd
, 
buf
, 
Fže_BufSize
);

12 
size
 = -1;

13 
	}
}

15 
	gFže
::
	$Ý’
(
cch¬
* 
Çme
, cch¬* 
mode_
)

17 ià(
fd
 !ð-1è::
	`þo£
(fd);

18 
boÞ
 
has_r
 = 
	`¡rchr
(
mode_
, 'r'è!ð
NULL
;

19 
boÞ
 
has_w
 = 
	`¡rchr
(
mode_
, 'w'è!ð
NULL
;

20 
boÞ
 
has_a
 = 
	`¡rchr
(
mode_
, 'a'è!ð
NULL
;

21 
boÞ
 
has_p
 = 
	`¡rchr
(
mode_
, '+'è!ð
NULL
;

22 
boÞ
 
has_x
 = 
	`¡rchr
(
mode_
, 'x'è!ð
NULL
;

23 
	`as£¹
(!(
has_r
 && 
has_w
));

24 
	`as£¹
(
has_r
 || 
has_w
 || 
has_a
);

26 
mask
 = 0;

27 ià(
has_p
è
mask
 |ð
O_RDWR
;

28 ià(
has_r
è
mask
 |ð
O_RDONLY
;

29 
mask
 |ð
O_WRONLY
;

31 ià(!
has_r
è
mask
 |ð
O_CREAT
;

32 ià(
has_w
è
mask
 |ð
O_TRUNC
;

33 ià(
has_x
è
mask
 |ð
O_EXCL
;

35 
fd
 = 
	`Ý’64
(
Çme
, 
mask
, 
S_IRUSR
|
S_IWUSR
|
S_IRGRP
|
S_IWGRP
|
S_IROTH
|
S_IWOTH
);

37 ià(
fd
 != -1){

38 
mode
 = 
has_r
 ? 
READ
 : 
WRITE
;

39 
own_fd
 = 
Œue
;

40 
pos
 = 0;

41 ià(
has_a
è
	`l£ek64
(
fd
, 0, 
SEEK_END
);

42 
buf
 = 
xm®loc
<
uch¬
>(
Fže_BufSize
);

43 ià(
mode
 =ð
READ
è
size
 = 
	`»ad
(
fd
, 
buf
, 
Fže_BufSize
);

44 
size
 = -1;

46 
	}
}

49 
	gFže
::
	$þo£
()

51 ià(
fd
 == -1) ;

52 ià(
mode
 =ð
WRITE
)

53 
	`æush
();

54 
	`xä“
(
buf
); buàð
NULL
;

55 ià(
own_fd
)

56 ::
	`þo£
(
fd
);

57 
fd
 = -1;

58 
	}
}

60 
	gFže
::
	$£ek
(
št64
 
fže_pos
, 
wh’û
)

62 ià(
mode
 =ð
WRITE
){

63 
	`æush
();

64 
pos
 = 0;

65 
	`l£ek64
(
fd
, 
fže_pos
, 
wh’û
);

67 ià(
wh’û
 =ð
SEEK_CUR
è
	`l£ek64
(
fd
, 
fže_pos
 - (
size
 - 
pos
), SEEK_CUR);

68 
	`l£ek64
(
fd
, 
fže_pos
, 
wh’û
);

69 
size
 = 
	`»ad
(
fd
, 
buf
, 
Fže_BufSize
);

70 
pos
 = 0;

72 
	}
}

74 
št64
 
	gFže
::
	$‹Î
()

76 ià(
mode
 =ð
WRITE
)

77  
	`l£ek64
(
fd
, 0, 
SEEK_CUR
);

79  
	`l£ek64
(
fd
, 0, 
SEEK_CUR
è- (
size
 - 
pos
);

80 
	}
}

87 
	$putUIÁ
(
Fže
& 
out
, 
ušt64
 
v®
)

89 ià(
v®
 < 0x20000000){

90 
ušt
 
v
 = (ušt)
v®
;

91 ià(
v
 < 0x80)

92 
out
.
	`putCh¬
(
v
);

94 ià(
v
 < 0x2000)

95 
out
.
	`putCh¬
(0x80 | (
v
 >> 8)),

96 
out
.
	`putCh¬
((
uch¬
)
v
);

97 ià(
v
 < 0x200000)

98 
out
.
	`putCh¬
(0xA0 | (
v
 >> 16)),

99 
out
.
	`putCh¬
((
uch¬
)(
v
 >> 8)),

100 
out
.
	`putCh¬
((
uch¬
)
v
);

102 
out
.
	`putCh¬
((
v
 >> 24) | 0xC0),

103 
out
.
	`putCh¬
((
uch¬
)(
v
 >> 16)),

104 
out
.
	`putCh¬
((
uch¬
)(
v
 >> 8)),

105 
out
.
	`putCh¬
((
uch¬
)
v
);

108 
out
.
	`putCh¬
(0xE0),

109 
out
.
	`putCh¬
((
uch¬
)(
v®
 >> 56)),

110 
out
.
	`putCh¬
((
uch¬
)(
v®
 >> 48)),

111 
out
.
	`putCh¬
((
uch¬
)(
v®
 >> 40)),

112 
out
.
	`putCh¬
((
uch¬
)(
v®
 >> 32)),

113 
out
.
	`putCh¬
((
uch¬
)(
v®
 >> 24)),

114 
out
.
	`putCh¬
((
uch¬
)(
v®
 >> 16)),

115 
out
.
	`putCh¬
((
uch¬
)(
v®
 >> 8)),

116 
out
.
	`putCh¬
((
uch¬
)
v®
);

117 
	}
}

120 
ušt64
 
	$g‘UIÁ
(
Fže
& 
š
)

124 
ušt
 
by‹0
, 
by‹1
, 
by‹2
, 
by‹3
, 
by‹4
, 
by‹5
, 
by‹6
, 
by‹7
;

125 
by‹0
 = 
š
.
	`g‘Ch¬
();

126 ià(
by‹0
 =ð(
ušt
)
EOF
)

127 
throw
 
	`Exû±iÚ_EOF
();

128 ià(!(
by‹0
 & 0x80))

129  
by‹0
;

131 (
by‹0
 & 0x60) >> 5){

133 
by‹1
 = 
š
.
	`g‘Ch¬
();

134  ((
by‹0
 & 0x1Fè<< 8è| 
by‹1
;

136 
by‹1
 = 
š
.
	`g‘Ch¬
();

137 
by‹2
 = 
š
.
	`g‘Ch¬
();

138  ((
by‹0
 & 0x1Fè<< 16è| (
by‹1
 << 8è| 
by‹2
;

140 
by‹1
 = 
š
.
	`g‘Ch¬
();

141 
by‹2
 = 
š
.
	`g‘Ch¬
();

142 
by‹3
 = 
š
.
	`g‘Ch¬
();

143  ((
by‹0
 & 0x1Fè<< 24è| (
by‹1
 << 16è| (
by‹2
 << 8è| 
by‹3
;

145 
by‹0
 = 
š
.
	`g‘Ch¬
();

146 
by‹1
 = 
š
.
	`g‘Ch¬
();

147 
by‹2
 = 
š
.
	`g‘Ch¬
();

148 
by‹3
 = 
š
.
	`g‘Ch¬
();

149 
by‹4
 = 
š
.
	`g‘Ch¬
();

150 
by‹5
 = 
š
.
	`g‘Ch¬
();

151 
by‹6
 = 
š
.
	`g‘Ch¬
();

152 
by‹7
 = 
š
.
	`g‘Ch¬
();

153  ((
ušt64
)((
by‹0
 << 24è| (
by‹1
 << 16è| (
by‹2
 << 8è| 
by‹3
) << 32)

154 | (
ušt64
)((
by‹4
 << 24è| (
by‹5
 << 16è| (
by‹6
 << 8è| 
by‹7
);

157 
	}
}

	@src/sat/File.h

1 #iâdeà
Fže_h


2 
	#Fže_h


	)

4 #iâdeà
Glob®_h


5 
	~"Glob®.h
"

8 
	~<uni¡d.h
>

9 
	~<fúŽ.h
>

10 
	~<sys/¡©.h
>

12 #iâdeà
_LARGEFILE64_SOURCE


13 
	#l£ek64
 ::
l£ek


	)

14 
	#Ý’64
 ::
Ý’


	)

22 
	#Fže_BufSize
 1024

23 

	)

24 
	eFžeMode
 { 
	mREAD
, 
	mWRITE
 };

26 þas 
	cExû±iÚ_EOF
 {};

31 þas 
	cFže
 {

32 
	mfd
;

33 
FžeMode
 
	mmode
;

34 
uch¬
* 
	mbuf
;

35 
	msize
;

36 
	mpos
;

37 
boÞ
 
	mown_fd
;

39 
	mpublic
:

40 
	#DEFAULTS
 
	`fd
(-1), 
	`mode
(
READ
), 
	`buf
(
NULL
), 
	`size
(-1), 
	`pos
(0), 
	$own_fd
(
Œue
)

	)

41 
	$Fže
(è: 
DEFAULTS
 {}

43 
	$Fže
(
fd
, 
FžeMode
 
mode
, 
boÞ
 
own_fd
 = 
Œue
è: 
DEFAULTS
 {

44 
	`Ý’
(
fd
, 
mode
, 
own_fd
); 
	}
}

46 
	$Fže
(
cch¬
* 
Çme
, cch¬* 
mode
è: 
DEFAULTS
 {

47 
	`Ý’
(
Çme
, 
mode
); 
	}
}

48 #undeà
DEFAULTS


50 ~
	$Fže
() {

51 
	`þo£
(); 
	}
}

53 
Ý’
(
fd
, 
FžeMode
 
mode
, 
boÞ
 
own_fd
 = 
Œue
);

54 
Ý’
(
cch¬
* 
Çme
, cch¬* 
mode
);

55 
þo£
();

57 
boÞ
 
	$nuÎ
() {

58  
fd
 =ð-1; 
	}
}

60 
	$»Ëa£DesütÜ
() {

61 ià(
mode
 =ð
READ
)

62 
	`l£ek64
(
fd
, 
pos
 - 
size
, 
SEEK_CUR
);

63 
own_fd
 = 
çl£
;

64  
fd
; 
	}
}

66 
FžeMode
 
	$g‘Mode
() {

67  
mode
; 
	}
}

69 
	$£tMode
(
FžeMode
 
m
) {

70 ià(
m
 =ð
mode
) ;

71 ià(
m
 =ð
READ
){

72 
	`æush
();

73 
size
 = 
	`»ad
(
fd
, 
buf
, 
Fže_BufSize
);

75 
	`l£ek64
(
fd
, 
pos
 - 
size
, 
SEEK_CUR
);

76 
size
 = -1; }

77 
mode
 = 
m
;

78 
pos
 = 0; 
	}
}

80 
	$g‘Ch¬Q
() {

81 #ifdeà
PARANOID


82 
	`as£¹
(
mode
 =ð
READ
);

84 ià(
pos
 < 
size
è (
uch¬
)
buf
[pos++];

85 ià(
size
 < 
Fže_BufSize
è 
EOF
;

86 
size
 = 
	`»ad
(
fd
, 
buf
, 
Fže_BufSize
);

87 
pos
 = 0;

88 ià(
size
 =ð0è 
EOF
;

89  (
uch¬
)
buf
[
pos
++]; 
	}
}

91 
	$putCh¬Q
(
chr
) {

92 #ifdeà
PARANOID


93 
	`as£¹
(
mode
 =ð
WRITE
);

95 ià(
pos
 =ð
Fže_BufSize
)

96 
	`wr™e
(
fd
, 
buf
, 
Fže_BufSize
),

97 
pos
 = 0;

98  
buf
[
pos
++] = (
uch¬
)
chr
; 
	}
}

100 
	$g‘Ch¬
() {

101 ià(
mode
 =ð
WRITE
è
	`£tMode
(
READ
);

102  
	`g‘Ch¬Q
(); 
	}
}

104 
	$putCh¬
(
chr
) {

105 ià(
mode
 =ð
READ
è
	`£tMode
(
WRITE
);

106  
	`putCh¬Q
(
chr
); 
	}
}

108 
boÞ
 
	$eof
() {

109 
	`as£¹
(
mode
 =ð
READ
);

110 ià(
pos
 < 
size
è 
çl£
;

111 ià(
size
 < 
Fže_BufSize
è 
Œue
;

112 
size
 = 
	`»ad
(
fd
, 
buf
, 
Fže_BufSize
);

113 
pos
 = 0;

114 ià(
size
 =ð0è 
Œue
;

115  
çl£
; 
	}
}

117 
	$æush
() {

118 
	`as£¹
(
mode
 =ð
WRITE
);

119 
	`wr™e
(
fd
, 
buf
, 
pos
);

120 
pos
 = 0; 
	}
}

122 
£ek
(
št64
 
pos
, 
wh’û
 = 
SEEK_SET
);

123 
št64
 
‹Î
();

131 
putUIÁ
 (
Fže
& 
out
, 
ušt64
 
v®
);

134 
ušt64
 
g‘UIÁ
 (
Fže
& 
š
);

135 
šlše
 
ušt64
 
	$’code64
(
št64
 
v®
è{  (v® >ð0è? (
ušt64
)v® << 1 : (((ušt64)(~v®è<< 1è| 1); 
	}
}

136 
šlše
 
št64
 
	$decode64
(
ušt64
 
v®
è{  ((v® & 1è=ð0è? (
št64
)(v® >> 1è: ~(št64)(v® >> 1); 
	}
}

137 
šlše
 
	$putIÁ
 (
Fže
& 
out
, 
št64
 
v®
è{ 
	`putUIÁ
(out, 
	`’code64
(v®)); 
	}
}

138 
šlše
 
ušt64
 
	$g‘IÁ
 (
Fže
& 
š
è{  
	`decode64
(
	`g‘UIÁ
(š)); 
	}
}

	@src/sat/Global.h

20 #iâdeà
Glob®_h


21 
	#Glob®_h


	)

23 
	~<ÿs£¹
>

24 
	~<c¡dio
>

25 
	~<c¡dlib
>

26 
	~<c¡ršg
>

27 
	~<þim™s
>

28 
	~<cæßt
>

29 
	~<Ãw
>

36 #ifdeà
_MSC_VER


37 
INT64
 
	tšt64
;

38 
UINT64
 
	tušt64
;

39 
INT_PTR
 
	tš
;

40 
UINT_PTR
 
	tuš
;

41 
	#I64_fmt
 "I64d"

	)

43 
	tšt64
;

44 
	tušt64
;

45 
__PTRDIFF_TYPE__
 
	tš
;

46 
	t__PTRDIFF_TYPE__
 
	tuš
;

47 
	#I64_fmt
 "Îd"

	)

49 
	tuch¬
;

50 cÚ¡ 
	tcch¬
;

53 #iâdeà
ušt


54 
	tušt
;

57 
	g‹m¶©e
<
þass
 
	gT
> 
šlše
 
T
 
	$mš
(
T
 
x
, T 
y
è{  (x < yè? x : y; 
	}
}

58 
	g‹m¶©e
<
þass
 
	gT
> 
šlše
 
T
 
	$max
(
T
 
x
, T 
y
è{  (x > yè? x : y; 
	}
}

60 
	g‹m¶©e
 <
	gboÞ
> 
	sSTATIC_ASSERTION_FAILURE
 {};

62 
	#TEMPLATE_FAIL
 
STATIC_ASSERTION_FAILURE
<
çl£
>()

	)

69 
	g‹m¶©e
<
þass
 
	gT
> 
šlše
 
T
* 
	$xm®loc
(
size_t
 
size
) {

70 
T
* 
tmp
 = (T*)
	`m®loc
(
size
 * (T));

71 
	`as£¹
(
size
 =ð0 || 
tmp
 !ð
NULL
);

72  
tmp
; 
	}
}

74 
	g‹m¶©e
<
þass
 
	gT
> 
šlše
 
T
* 
	$x»®loc
(
T
* 
±r
, 
size_t
 
size
) {

75 
T
* 
tmp
 = (T*)
	`»®loc
((*)
±r
, 
size
 * (T));

76 
	`as£¹
(
size
 =ð0 || 
tmp
 !ð
NULL
);

77  
tmp
; 
	}
}

79 
	g‹m¶©e
<
þass
 
	gT
> 
šlše
 
	$xä“
(
T
 *
±r
) {

80 ià(
±r
 !ð
NULL
è
	`ä“
((*íŒ); 
	}
}

88 
šlše
 
	$d¿nd
(& 
£ed
) {

89 
£ed
 *= 1389796;

90 
q
 = ()(
£ed
 / 2147483647);

91 
£ed
 -ð()
q
 * 2147483647;

92  
£ed
 / 2147483647; 
	}
}

95 
šlše
 
	$œªd
(& 
£ed
, 
size
) {

96  ()(
	`d¿nd
(
£ed
è* 
size
); 
	}
}

104 #ifdeà
_MSC_VER


106 
	~<ùime
>

108 
šlše
 
	$ýuTime
() {

109  ()
	`þock
(è/ 
CLOCKS_PER_SEC
; 
	}
}

111 
šlše
 
št64
 
	$memU£d
() {

112  0; 
	}
}

117 
	~<sys/time.h
>

118 
	~<sys/»sourû.h
>

119 
	~<uni¡d.h
>

121 
šlše
 
	$ýuTime
() {

122 
ru§ge
 
ru
;

123 
	`g‘ru§ge
(
RUSAGE_SELF
, &
ru
);

124  ()
ru
.
ru_utime
.
tv_£c
 + (ìu.ru_utime.
tv_u£c
 / 1000000; 
	}
}

126 
šlše
 
	$memR—dSt
(
f›ld
)

128 
Çme
[256];

129 
pid_t
 
pid
 = 
	`g‘pid
();

130 
	`¥rštf
(
Çme
, "/´oc/%d/¡©m", 
pid
);

131 
FILE
* 
š
 = 
	`fÝ’
(
Çme
, "rb");

132 ià(
š
 =ð
NULL
)  0;

133 
v®ue
;

134 ; 
f›ld
 >= 0; field--)

135 
	`fsÿnf
(
š
, "%d", &
v®ue
);

136 
	`fþo£
(
š
);

137  
v®ue
;

138 
	}
}

140 
šlše
 
št64
 
	$memU£d
(è{  (
št64
)
	`memR—dSt
(0è* (št64)
	`g‘·gesize
(); 
	}
}

153 
	g‹m¶©e
<
þass
 
	gT
>

154 þas 
	cvec
 {

155 
T
* 
	md©a
;

156 
	msz
;

157 
	mÿp
;

159 
š™
(
size
, cÚ¡ 
T
& 
·d
);

160 
grow
(
mš_ÿp
);

162 
	mpublic
:

164 
	tKey
;

165 
T
 
	tD©um
;

168 
	$vec
(è: 
	`d©a
(
NULL
è, 
	`sz
(0è, 
	$ÿp
(0) { }

169 
	$vec
(
size
è: 
	`d©a
(
NULL
è, 
	`sz
(0è, 
	$ÿp
(0è{ 
	`growTo
(
size
); 
	}
}

170 
	$vec
(
size
, cÚ¡ 
T
& 
·d
è: 
	`d©a
(
NULL
è, 
	`sz
(0è, 
	$ÿp
(0è{ 
	`growTo
(
size
, 
·d
); 
	}
}

171 
	$vec
(
T
* 
¬¿y
, 
size
è: 
	`d©a
×¼ay), 
	`sz
(size), 
	$ÿp
(
size
è{ 
	}
}

172 ~
	$vec
(è{ 
	`þ—r
(
Œue
); 
	}
}

175 
T
* 
	$»Ëa£
 (è{ 
T
* 
»t
 = 
d©a
; d©¨ð
NULL
; 
sz
 = 0; 
ÿp
 = 0; „‘; 
	}
}

176 
Ý”©Ü
 
	gT
* (è{  
	gd©a
; }

177 
Ý”©Ü
 cÚ¡ 
	gT
* (ècÚ¡ {  
	gd©a
; }

180 
	$size
 (ècÚ¡ {  
sz
; 
	}
}

181 
	$shršk
 (
ÃËms
è{ 
	`as£¹
Ò–em <ð
sz
); 
i
 = 0; i <‚–ems; i++èsz--, 
d©a
[sz].~
	`T
(); 
	}
}

182 
	$pÝ
 (è{ 
sz
--, 
d©a
[sz].~
	`T
(); 
	}
}

183 
growTo
 (
size
);

184 
growTo
 (
size
, cÚ¡ 
T
& 
·d
);

185 
þ—r
 (
boÞ
 
d—Îoc
 = 
çl£
);

186 
	$ÿ·c™y
 (
size
è{ 
	`grow
(size); 
	}
}

189 
	$push
 (è{ ià(
sz
 =ð
ÿp
è
	`grow
(sz+1); 
	`Ãw
 (&
d©a
[sz]è
	`T
(è; sz++; 
	}
}

190 
	$push
 (cÚ¡ 
T
& 
–em
è{ ià(
sz
 =ð
ÿp
è
	`grow
(sz+1); 
	`Ãw
 (&
d©a
[sz]è
	`T
ÓËm); sz++; 
	}
}

191 cÚ¡ 
	gT
& 
	$Ï¡
 (ècÚ¡ {  
d©a
[
sz
-1]; 
	}
}

192 
	gT
& 
	$Ï¡
 (è{  
d©a
[
sz
-1]; 
	}
}

195 cÚ¡ 
	gT
& 
	gÝ”©Ü
 [] (
	gšdex
ècÚ¡ {  
	gd©a
[
šdex
]; }

196 
	gT
& 
	gÝ”©Ü
 [] (
	gšdex
è{  
	gd©a
[
šdex
]; }

199 
	gvec
<
	gT
>& 
	gÝ”©Ü
 = (
vec
<
T
>& 
Ùh”
è{ 
TEMPLATE_FAIL
; }

200 
vec
 (vec<
T
>& 
Ùh”
è{ 
	gTEMPLATE_FAIL
; }

203 
cÝyTo
(
vec
<
T
>& 
cÝy
ècÚ¡ { 
	gcÝy
.
þ—r
(); cÝy.
growTo
(
sz
); 
	gi
 = 0; i < 
	gsz
; i++è
Ãw
 (&cÝy[
i
]èT(
d©a
[i]); }

204 
moveTo
(
vec
<
T
>& 
de¡
è{ 
	gde¡
.
þ—r
(
Œue
); de¡.
	gd©a
 = 
d©a
; de¡.
	gsz
 = 
sz
; de¡.
	gÿp
 = 
ÿp
; d©¨ð
NULL
; sz = 0; cap = 0; }

207 
	g‹m¶©e
<
þass
 
	gT
>

208 
	gvec
<
	gT
>::
	$grow
(
mš_ÿp
) {

209 ià(
mš_ÿp
 <ð
ÿp
) ;

210 ià(
ÿp
 =ð0èÿ°ð(
mš_ÿp
 >= 2) ? min_cap : 2;

211 dØ
ÿp
 = (ÿp*3+1è>> 1; ÿ°< 
mš_ÿp
);

212 
d©a
 = 
	`x»®loc
(d©a, 
ÿp
); 
	}
}

214 
	g‹m¶©e
<
þass
 
	gT
>

215 
	gvec
<
	gT
>::
	$growTo
(
size
, cÚ¡ 
T
& 
·d
) {

216 ià(
sz
 >ð
size
) ;

217 
	`grow
(
size
);

218 
i
 = 
sz
; i < 
size
; i++è
	`Ãw
 (&
d©a
[i]è
	`T
(
·d
);

219 
sz
 = 
size
; 
	}
}

221 
	g‹m¶©e
<
þass
 
	gT
>

222 
	gvec
<
	gT
>::
	$growTo
(
size
) {

223 ià(
sz
 >ð
size
) ;

224 
	`grow
(
size
);

225 
i
 = 
sz
; i < 
size
; i++è
	`Ãw
 (&
d©a
[i]è
	`T
();

226 
sz
 = 
size
; 
	}
}

228 
	g‹m¶©e
<
þass
 
	gT
>

229 
	gvec
<
	gT
>::
	$þ—r
(
boÞ
 
d—Îoc
) {

230 ià(
d©a
 !ð
NULL
){

231 
i
 = 0; i < 
sz
; i++è
d©a
[i].~
	`T
();

232 
sz
 = 0;

233 ià(
d—Îoc
è
	`xä“
(
d©a
), d©¨ð
NULL
, 
ÿp
 = 0; } 
	}
}

240 þas 
	clboÞ
 {

241 
	mv®ue
;

242 
ex¶ic™
 
	$lboÞ
(
v
è: 
	$v®ue
(
v
) { }

244 
public
:

245 
	$lboÞ
(è: 
	$v®ue
(0è{ 
	}
}

246 
	$lboÞ
(
boÞ
 
x
è: 
	`v®ue
(()x*2-1è{ 
	}
}

247 
	$toIÁ
(ècÚ¡ {  
v®ue
; 
	}
}

249 
boÞ
 
	gÝ”©Ü
 =ð(cÚ¡ 
lboÞ
& 
Ùh”
ècÚ¡ {  
v®ue
 == other.value; }

250 
boÞ
 
	gÝ”©Ü
 !ð(cÚ¡ 
lboÞ
& 
Ùh”
ècÚ¡ {  
v®ue
 != other.value; }

251 
lboÞ
 
	gÝ”©Ü
 ~ (ècÚ¡ { †boÞ(-
v®ue
); }

253 
ä›nd
 
toIÁ
 (
lboÞ
 
l
);

254 
ä›nd
 
lboÞ
 
toLboÞ
(
v
);

256 
šlše
 
	$toIÁ
 (
lboÞ
 
l
è{ †.
	`toIÁ
(); 
	}
}

257 
šlše
 
lboÞ
 
	$toLboÞ
(
v
è{  
	`lboÞ
(v); 
	}
}

259 cÚ¡ 
lboÞ
 
	gl_True
 = 
toLboÞ
( 1);

260 cÚ¡ 
lboÞ
 
	gl_F®£
 = 
toLboÞ
(-1);

261 cÚ¡ 
lboÞ
 
	gl_Undef
 = 
toLboÞ
( 0);

268 #iâdeà
__SGI_STL_INTERNAL_RELOPS


269 
	#__SGI_STL_INTERNAL_RELOPS


	)

270 
	g‹m¶©e
 <
þass
 
	gT
> 
šlše
 
boÞ
 
	gÝ”©Ü
 !ð(cÚ¡ 
T
& 
x
, cÚ¡ T& 
	gy
è{  !(
	gx
 =ð
y
); }

271 
	g‹m¶©e
 <
þass
 
	gT
> 
šlše
 
boÞ
 
	gÝ”©Ü
 > (cÚ¡ T& 
	gx
, cÚ¡ T& 
	gy
) {  y < x; }

272 
	g‹m¶©e
 <
þass
 
	gT
> 
šlše
 
boÞ
 
	gÝ”©Ü
 <ð(cÚ¡ 
T
& 
x
, cÚ¡ T& 
	gy
è{  !(y < 
	gx
); }

273 
	g‹m¶©e
 <
þass
 
	gT
> 
šlše
 
boÞ
 
	gÝ”©Ü
 >ð(cÚ¡ 
T
& 
x
, cÚ¡ T& 
	gy
è{  !(
	gx
 < y); }

	@src/sat/Heap.h

20 #iâdeà
H—p_h


21 
	#H—p_h


	)

27 
šlše
 
	$Ëá
 (
i
è{  i+i; 
	}
}

28 
šlše
 
	$right
 (
i
è{  i+˜+ 1; 
	}
}

29 
šlše
 
	$·»Á
(
i
è{  i >> 1; 
	}
}

31 
	g‹m¶©e
<
þass
 
	gC
>

32 þas 
	cH—p
 {

33 
	mpublic
:

34 
C
 
comp
;

35 
	mvec
<> 
	mh—p
;

36 
	mvec
<> 
	mšdiûs
;

38 
šlše
 
	$³rcÞ©eUp
(
i
)

40 
x
 = 
h—p
[
i
];

41 
	`·»Á
(
i
è!ð0 && 
	`comp
(
x
,
h—p
[parent(i)])){

42 
h—p
[
i
] = h—p[
	`·»Á
(i)];

43 
šdiûs
[
h—p
[
i
]] = i;

44 
i
 = 
	`·»Á
(i);

46 
h—p
 [
i
] = 
x
;

47 
šdiûs
[
x
] = 
i
;

50 
šlše
 
	$³rcÞ©eDown
(
i
)

52 
x
 = 
h—p
[
i
];

53 
	`Ëá
(
i
è< 
h—p
.
	`size
()){

54 
chžd
 = 
	`right
(
i
è< 
h—p
.
	`size
(è&& 
	`comp
(h—p[right(i)],h—p[
	`Ëá
(i)]) ?„ight(i) :†eft(i);

55 ià(!
	`comp
(
h—p
[
chžd
],
x
)) ;

56 
h—p
[
i
] = h—p[
chžd
];

57 
šdiûs
[
h—p
[
i
]] = i;

58 
i
 = 
chžd
;

60 
h—p
 [
i
] = 
x
;

61 
šdiûs
[
x
] = 
i
;

62 
	}
}

64 
boÞ
 
	$ok
(
n
è{ ‚ >ð0 &&‚ < ()
šdiûs
.
	`size
(); 
	}
}

66 
	gpublic
:

67 
	$H—p
(
C
 
c
è: 
	$comp
(
c
è{ 
h—p
.
	`push
(-1); 
	}
}

69 
	$£tBounds
 (
size
è{ 
	`as£¹
(siz>ð0); 
šdiûs
.
	`growTo
(size,0); 
	}
}

70 
boÞ
 
	$šH—p
 (
n
è{ 
	`as£¹
(
	`ok
Ò));  
šdiûs
[n] !ð0; 
	}
}

71 
	$šü—£
 (
n
è{ 
	`as£¹
(
	`ok
Ò));‡s£¹(
	`šH—p
Ò)); 
	`³rcÞ©eUp
(
šdiûs
[n]); 
	}
}

72 
boÞ
 
	$em±y
 (è{  
h—p
.
	`size
(è=ð1; 
	}
}

74 
	$š£¹
(
n
) {

75 
	`as£¹
(
	`ok
(
n
));

76 
šdiûs
[
n
] = 
h—p
.
	`size
();

77 
h—p
.
	`push
(
n
);

78 
	`³rcÞ©eUp
(
šdiûs
[
n
]); 
	}
}

80 
	$g‘mš
() {

81 
r
 = 
h—p
[1];

82 
h—p
[1] = h—p.
	`Ï¡
();

83 
šdiûs
[
h—p
[1]] = 1;

84 
šdiûs
[
r
] = 0;

85 
h—p
.
	`pÝ
();

86 ià(
h—p
.
	`size
() > 1)

87 
	`³rcÞ©eDown
(1);

88  
r
; 
	}
}

90 
boÞ
 
	$h—pPrÝ”ty
() {

91  
	`h—pPrÝ”ty
(1); 
	}
}

93 
boÞ
 
	$h—pPrÝ”ty
(
i
) {

94  (
size_t
)
i
 >ð
h—p
.
	`size
()

95 || ((
	`·»Á
(
i
è=ð0 || !
	`comp
(
h—p
[i],h—p[·»Á(i)])è&& 
	`h—pPrÝ”ty
(
	`Ëá
(i)è&& h—pPrÝ”ty(
	`right
(i))); 
	}
}

	@src/sat/Proof.cpp

20 
	~"Proof.h
"

21 
	~"SÜt.h
"

22 
	~<c¡ršg
>

28 þas 
	cTempFžes
 {

29 
	mvec
<
	mcch¬
*> 
	mfžes
;

31 
	mpublic
:

32 ~
	$TempFžes
()

34 
i
 = 0; i < 
fžes
.
	`size
(); i++)

35 
	`»move
(
fžes
[
i
]);

42 * 
	$Ý’
(
Fže
& 
å
)

46 * 
Çme
 = 
Ãw
 [64];

47 
	`¡rýy
(
Çme
, "/tmp/fileXXXXXX");

51 
å
.
	`Ý’
Ð
	`mk¡emp
(
Çme
è, 
WRITE
 , 
Œue
 );

52 
	`as£¹
(
Çme
 !ð
NULL
);

53 ià(
å
.
	`nuÎ
())

54 
	`xä“
(
Çme
);

56 
fžes
.
	`push
(
Çme
);

57  
Çme
;

60 
	}
}

62 
TempFžes
 
	g‹mp_fžes
;

69 
	gProof
::
	$Proof
()

71 
å_Çme
 = 
‹mp_fžes
.
	`Ý’
(
å
);

72 
id_couÁ”
 = 0;

73 
Œav
 = 
NULL
;

74 
TRA_INT
 = 0;

75 
åos
 =0 ;

76 
	}
}

79 
	gProof
::
	$Proof
(
ProofT¿v”£r
& 
t
)

81 
id_couÁ”
 = 0;

82 
Œav
 = &
t
;

83 
TRA_INT
 = 0;

84 
åos
 = 0;

85 
	}
}

88 
CÏu£Id
 
	gProof
::
addRoÙ
(
vec
<
L™
>& 
þ
, 
boÞ
 
A
)

90 
	gþ
.
cÝyTo
(
þau£
);

91 
sÜtUnique
(
þau£
);

93 ià(
	gŒav
 !ð
NULL
)

94 
Œav
->
roÙ
(
þau£
, 
A
);

95 ià(!
	gå
.
nuÎ
()){

96 
putUIÁ
(
å
, 
šdex
(
þau£
[0]) << 1);

97 
	gi
 = 1; i < 
	gþau£
.
size
(); i++)

98 
putUIÁ
(
å
, 
šdex
(
þau£
[
i
]) - index(clause[i-1]));

99 
putUIÁ
(
å
, 0);

100 if(
	gA
è
putUIÁ
(
å
 , 1);

101 
putUIÁ
(
å
 , 2 );

104  
	gid_couÁ”
++;

108 
	gProof
::
	$begšChaš
(
CÏu£Id
 
¡¬t
)

110 
	`as£¹
(
¡¬t
 !ð
CÏu£Id_NULL
);

111 
chaš_id
 .
	`þ—r
();

112 
chaš_l™
.
	`þ—r
();

113 
chaš_id
.
	`push
(
¡¬t
);

114 
	}
}

117 
	gProof
::
	$»sÞve
(
CÏu£Id
 
Ãxt
, 
L™
 
x
)

119 
	`as£¹
(
Ãxt
 !ð
CÏu£Id_NULL
);

120 
chaš_id
 .
	`push
(
Ãxt
);

121 
chaš_l™
.
	`push
(
x
);

122 
	}
}

125 
CÏu£Id
 
	gProof
::
	$’dChaš
()

127 
	`as£¹
(
chaš_id
.
	`size
(è=ð
chaš_l™
.size() + 1);

128 ià(
chaš_id
.
	`size
() == 1)

129  
chaš_id
[0];

131 ià(
Œav
 !ð
NULL
)

132 
Œav
->
	`chaš
(
chaš_id
, 
chaš_l™
);

133 ià(!
å
.
	`nuÎ
()){

134 
	`putUIÁ
(
å
, ((
id_couÁ”
 - 
chaš_id
[0]) << 1) | 1);

135 
i
 = 0; i < 
chaš_l™
.
	`size
(); i++)

136 
	`putUIÁ
(
å
, 
	`šdex
(
chaš_l™
[
i
])+1 ),

137 
	`putUIÁ
(
å
, 
id_couÁ”
 - 
chaš_id
[
i
+1]);

138 
	`putUIÁ
(
å
, 0);

141  
id_couÁ”
++;

143 
	}
}

146 
	gProof
::
	$d–‘ed
(
CÏu£Id
 
gÚe
)

148 ià(
Œav
 !ð
NULL
)

149 
Œav
->
	`d–‘ed
(
gÚe
);

150 ià(!
å
.
	`nuÎ
()){

151 
	`putUIÁ
(
å
, ((
id_couÁ”
 - 
gÚe
) << 1) | 1);

152 
	`putUIÁ
(
å
, 0);

154 
	}
}

161 
	gProof
::
	$com´ess
(
Proof
& 
d¡
, 
CÏu£Id
 
gßl
)

163 
	`as£¹
(!
å
.
	`nuÎ
());

164 
	`as£¹
(
çl£
);

165 
	}
}

168 
boÞ
 
	gProof
::
	$§ve
(
cch¬
* 
fž’ame
)

170 
	`as£¹
(!
å
.
	`nuÎ
());

173 
å
.
	`£tMode
(
READ
);

174 
å
.
	`£ek
(0);

177 
Fže
 
	`out
(
fž’ame
, "wox");

178 ià(
out
.
	`nuÎ
())

179  
çl£
;

181 !
å
.
	`eof
())

182 
out
.
	`putCh¬
(
å
.
	`g‘Ch¬
());

185 
å
.
	`£ek
(0, 
SEEK_END
);

186 
å
.
	`£tMode
(
WRITE
);

187  
Œue
;

188 
	}
}

191 
	gProof
::
	$Œav”£
(
ProofT¿v”£r
& 
Œav
, 
CÏu£Id
 
gßl
)

193 
	`as£¹
(!
å
.
	`nuÎ
());

196 
å
.
	`£tMode
(
READ
);

197 
å
.
	`£ek
Ð
åos
 );

200 ià(
gßl
 =ð
CÏu£Id_NULL
)

201 
gßl
 = 
	`Ï¡
();

203 
ušt64
 
tmp
;

204 
idx
;

205 
boÞ
 
A
;

207 
CÏu£Id
 
id
 = 
TRA_INT
 ; id <ð
gßl
; id++){

208 
tmp
 = 
	`g‘UIÁ
(
å
);

209 ià((
tmp
 & 1) == 0){

211 
þau£
.
	`þ—r
();

212 
idx
 = 
tmp
 >> 1;

213 
þau£
.
	`push
(
	`toL™
(
idx
));

215 
tmp
 = 
	`g‘UIÁ
(
å
);

216 ià(
tmp
 == 0) ;

217 
idx
 +ð
tmp
;

218 
þau£
.
	`push
(
	`toL™
(
idx
));

220 ifÐ
	`g‘UIÁ
(
å
è=ð1 ) 
A
 = 
Œue
;

221 
A
 = 
çl£
;

223 
Œav
.
	`roÙ
(
þau£
 ,
A
);

229 
chaš_id
 .
	`þ—r
();

230 
chaš_l™
.
	`þ—r
();

231 
chaš_id
.
	`push
(
id
 - (
tmp
 >> 1));

233 
tmp
 = 
	`g‘UIÁ
(
å
);

234 ià(
tmp
 == 0) ;

235 
chaš_l™
.
	`push
(
	`toL™
Ð
tmp
 - 1));

236 
tmp
 = 
	`g‘UIÁ
(
å
);

237 
chaš_id
.
	`push
(
id
 - 
tmp
);

240 ià(
chaš_l™
.
	`size
() == 0)

241 
id
--,

242 
Œav
.
	`d–‘ed
(
chaš_id
[0]);

244 
Œav
.
	`chaš
(
chaš_id
, 
chaš_l™
);

247 
TRA_INT
 = 
gßl
+1;

248 
åos
 = 
å
.
	`‹Î
();

249 
å
.
	`£ek
(0, 
SEEK_END
);

250 
å
.
	`£tMode
(
WRITE
);

251 
	}
}

	@src/sat/Proof.h

20 #iâdeà
Proof_h


21 
	#Proof_h


	)

23 
	~"SÞv”Ty³s.h
"

24 
	~"Fže.h
"

34 
	sProofT¿v”£r
 {

35 
vœtu®
 
roÙ
 (cÚ¡ 
vec
<
L™
>& 
c
 , 
boÞ
 
A
)=0;

36 
vœtu®
 
chaš
 (cÚ¡ 
vec
<
CÏu£Id
>& 
cs
, cÚ¡ vec<
L™
>& 
xs
)=0;

37 
vœtu®
 
d–‘ed
(
CÏu£Id
 
c
){}

38 
vœtu®
 
dÚe
 ()=0;

39 
	mvœtu®
 ~
ProofT¿v”£r
(){}

43 þas 
	cProof
 {

44 
Fže
 
	må
;

45 
cch¬
* 
	må_Çme
;

46 
CÏu£Id
 
	mid_couÁ”
;

47 
ProofT¿v”£r
* 
	mŒav
;

49 
	mTRA_INT
;

50 
št64
 
	måos
;

52 
	mvec
<
	mL™
> 
	mþau£
;

53 
	mvec
<
	mCÏu£Id
> 
	mchaš_id
;

54 
	mvec
<
	mL™
> 
	mchaš_l™
;

56 
	mpublic
:

57 
Proof
();

58 
Proof
(
ProofT¿v”£r
& 
t
);

60 
CÏu£Id
 
addRoÙ
 (
vec
<
L™
>& 
þau£
 , 
boÞ
 
A
 );

61 
begšChaš
(
CÏu£Id
 
¡¬t
);

62 
»sÞve
 (
CÏu£Id
 
Ãxt
, 
L™
 
x
);

63 
CÏu£Id
 
’dChaš
 ();

64 
d–‘ed
 (
CÏu£Id
 
gÚe
);

65 
CÏu£Id
 
	$Ï¡
 (è{ 
	`as£¹
(
id_couÁ”
 !ð
CÏu£Id_NULL
);  id_counter - 1; }

67 
	`com´ess
 (
Proof
& 
d¡
, 
CÏu£Id
 
gßl
 = 
CÏu£Id_NULL
);

68 
boÞ
 
	`§ve
 (
cch¬
* 
fž’ame
);

69 
	`Œav”£
 (
ProofT¿v”£r
& 
Œav
, 
CÏu£Id
 
gßl
 = 
CÏu£Id_NULL
) ;

70 
	}
};

	@src/sat/Solver.cpp

20 
	~"SÞv”.h
"

21 
	~"SÜt.h
"

22 
	~<cm©h
>

24 
	geffLim™
 = 
INT_MAX
;

30 
»moveW©ch
(
vec
<
CÏu£
*>& 
ws
, CÏu£* 
–em
)

32 ià(
	gws
.
size
() == 0) ;

33 
	gj
 = 0;

34 ; 
	gws
[
j
] !ð
–em
 ; 
	gj
++è
as£¹
(j < 
ws
.
size
());

35 ; 
	gj
 < 
	gws
.
size
()-1; j++èws[
j
] = 
ws
[j+1];

36 
	gws
.
pÝ
();

63 
	gSÞv”
::
ÃwCÏu£
(cÚ¡ 
vec
<
L™
>& 
ps_
, 
boÞ
 
Ë¬Á
, 
CÏu£Id
 
id
 , boÞ 
A
)

65 
as£¹
(
Ë¬Á
 || 
id
 =ð
CÏu£Id_NULL
);

66 ià(!
	gok
) ;

68 
	gvec
<
	gL™
> 
	gqs
;

69 ià(!
	gË¬Á
){

70 
as£¹
(
decisiÚLev–
() == 0);

71 
	gps_
.
cÝyTo
(
qs
);

74 
sÜtUnique
(
qs
);

77 
	gi
 = 0; i < 
	gqs
.
size
()-1; i++){

78 ià(
	gqs
[
i
] =ð~
qs
[i+1])

80 
	gi
 = 0; i < 
	gqs
.
size
(); i++){

81 ià(
v®ue
(
qs
[
i
]è=ð
l_True
)

85 
	gi
, 
	gj
;

86 ià(
	g´oof
 !ð
NULL
è
´oof
->
begšChaš
Õroof->
addRoÙ
(
qs
,
A
));

87 
	gi
 = 
j
 = 0; i < 
	gqs
.
size
(); i++)

88 ià(
v®ue
(
qs
[
i
]è!ð
l_F®£
)

89 
qs
[
j
++] = qs[
i
];

91 ià(
	g´oof
 !ð
NULL
è
´oof
->
»sÞve
(
un™_id
[
v¬
(
qs
[
i
])], qs[i]);

92 
	gqs
.
shršk
(
i
 - 
j
);

93 ià(
	g´oof
 !ð
NULL
è
id
 = 
´oof
->
’dChaš
();

95 cÚ¡ 
	gvec
<
	gL™
>& 
	gps
 = 
Ë¬Á
 ? 
ps_
 : 
qs
;

97 ià(
	gps
.
size
() == 0){

98 
ok
 = 
çl£
;

100 }ià(
	gps
.
size
() == 1){

102 ià(
id
 !ð
CÏu£Id_NULL
)

103 
un™_id
[
v¬
(
ps
[0])] = 
id
;

104 ià(!
’queue
(
ps
[0]))

105 
	gok
 = 
çl£
;

109 
CÏu£
* 
	gc
 = 
CÏu£_Ãw
(
Ë¬Á
, 
ps
, 
id
);

111 ià(
	gË¬Á
){

113 
	gmax_i
 = 1;

114 
	gmax
 = 
Ëv–
[
v¬
(
ps
[1])];

115 
	gi
 = 2; i < 
	gps
.
size
(); i++)

116 ià(
	gËv–
[
v¬
(
ps
[
i
])] > 
	gmax
)

117 
	gmax
 = 
Ëv–
[
v¬
(
ps
[
i
])],

118 
	gmax_i
 = 
i
;

119 (*
	gc
)[1] = 
ps
[
max_i
];

120 (*
	gc
)[
max_i
] = 
ps
[1];

123 
þaBumpAùiv™y
(
c
);

126 
check
(
’queue
((*
c
)[0], c));

129 
	gw©ches
[
šdex
(~(*
c
)[0])].
push
(c);

130 
	gw©ches
[
šdex
(~(*
c
)[1])].
push
(c);

131 
	gË¬Ás
.
push
(
c
);

132 
	g¡©s
.
	gË¬Ás_l™”®s
 +ð
c
->
size
();

136 
	gw©ches
[
šdex
(~(*
c
)[0])].
push
(c);

137 
	gw©ches
[
šdex
(~(*
c
)[1])].
push
(c);

138 
	gþau£s
.
push
(
c
);

139 
	g¡©s
.
	gþau£s_l™”®s
 +ð
c
->
size
();

147 
	gSÞv”
::
	$»move
(
CÏu£
* 
c
, 
boÞ
 
ju¡_d—Îoc
)

149 ià(!
ju¡_d—Îoc
){

150 
	`»moveW©ch
(
w©ches
[
	`šdex
(~(*
c
)[0])], c),

151 
	`»moveW©ch
(
w©ches
[
	`šdex
(~(*
c
)[1])], c);

153 ià(
c
->
	`Ë¬Á
()è
¡©s
.
Ë¬Ás_l™”®s
 -ðc->
	`size
();

154 
¡©s
.
þau£s_l™”®s
 -ð
c
->
	`size
();

156 ià(
´oof
 !ð
NULL
è´oof->
	`d–‘ed
(
c
->
	`id
());

159 
	`xä“
(
c
);

160 
	}
}

167 
boÞ
 
	gSÞv”
::
	$sim¶ify
(
CÏu£
* 
c
) const

169 
	`as£¹
(
	`decisiÚLev–
() == 0);

170 
i
 = 0; i < 
c
->
	`size
(); i++){

171 ià(
	`v®ue
((*
c
)[
i
]è=ð
l_True
)

172  
Œue
;

174  
çl£
;

175 
	}
}

185 
V¬
 
	gSÞv”
::
	$ÃwV¬
() {

186 
šdex
;

187 
šdex
 = 
	`nV¬s
();

188 
w©ches
 .
	`push
();

189 
w©ches
 .
	`push
();

190 
»asÚ
 .
	`push
(
NULL
);

191 
assigns
 .
	`push
(
	`toIÁ
(
l_Undef
));

192 
Ëv–
 .
	`push
(-1);

193 
Œaž_pos
 .
	`push
(-1);

194 
aùiv™y
 .
	`push
(0);

195 
Üd”
 .
	`ÃwV¬
();

196 
ª®yze_£’
.
	`push
(0);

197 ià(
´oof
 !ð
NULL
è
un™_id
.
	`push
(
CÏu£Id_NULL
);

198  
šdex
; 
	}
}

202 
boÞ
 
	gSÞv”
::
	$assume
(
L™
 
p
) {

203 
Œaž_lim
.
	`push
(
Œaž
.
	`size
());

204  
	`’queue
(
p
); 
	}
}

208 
	gSÞv”
::
	$ÿnûlUÁž
(
Ëv–
) {

209 ià(
	`decisiÚLev–
(è> 
Ëv–
){

210 
c
 = 
Œaž
.
	`size
()-1; c >ð
Œaž_lim
[
Ëv–
]; c--){

211 
V¬
 
x
 = 
	`v¬
(
Œaž
[
c
]);

212 
assigns
[
x
] = 
	`toIÁ
(
l_Undef
);

213 
»asÚ
 [
x
] = 
NULL
;

214 
Üd”
.
	`undo
(
x
); }

215 
Œaž
.
	`shršk
Ñ¿ž.
	`size
(è- 
Œaž_lim
[
Ëv–
]);

216 
Œaž_lim
.
	`shršk
Ñ¿ž_lim.
	`size
(è- 
Ëv–
);

217 
qh—d
 = 
Œaž
.
	`size
(); } 
	}
}

241 þas 
	cÏ¡ToFœ¡_É
 {

242 cÚ¡ 
	mvec
<>& 
	mŒaž_pos
;

243 
	mpublic
:

244 
Ï¡ToFœ¡_É
(cÚ¡ 
vec
<>& 
t
è: 
	$Œaž_pos
(
t
) {}

245 
boÞ
 
	$Ý”©Ü
 (è(
L™
 
p
, L™ 
q
è{  
Œaž_pos
[
	`v¬
Õ)] >¿ž_pos[v¬(q)]; 
	}
}

247 
	gSÞv”
::
ª®yze
(
CÏu£
* 
cÚæ
, 
vec
<
L™
>& 
out_Ë¬Á
, & 
out_bŽev–
)

249 
	gvec
<>& 
	g£’
 = 
ª®yze_£’
;

250 
	g·thC
 = 0;

251 
L™
 
	gp
 = 
l™_Undef
;

255 ià(
	g´oof
 !ð
NULL
è
´oof
->
begšChaš
(
cÚæ
->
id
());

256 
	gout_Ë¬Á
.
push
();

257 
	gout_bŽev–
 = 0;

258 
	gšdex
 = 
Œaž
.
size
()-1;

260 
as£¹
(
cÚæ
 !ð
NULL
);

262 
	gCÏu£
& 
	gc
 = *
cÚæ
;

263 ià(
	gc
.
Ë¬Á
())

264 
þaBumpAùiv™y
(&
c
);

266 
	gj
 = (
p
 =ð
l™_Undef
è? 0 : 1; j < 
	gc
.
size
(); j++){

267 
L™
 
	gq
 = 
c
[
j
];

268 ià(!
	g£’
[
v¬
(
q
)]){

269 ià(
	gËv–
[
v¬
(
q
)] > 0){

270 
v¬BumpAùiv™y
(
q
);

271 
	g£’
[
v¬
(
q
)] = 1;

272 ià(
	gËv–
[
v¬
(
q
)] =ð
decisiÚLev–
())

273 
·thC
++;

275 
	gout_Ë¬Á
.
push
(
q
);

276 
	gout_bŽev–
 = 
max
(
out_bŽev–
, 
Ëv–
[
v¬
(
q
)]);

279 ià(
	g´oof
 !ð
NULL
è
´oof
->
»sÞve
(
un™_id
[
v¬
(
q
)], q);

284 !
	g£’
[
v¬
(
Œaž
[
šdex
--])]);

285 
	gp
 = 
Œaž
[
šdex
+1];

286 
	gcÚæ
 = 
»asÚ
[
v¬
(
p
)];

287 
	g£’
[
v¬
(
p
)] = 0;

288 
	g·thC
--;

289 ià(
	g·thC
 == 0) ;

291 ià(
	g´oof
 !ð
NULL
è
´oof
->
»sÞve
(
cÚæ
->
id
(), ~
p
);

293 
	gout_Ë¬Á
[0] = ~
p
;

297 
	gi
=0 , 
	gj
=0 ;

298 ià(
	gex³nsive_ccmš
 == 2){

301 
ušt
 
mš_Ëv–
 = 0;

302 
	gi
 = 1; i < 
	gout_Ë¬Á
.
size
(); i++)

303 
	gmš_Ëv–
 |ð1 << (
Ëv–
[
v¬
(
out_Ë¬Á
[
i
])] & 31);

305 
	gª®yze_toþ—r
.
þ—r
();

306 
	gi
 = 
j
 = 1; i < 
	gout_Ë¬Á
.
size
(); i++)

307 ià(
	g»asÚ
[
v¬
(
out_Ë¬Á
[
i
])] =ð
NULL
 || !
ª®yze_»movabË
(out_Ë¬Á[i], 
mš_Ëv–
))

308 
	gout_Ë¬Á
[
j
++] = 
out_Ë¬Á
[
i
];

309 }if(
	gex³nsive_ccmš
 == 1){

312 
ª®yze_toþ—r
.
þ—r
();

313 
	gi
 = 
j
 = 1; i < 
	gout_Ë¬Á
.
size
(); i++){

314 
CÏu£
* 
	gr
 = 
»asÚ
[
v¬
(
out_Ë¬Á
[
i
])];

315 ià(
	gr
 =ð
NULL
)

316 
out_Ë¬Á
[
j
++] = out_Ë¬Á[
i
];

318 
	gCÏu£
& 
	gc
 = *
r
;

319 
	gk
 = 1; k < 
	gc
.
size
(); k++)

320 ià(!
	g£’
[
v¬
(
c
[
k
])] && 
	gËv–
[var(c[k])] != 0){

321 
out_Ë¬Á
[
j
++] = out_Ë¬Á[
i
];

322 
	gK“p
;

324 
	gª®yze_toþ—r
.
push
(
out_Ë¬Á
[
i
]);

325 
	gK“p
:;

332 ià(
	g´oof
 !ð
NULL
){

333 
sÜt
(
ª®yze_toþ—r
, 
Ï¡ToFœ¡_É
(
Œaž_pos
));

334 
	gk
 = 0; k < 
	gª®yze_toþ—r
.
size
(); k++){

335 
V¬
 
	gv
 = 
v¬
(
ª®yze_toþ—r
[
k
]); 
as£¹
(
Ëv–
[
v
] > 0);

336 
L™
 
	gl
 = 
ª®yze_toþ—r
[
k
];

337 
	gCÏu£
& 
	gc
 = *
»asÚ
[
v
];

338 
	g´oof
->
»sÞve
(
c
.
id
(), 
l
);

339 
	gk
 = 1; k < 
	gc
.
size
(); k++)

340 ià(
	gËv–
[
v¬
(
c
[
k
])] == 0)

341 
´oof
->
»sÞve
(
un™_id
[
v¬
(
c
[
k
])], c[k]);

343 
	g´oof
->
’dChaš
();

347 
	gj
 = 0; j < 
	gout_Ë¬Á
.
size
(è; j++è
	g£’
[
v¬
(
out_Ë¬Á
 [
j
])] = 0;

348 
	gj
 = 0; j < 
	gª®yze_toþ—r
.
size
(); j++è
	g£’
[
v¬
(
ª®yze_toþ—r
[
j
])] = 0;

350 
	g¡©s
.
	gmax_l™”®s
 +ð
out_Ë¬Á
.
size
();

351 
	gout_Ë¬Á
.
shršk
(
i
 - 
j
);

352 
	g¡©s
.
	gtÙ_l™”®s
 +ð
out_Ë¬Á
.
size
();

358 
boÞ
 
	gSÞv”
::
	$ª®yze_»movabË
(
L™
 
p
, 
ušt
 
mš_Ëv–
)

360 
	`as£¹
(
»asÚ
[
	`v¬
(
p
)] !ð
NULL
);

361 
ª®yze_¡ack
.
	`þ—r
();‡Çlyze_¡ack.
	`push
(
p
);

362 
tÝ
 = 
ª®yze_toþ—r
.
	`size
();

363 
ª®yze_¡ack
.
	`size
() > 0){

364 
	`as£¹
(
»asÚ
[
	`v¬
(
ª®yze_¡ack
.
	`Ï¡
())] !ð
NULL
);

365 
CÏu£
& 
c
 = *
»asÚ
[
	`v¬
(
ª®yze_¡ack
.
	`Ï¡
())];

366 
ª®yze_¡ack
.
	`pÝ
();

367 
i
 = 1; i < 
c
.
	`size
(); i++){

368 
L™
 
p
 = 
c
[
i
];

369 ià(!
ª®yze_£’
[
	`v¬
(
p
)] && 
Ëv–
[var(p)] != 0){

370 ià(
»asÚ
[
	`v¬
(
p
)] !ð
NULL
 && ((1 << (
Ëv–
[v¬Õ)] & 31)è& 
mš_Ëv–
) != 0){

371 
ª®yze_£’
[
	`v¬
(
p
)] = 1;

372 
ª®yze_¡ack
.
	`push
(
p
);

373 
ª®yze_toþ—r
.
	`push
(
p
);

375 
j
 = 
tÝ
; j < 
ª®yze_toþ—r
.
	`size
(); j++)

376 
ª®yze_£’
[
	`v¬
(
ª®yze_toþ—r
[
j
])] = 0;

377 
ª®yze_toþ—r
.
	`shršk
×Çlyze_toþ—r.
	`size
(è- 
tÝ
);

378  
çl£
;

383 
ª®yze_toþ—r
.
	`push
(
p
);

385  
Œue
;

386 
	}
}

399 
	gSÞv”
::
	$ª®yzeFš®
(
CÏu£
* 
cÚæ
, 
boÞ
 
sk_fœ¡
)

402 
cÚæiù
.
	`þ—r
();

403 ià(
roÙ_Ëv–
 == 0){

404 ià(
´oof
 !ð
NULL
è
cÚæiù_id
 =…roof->
	`Ï¡
();

407 
vec
<>& 
£’
 = 
ª®yze_£’
;

408 ià(
´oof
 !ð
NULL
è´oof->
	`begšChaš
(
cÚæ
->
	`id
());

409 
i
 = 
sk_fœ¡
 ? 1 : 0; i < 
cÚæ
->
	`size
(); i++){

410 
V¬
 
x
 = 
	`v¬
((*
cÚæ
)[
i
]);

411 
L™
 
l
 = (*
cÚæ
)[
i
];

412 ià(
Ëv–
[
x
] > 0)

413 
£’
[
x
] = 1;

415 ià(
´oof
 !ð
NULL
è´oof->
	`»sÞve
(
un™_id
[
x
], 
l
);

418 
¡¬t
 = (
roÙ_Ëv–
 >ð
Œaž_lim
.
	`size
()è? 
Œaž
.size()-1 :rail_lim[root_level];

419 
i
 = 
¡¬t
; i >ð
Œaž_lim
[0]; i--){

420 
V¬
 
x
 = 
	`v¬
(
Œaž
[
i
]);

421 
L™
 
l
 = 
Œaž
[
i
];

422 ià(
£’
[
x
]){

423 
CÏu£
* 
r
 = 
»asÚ
[
x
];

424 ià(
r
 =ð
NULL
){

425 
	`as£¹
(
Ëv–
[
x
] > 0);

426 
cÚæiù
.
	`push
(~
Œaž
[
i
]);

428 
CÏu£
& 
c
 = *
r
;

429 ià(
´oof
 !ð
NULL
è´oof->
	`»sÞve
(
c
.
	`id
(), 
l
);

430 
j
 = 1; j < 
c
.
	`size
(); j++)

431 ià(
Ëv–
[
	`v¬
(
c
[
j
])] > 0)

432 
£’
[
	`v¬
(
c
[
j
])] = 1;

434 ià(
´oof
 !ð
NULL
è´oof->
	`»sÞve
(
un™_id
[
	`v¬
(
c
[
j
])], c[j]);

436 
£’
[
x
] = 0;

439 ià(
´oof
 !ð
NULL
è
cÚæiù_id
 =…roof->
	`’dChaš
();

440 
	}
}

459 
boÞ
 
	gSÞv”
::
	$’queue
(
L™
 
p
, 
CÏu£
* 
äom
)

461 ià(
	`v®ue
(
p
è!ð
l_Undef
)

462  
	`v®ue
(
p
è!ð
l_F®£
;

464 
V¬
 
x
 = 
	`v¬
(
p
);

465 
assigns
 [
x
] = 
	`toIÁ
(
	`lboÞ
(!
	`sign
(
p
)));

466 
Ëv–
 [
x
] = 
	`decisiÚLev–
();

467 
Œaž_pos
[
x
] = 
Œaž
.
	`size
();

468 
»asÚ
 [
x
] = 
äom
;

469 
Œaž
.
	`push
(
p
);

470  
Œue
;

472 
	}
}

487 
CÏu£
* 
	gSÞv”
::
	$´Ýag©e
()

489 
CÏu£
* 
cÚæ
 = 
NULL
;

490 
qh—d
 < 
Œaž
.
	`size
()){

491 
¡©s
.
´Ýag©iÚs
++;

492 
simpDB_´Ýs
--;

494 
L™
 
p
 = 
Œaž
[
qh—d
++];

495 
vec
<
CÏu£
*>& 
ws
 = 
w©ches
[
	`šdex
(
p
)];

496 
CÏu£
** 
i
,** 
j
,** 
’d
;

498 
i
 = 
j
 = (
CÏu£
**)
ws
, 
’d
 = i + ws.
	`size
(); i !=ƒnd;){

499 
CÏu£
& 
c
 = **
i
; i++;

501 
L™
 
çl£_l™
 = ~
p
;

502 ià(
c
[0] =ð
çl£_l™
)

503 
c
[0] = c[1], c[1] = 
çl£_l™
;

505 
	`as£¹
(
c
[1] =ð
çl£_l™
);

508 
L™
 
fœ¡
 = 
c
[0];

509 
lboÞ
 
v®
 = 
	`v®ue
(
fœ¡
);

510 ià(
v®
 =ð
l_True
){

511 *
j
++ = &
c
;

514 
k
 = 2; k < 
c
.
	`size
(); k++)

515 ià(
	`v®ue
(
c
[
k
]è!ð
l_F®£
){

516 
c
[1] = c[
k
]; c[k] = 
çl£_l™
;

517 
w©ches
[
	`šdex
(~
c
[1])].
	`push
(&c);

518 
FoundW©ch
; }

521 ià(
	`decisiÚLev–
(è=ð0 && 
´oof
 !ð
NULL
){

523 
´oof
->
	`begšChaš
(
c
.
	`id
());

524 
k
 = 1; k < 
c
.
	`size
(); k++)

525 
´oof
->
	`»sÞve
(
un™_id
[
	`v¬
(
c
[
k
])], c[k]);

526 
CÏu£Id
 
id
 = 
´oof
->
	`’dChaš
();

527 
	`as£¹
(
un™_id
[
	`v¬
(
fœ¡
)] =ð
CÏu£Id_NULL
 || 
	`v®ue
(fœ¡è=ð
l_F®£
);

528 ià(
	`v®ue
(
fœ¡
è!ð
l_F®£
)

529 
un™_id
[
	`v¬
(
fœ¡
)] = 
id
;

532 
´oof
->
	`begšChaš
(
un™_id
[
	`v¬
(
fœ¡
)]);

533 
´oof
->
	`»sÞve
(
id
, ~
fœ¡
);

534 
´oof
->
	`’dChaš
();

538 *
j
++ = &
c
;

539 ià(!
	`’queue
(
fœ¡
, &
c
)){

540 ià(
	`decisiÚLev–
() == 0)

541 
ok
 = 
çl£
;

542 
cÚæ
 = &
c
;

543 
qh—d
 = 
Œaž
.
	`size
();

545 
i
 < 
’d
)

546 *
j
++ = *
i
++;

548 
FoundW©ch
:;

551 
ws
.
	`shršk
(
i
 - 
j
);

554  
cÚæ
;

555 
	}
}

566 
	s»duûDB_É
 { 
boÞ
 
Ý”©Ü
 (è(
CÏu£
* 
	mx
, CÏu£* 
	my
è{  x->
size
(è> 2 && (y->size(è=ð2 || 
x
->
aùiv™y
(è< 
y
->activity()); } };

567 
	gSÞv”
::
	$»duûDB
()

569 
i
, 
j
;

570 
exŒa_lim
 = 
þa_šc
 / 
Ë¬Ás
.
	`size
();

572 
	`sÜt
(
Ë¬Ás
, 
	`»duûDB_É
());

573 
i
 = 
j
 = 0; i < 
Ë¬Ás
.
	`size
() / 2; i++){

574 ià(
Ë¬Ás
[
i
]->
	`size
(è> 2 && !
	`locked
(learnts[i]))

575 
	`»move
(
Ë¬Ás
[
i
]);

577 
Ë¬Ás
[
j
++] =†—ºts[
i
];

579 ; 
i
 < 
Ë¬Ás
.
	`size
(); i++){

580 ià(
Ë¬Ás
[
i
]->
	`size
(è> 2 && !
	`locked
Ö—ºts[i]è&&†—ºts[i]->
	`aùiv™y
(è< 
exŒa_lim
)

581 
	`»move
(
Ë¬Ás
[
i
]);

583 
Ë¬Ás
[
j
++] =†—ºts[
i
];

585 
Ë¬Ás
.
	`shršk
(
i
 - 
j
);

586 
	}
}

597 
	gSÞv”
::
	$sim¶ifyDB
()

599 ià(!
ok
) ;

600 
	`as£¹
(
	`decisiÚLev–
() == 0);

602 ià(
	`´Ýag©e
(è!ð
NULL
){

603 
ok
 = 
çl£
;

606 ià(
	`nAssigns
(è=ð
simpDB_assigns
 || 
simpDB_´Ýs
 > 0)

610 
i
 = 
simpDB_assigns
; i < 
	`nAssigns
(); i++){

611 
L™
 
p
 = 
Œaž
[
i
];

612 
w©ches
[
	`šdex
Ð
p
)].
	`þ—r
(
Œue
);

613 
w©ches
[
	`šdex
(~
p
)].
	`þ—r
(
Œue
);

617 
ty³
 = 0;ype < 2;ype++){

618 
vec
<
CÏu£
*>& 
cs
 = 
ty³
 ? 
Ë¬Ás
 : 
þau£s
;

619 
j
 = 0;

620 
i
 = 0; i < 
cs
.
	`size
(); i++){

621 ià(!
	`locked
(
cs
[
i
]è&& 
	`sim¶ify
(cs[i]))

622 
	`»move
(
cs
[
i
]);

624 
cs
[
j
++] = cs[
i
];

626 
cs
.
	`shršk
(cs.
	`size
()-
j
);

629 
simpDB_assigns
 = 
	`nAssigns
();

630 
simpDB_´Ýs
 = 
¡©s
.
þau£s_l™”®s
 + sts.
Ë¬Ás_l™”®s
;

631 
	}
}

648 
lboÞ
 
	gSÞv”
::
	$£¬ch
(
nof_cÚæiùs
, 
nof_Ë¬Ás
, cÚ¡ 
S—rchP¬ams
& 
·¿ms
)

650 ià(!
ok
è 
l_F®£
;

651 
	`as£¹
(
roÙ_Ëv–
 =ð
	`decisiÚLev–
());

653 
¡©s
.
¡¬ts
++;

654 
cÚæiùC
 = 0;

655 
v¬_deÿy
 = 1 / 
·¿ms
.var_decay;

656 
þa_deÿy
 = 1 / 
·¿ms
.
þau£_deÿy
;

657 
mod–
.
	`þ—r
();

660 
CÏu£
* 
cÚæ
 = 
	`´Ýag©e
();

661 ià(
cÚæ
 !ð
NULL
){

664 
¡©s
.
cÚæiùs
++; 
cÚæiùC
++;

665 
vec
<
L™
> 
Ë¬Á_þau£
;

666 
backŒack_Ëv–
;

667 ià(
	`decisiÚLev–
(è=ð
roÙ_Ëv–
){

669 
	`ª®yzeFš®
(
cÚæ
);

670  
l_F®£
; }

671 
	`ª®yze
(
cÚæ
, 
Ë¬Á_þau£
, 
backŒack_Ëv–
);

672 
	`ÿnûlUÁž
(
	`max
(
backŒack_Ëv–
, 
roÙ_Ëv–
));

673 
	`ÃwCÏu£
(
Ë¬Á_þau£
, 
Œue
, (
´oof
 !ð
NULL
è?…roof->
	`Ï¡
(è: 
CÏu£Id_NULL
);

674 ià(
Ë¬Á_þau£
.
	`size
(è=ð1è
Ëv–
[
	`v¬
(learnt_clause[0])] = 0;

675 
	`v¬DeÿyAùiv™y
();

676 
	`þaDeÿyAùiv™y
();

681 ià(
nof_cÚæiùs
 >ð0 && 
cÚæiùC
 >=‚of_conflicts){

683 
´og»ss_e¡im©e
 = 
	`´og»ssE¡im©e
();

684 
	`ÿnûlUÁž
(
roÙ_Ëv–
);

685  
l_Undef
; }

687 ià(
	`decisiÚLev–
() == 0)

689 
	`sim¶ifyDB
(), 
	`as£¹
(
ok
);

691 ià(
nof_Ë¬Ás
 >ð0 && 
Ë¬Ás
.
	`size
()-
	`nAssigns
() >=‚of_learnts)

693 
	`»duûDB
();

696 
¡©s
.
decisiÚs
++;

697 
V¬
 
Ãxt
 = 
Üd”
.
	`£Ëù
(
·¿ms
.
¿ndom_v¬_äeq
);

699 ià(
Ãxt
 =ð
v¬_Undef
){

701 
mod–
.
	`growTo
(
	`nV¬s
());

702 
i
 = 0; i < 
	`nV¬s
(); i++è
mod–
[i] = 
	`v®ue
(i);

703 
	`ÿnûlUÁž
(
roÙ_Ëv–
);

704  
l_True
;

707 
	`check
(
	`assume
(~
	`L™
(
Ãxt
)));

710 
	}
}

715 
	gSÞv”
::
	$´og»ssE¡im©e
()

717 
´og»ss
 = 0;

718 
F
 = 1.0 / 
	`nV¬s
();

719 
i
 = 0; i < 
	`nV¬s
(); i++)

720 ià(
	`v®ue
(
i
è!ð
l_Undef
)

721 
´og»ss
 +ð
	`pow
(
F
, 
Ëv–
[
i
]);

722  
´og»ss
 / 
	`nV¬s
();

723 
	}
}

728 
	gSÞv”
::
	$v¬ResÿËAùiv™y
()

730 
i
 = 0; i < 
	`nV¬s
(); i++)

731 
aùiv™y
[
i
] *= 1e-100;

732 
v¬_šc
 *= 1e-100;

733 
	}
}

738 
	gSÞv”
::
	$þaResÿËAùiv™y
()

740 
i
 = 0; i < 
Ë¬Ás
.
	`size
(); i++)

741 
Ë¬Ás
[
i
]->
	`aùiv™y
() *= 1e-20;

742 
þa_šc
 *= 1e-20;

743 
	}
}

759 
boÞ
 
	gSÞv”
::
sÞve
(cÚ¡ 
vec
<
L™
>& 
assumps
)

761 
sim¶ifyDB
();

762 ià(!
	gok
è 
	gçl£
;

764 
S—rchP¬ams
 
·¿ms
(
deçuÉ_·¿ms
);

765 
	gnof_cÚæiùs
 = 100;

766 
	gnof_Ë¬Ás
 = 
nCÏu£s
() / 3;

767 
lboÞ
 
	g¡©us
 = 
l_Undef
;

770 
	groÙ_Ëv–
 = 
assumps
.
size
();

771 
	gi
 = 0; i < 
	gassumps
.
size
(); i++){

772 
L™
 
	gp
 = 
assumps
[
i
];

773 
as£¹
(
v¬
(
p
è< 
nV¬s
());

774 ià(!
assume
(
p
)){

775 ià(
	g»asÚ
[
v¬
(
p
)] !ð
NULL
){

776 
ª®yzeFš®
(
»asÚ
[
v¬
(
p
)], 
Œue
);

777 
	gcÚæiù
.
push
(~
p
);

779 
as£¹
(
´oof
 =ð
NULL
 || 
un™_id
[
v¬
(
p
)] !ð
CÏu£Id_NULL
);

780 
	gcÚæiù
.
þ—r
();

781 
	gcÚæiù
.
push
(~
p
);

782 ià(
	g´oof
 !ð
NULL
è
cÚæiù_id
 = 
un™_id
[
v¬
(
p
)];

784 
ÿnûlUÁž
(0);

785  
	gçl£
; }

786 
CÏu£
* 
	gcÚæ
 = 
´Ýag©e
();

787 ià(
	gcÚæ
 !ð
NULL
){

788 
ª®yzeFš®
(
cÚæ
), 
as£¹
(
cÚæiù
.
size
() > 0);

789 
ÿnûlUÁž
(0);

790  
	gçl£
; }

792 
as£¹
(
roÙ_Ëv–
 =ð
decisiÚLev–
());

795 ià(
	gv”bos™y
 >= 1){

796 
»pÜtf
("==================================[MINISAT]");

797 
»pÜtf
("===================================\n");

798 
»pÜtf
("| Conflicts | ORIGINAL | ");

799 
»pÜtf
("LEARNT | Progress |\n");

800 
»pÜtf
("| | Clauses Literals | Limit Clauses ");

801 
»pÜtf
("Literals Lit/Cl | |\n");

802 
»pÜtf
("===========================================");

803 
»pÜtf
("===================================\n");

806 
	g¡©us
 =ð
l_Undef
){

807 ià(
v”bos™y
 >= 1){

808 
´štSts
();

809 
»pÜtf
("| %9d | %7d %8d | %7d %7d %8d %7.1f | %6.3f %% |\n",

810 ()
¡©s
.
cÚæiùs
, 
nCÏu£s
(),

811 ()
¡©s
.
þau£s_l™”®s
,

812 ()
nof_Ë¬Ás
, 
nL—ºts
(),

813 ()
¡©s
.
Ë¬Ás_l™”®s
,

814 ()
¡©s
.
Ë¬Ás_l™”®s
/
nL—ºts
(),

815 
´og»ss_e¡im©e
*100);

816 
fæush
(
¡dout
);

818 
	g¡©us
 = 
£¬ch
(()
nof_cÚæiùs
, ()
nof_Ë¬Ás
, 
·¿ms
);

819 
	gnof_cÚæiùs
 *= 1.5;

820 
	gnof_Ë¬Ás
 *= 1.1;

822 ià(()
	g¡©s
.
	gcÚæiùs
 >ð
effLim™
) {

823 
ÿnûlUÁž
(0);

824  
	g¡©us
 =ð
l_True
;

827 ià(
	gv”bos™y
 >= 1) {

828 
»pÜtf
("===========================================");

829 
»pÜtf
("===================================\n");

832 
ÿnûlUÁž
(0);

833  
	g¡©us
 =ð
l_True
;

836 
	gSÞv”
::
	$´štSts
()

838 
	`»pÜtf
("==============================[MINISAT]");

839 
	`»pÜtf
("===============================\n");

840 
	`»pÜtf
("| Conflicts | ORIGINAL | ");

841 
	`»pÜtf
("LEARNT | Progress |\n");

842 
	`»pÜtf
("| | Clauses Literals | Clauses ");

843 
	`»pÜtf
("Literals Lit/Cl | |\n");

844 
	`»pÜtf
("=======================================");

845 
	`»pÜtf
("===============================\n");

846 
	`»pÜtf
("| %9d | %7d %8d | %7d %8d %7.1f | %6.3f %% |\n",

847 ()
¡©s
.
cÚæiùs
, 
	`nCÏu£s
(), ()¡©s.
þau£s_l™”®s
,

848 
	`nL—ºts
(), ()
¡©s
.
Ë¬Ás_l™”®s
,

849 ()
¡©s
.
Ë¬Ás_l™”®s
/
	`nL—ºts
(), 
´og»ss_e¡im©e
*100);

850 
	`»pÜtf
("=======================================");

851 
	`»pÜtf
("===============================\n");

852 
	}
}

	@src/sat/Solver.h

20 #iâdeà
SÞv”_h


21 
	#SÞv”_h


	)

23 
	~"SÞv”Ty³s.h
"

24 
	~"V¬Ord”.h
"

25 
	~"Proof.h
"

28 
	#»pÜtf
(
fÜm©
, 
¬gs
...èÐ
	`´štf
(fÜm© , ##‡rgs), 
	`fæush
(
¡dout
è)

	)

35 
	sSÞv”Sts
 {

36 
št64
 
	m¡¬ts
, 
	mdecisiÚs
, 
	m´Ýag©iÚs
, 
	mcÚæiùs
;

37 
št64
 
	mþau£s_l™”®s
, 
	mË¬Ás_l™”®s
, 
	mmax_l™”®s
, 
	mtÙ_l™”®s
;

38 
SÞv”Sts
(è: 
¡¬ts
(0), 
decisiÚs
(0), 
´Ýag©iÚs
(0), 
cÚæiùs
(0)

39 , 
þau£s_l™”®s
(0), 
Ë¬Ás_l™”®s
(0), 
max_l™”®s
(0), 
tÙ_l™”®s
(0) { }

43 
	sS—rchP¬ams
 {

44 
	mv¬_deÿy
, 
	mþau£_deÿy
, 
	m¿ndom_v¬_äeq
;

45 
S—rchP¬ams
(
v
 = 1, 
c
 = 1, 
r
 = 0è: 
v¬_deÿy
(v), 
þau£_deÿy
(c), 
¿ndom_v¬_äeq
(r) { }

49 þas 
	cSÞv”
 {

50 
	m´Ùeùed
:

53 
boÞ
 
ok
;

54 
	mvec
<
	mCÏu£
*> 
	mþau£s
;

55 
	mvec
<
	mCÏu£
*> 
	mË¬Ás
;

56 
	mvec
<
	mCÏu£Id
> 
	mun™_id
;

57 
	mþa_šc
;

58 
	mþa_deÿy
;

60 
	mvec
<> 
	maùiv™y
;

61 
	mv¬_šc
;

62 
	mv¬_deÿy
;

63 
V¬Ord”
 
	mÜd”
;

65 
	mvec
<vec<
	mCÏu£
*> > 
	mw©ches
;

66 
	mvec
<> 
	massigns
;

67 
	mvec
<
	mL™
> 
	mŒaž
;

68 
	mvec
<> 
	mŒaž_lim
;

69 
	mvec
<
	mCÏu£
*> 
	m»asÚ
;

70 
	mvec
<> 
	mËv–
;

71 
	mvec
<> 
	mŒaž_pos
;

72 
	mroÙ_Ëv–
;

73 
	mqh—d
;

74 
	msimpDB_assigns
;

75 
št64
 
	msimpDB_´Ýs
;

79 
	mvec
<> 
	mª®yze_£’
;

80 
	mvec
<
	mL™
> 
	mª®yze_¡ack
;

81 
	mvec
<
	mL™
> 
	mª®yze_toþ—r
;

82 
CÏu£
* 
	m´Ýag©e_tmpbš
;

83 
CÏu£
* 
	mª®yze_tmpbš
;

84 
	mvec
<
	mL™
> 
	maddUn™_tmp
;

85 
	mvec
<
	mL™
> 
	maddBš¬y_tmp
;

86 
	mvec
<
	mL™
> 
	maddT”Çry_tmp
;

90 
boÞ
 
assume
 (
L™
 
p
);

91 
ÿnûlUÁž
 (
Ëv–
);

92 
»cÜd
 (cÚ¡ 
vec
<
L™
>& 
þau£
);

94 
ª®yze
 (
CÏu£
* 
cÚæ
, 
vec
<
L™
>& 
out_Ë¬Á
, & 
out_bŽev–
);

95 
boÞ
 
ª®yze_»movabË
(
L™
 
p
, 
ušt
 
mš_Ëv–
);

96 
ª®yzeFš®
 (
CÏu£
* 
cÚæ
, 
boÞ
 
sk_fœ¡
 = 
çl£
);

97 
boÞ
 
’queue
 (
L™
 
çù
, 
CÏu£
* 
äom
 = 
NULL
);

98 
CÏu£
* 
´Ýag©e
 ();

99 
»duûDB
 ();

100 
L™
 
pickB¿nchL™
 (cÚ¡ 
S—rchP¬ams
& 
·¿ms
);

101 
lboÞ
 
£¬ch
 (
nof_cÚæiùs
, 
nof_Ë¬Ás
, cÚ¡ 
S—rchP¬ams
& 
·¿ms
);

102 
´og»ssE¡im©e
 ();

106 
	$v¬BumpAùiv™y
(
L™
 
p
) {

107 ià(
v¬_deÿy
 < 0) ;

108 iàÐ(
aùiv™y
[
	`v¬
(
p
)] +ð
v¬_šc
è> 1e100 ) 
	`v¬ResÿËAùiv™y
();

109 
Üd”
.
	`upd©e
(
	`v¬
(
p
)); }

110 
	$v¬DeÿyAùiv™y
 (è{ ià(
v¬_deÿy
 >ð0è
v¬_šc
 *ðv¬_deÿy; 
	}
}

111 
v¬ResÿËAùiv™y
();

112 
	$þaDeÿyAùiv™y
 (è{ 
þa_šc
 *ð
þa_deÿy
; 
	}
}

113 
þaResÿËAùiv™y
();

117 
ÃwCÏu£
(cÚ¡ 
vec
<
L™
>& 
ps
, 
boÞ
 
Ë¬Á
 = 
çl£
, 
CÏu£Id
 
id
 = 
CÏu£Id_NULL
, boÞ 
A
 = 
Œue
);

118 
	$þaBumpAùiv™y
 (
CÏu£
* 
c
è{ iàÐ(c->
	`aùiv™y
(è+ð
þa_šc
è> 1e20 ) 
	`þaResÿËAùiv™y
(); 
	}
}

119 
»move
 (
CÏu£
* 
c
, 
boÞ
 
ju¡_d—Îoc
 = 
çl£
);

120 
boÞ
 
	$locked
 (cÚ¡ 
CÏu£
* 
c
ècÚ¡ {  
»asÚ
[
	`v¬
((*c)[0])] =ðc; 
	}
}

121 
boÞ
 
	$sim¶ify
 (
CÏu£
* 
c
) const;

123 
	$decisiÚLev–
(ècÚ¡ {  
Œaž_lim
.
	`size
(); 
	}
}

125 
	gpublic
:

126 
	$SÞv”
(è: 
	`ok
 (
Œue
)

127 , 
	`þa_šc
 (1)

128 , 
	`þa_deÿy
 (1)

129 , 
	`v¬_šc
 (1)

130 , 
	`v¬_deÿy
 (1)

131 , 
	`Üd”
 (
assigns
, 
aùiv™y
)

132 , 
	`qh—d
 (0)

133 , 
	`simpDB_assigns
 (0)

134 , 
	`simpDB_´Ýs
 (0)

135 , 
	`deçuÉ_·¿ms
 (
	`S—rchP¬ams
(0.95, 0.999, 0.02))

136 , 
	`ex³nsive_ccmš
 (2)

137 , 
	`´oof
 (
NULL
)

138 , 
	`v”bos™y
 (0)

139 , 
	`´og»ss_e¡im©e
(0)

140 , 
	$cÚæiù_id
 (
CÏu£Id_NULL
)

142 
vec
<
L™
> 
	`dummy
(2,
l™_Undef
);

143 
´Ýag©e_tmpbš
 = 
	`CÏu£_Ãw
(
çl£
, 
dummy
);

144 
ª®yze_tmpbš
 = 
	`CÏu£_Ãw
(
çl£
, 
dummy
);

145 
addUn™_tmp
 .
	`growTo
(1);

146 
addBš¬y_tmp
 .
	`growTo
(2);

147 
addT”Çry_tmp
.
	`growTo
(3);

148 
	}
}

150 ~
	$SÞv”
() {

151 
i
 = 0; i < 
Ë¬Ás
.
	`size
(); i++è
	`»move
Ö—ºts[i], 
Œue
);

152 
i
 = 0; i < 
þau£s
.
	`size
(); i++èià(þau£s[i] !ð
NULL
è
	`»move
(þau£s[i], 
Œue
);

153 
	`»move
(
´Ýag©e_tmpbš
, 
Œue
);

154 
	`»move
(
ª®yze_tmpbš
, 
Œue
);

155 
	}
}

159 
lboÞ
 
	$v®ue
(
V¬
 
x
ècÚ¡ {  
	`toLboÞ
(
assigns
[x]); 
	}
}

160 
lboÞ
 
	$v®ue
(
L™
 
p
ècÚ¡ {  
	`sign
Õè? ~
	`toLboÞ
(
assigns
[
	`v¬
Õ)]è:oLboÞ×ssigns[v¬Õ)]); 
	}
}

161 
lboÞ
 
	$mod–V®ue
(
V¬
 
x
ècÚ¡ {  
mod–
[x]; 
	}
}

164 
	$nAssigns
(è{  
Œaž
.
	`size
(); 
	}
}

165 
	$nCÏu£s
(è{  
þau£s
.
	`size
(); 
	}
}

166 
	$nL—ºts
(è{  
Ë¬Ás
.
	`size
(); 
	}
}

170 
SÞv”Sts
 
	g¡©s
;

174 
S—rchP¬ams
 
	gdeçuÉ_·¿ms
;

175 
	gex³nsive_ccmš
;

176 
Proof
* 
	g´oof
;

177 
	gv”bos™y
;

181 
V¬
 
ÃwV¬
 ();

182 
	$nV¬s
 (è{  
assigns
.
	`size
(); 
	}
}

183 
	$addUn™
 (
L™
 
p
è{ 
addUn™_tmp
 [0] =…; 
	`addCÏu£
×ddUn™_tmp); 
	}
}

184 
	$addBš¬y
 (
L™
 
p
, L™ 
q
è{ 
addBš¬y_tmp
 [0] =…;‡ddBš¬y_tm°[1] = q; 
	`addCÏu£
×ddBš¬y_tmp); 
	}
}

185 
	$addT”Çry
(
L™
 
p
, L™ 
q
, L™ 
r
è{ 
addT”Çry_tmp
[0] =…;‡ddT”Çry_tmp[1] = q;‡ddT”Çry_tmp[2] =„; 
	`addCÏu£
×ddT”Çry_tmp); 
	}
}

186 
addCÏu£
 (cÚ¡ 
vec
<
L™
>& 
ps
 , 
boÞ
 
A
 = 
Œue
è{ 
ÃwCÏu£
Õ , 
çl£
 , 
CÏu£Id_NULL
 , A); }

191 
boÞ
 
	$okay
(è{  
ok
; 
	}
}

192 
sim¶ifyDB
();

193 
boÞ
 
sÞve
(cÚ¡ 
vec
<
L™
>& 
assumps
);

194 
boÞ
 
	$sÞve
(è{ 
vec
<
L™
> 
tmp
;  
	`sÞve
Ñmp); 
	}
}

196 
	g´og»ss_e¡im©e
;

197 
	gvec
<
	glboÞ
> 
	gmod–
;

198 
	gvec
<
	gL™
> 
	gcÚæiù
;

199 
CÏu£Id
 
	gcÚæiù_id
;

203 
´štSts
();

211 
	#L_LIT
 "%s%d"

	)

212 
	#L_l™
(
p
è
	`sign
Õ)?"-":"", 
	`v¬
Õ)+1

	)

215 
šlše
 
	$check
(
boÞ
 
ex´
è{ 
	`as£¹
Óx´); 
	}
}

	@src/sat/SolverTypes.h

21 #iâdeà
SÞv”Ty³s_h


22 
	#SÞv”Ty³s_h


	)

24 #iâdeà
Glob®_h


25 
	~"Glob®.h
"

36 
	tV¬
;

37 
	#v¬_Undef
 (-1)

	)

40 þas 
	cL™
 {

41 
	mx
;

42 
	mpublic
:

43 
	$L™
(è: 
	$x
(2*
v¬_Undef
) {}

44 
ex¶ic™
 
	$L™
(
V¬
 
v¬
, 
boÞ
 
sgn
 = 
çl£
è: 
	`x
((v¬+v¬è+ ()sgnè{
	}
}

45 
ä›nd
 
L™
 
Ý”©Ü
 ~ (L™ 
p
);

47 
ä›nd
 
boÞ
 
sign
 (
L™
 
p
);

48 
ä›nd
 
v¬
 (
L™
 
p
);

49 
ä›nd
 
šdex
 (
L™
 
p
);

50 
ä›nd
 
L™
 
toL™
 (
i
);

51 
ä›nd
 
L™
 
unsign
(L™ 
p
);

52 
ä›nd
 
L™
 
id
 (L™ 
p
, 
boÞ
 
sgn
);

54 
ä›nd
 
boÞ
 
	gÝ”©Ü
 =ð(
L™
 
p
, L™ 
	gq
);

55 
ä›nd
 
boÞ
 
	gÝ”©Ü
 < (
L™
 
	gp
, L™ 
	gq
);

57 
ušt
 
	$hash
(ècÚ¡ {  (
ušt
)
x
; 
	}
}

59 
šlše
 
L™
 
	gÝ”©Ü
 ~ (L™ 
	gp
è{ L™ 
	gq
; q.
	gx
 = 
p
.
x
 ^ 1;  q; }

60 
šlše
 
boÞ
 
	$sign
 (
L™
 
p
è{ ….
x
 & 1; 
	}
}

61 
šlše
 
	$v¬
 (
L™
 
p
è{ ….
x
 >> 1; 
	}
}

62 
šlše
 
	$šdex
 (
L™
 
p
è{ ….
x
; 
	}
}

63 
šlše
 
L™
 
	$toL™
 (
i
è{ 
L™
 
p
;….
x
 = i; …; 
	}
}

64 
šlše
 
L™
 
	$unsign
(
L™
 
p
è{ L™ 
q
; q.
x
 =….x & ~1;  q; 
	}
}

65 
šlše
 
L™
 
	$id
 (
L™
 
p
, 
boÞ
 
sgn
è{ L™ 
q
; q.
x
 =….x ^ ()sgn;  q; 
	}
}

66 
šlše
 
boÞ
 
	gÝ”©Ü
 =ð(
L™
 
p
, L™ 
	gq
è{  
šdex
Õè=ðšdex(
q
); }

67 
šlše
 
boÞ
 
	gÝ”©Ü
 < (
L™
 
	gp
, L™ 
	gq
è{  
šdex
(
p
è< index(
q
); }

69 cÚ¡ 
L™
 
l™_Undef
(
v¬_Undef
, 
çl£
);

70 cÚ¡ 
L™
 
l™_E¼Ü
(
v¬_Undef
, 
Œue
 );

72 
šlše
 
	$toDimacs
(
L™
 
p
è{  
	`sign
Õè? -
	`v¬
Õè- 1 : v¬Õè+ 1; 
	}
}

79 
	tCÏu£Id
;

80 cÚ¡ 
	gCÏu£Id_NULL
 = 
INT_MIN
;

84 þas 
	cCÏu£
 {

85 
ušt
 
	msize_Ë¬Á
;

86 
L™
 
	md©a
[1];

87 
	mpublic
:

89 
CÏu£
(
boÞ
 
Ë¬Á
, cÚ¡ 
vec
<
L™
>& 
ps
, 
CÏu£Id
 
id_
 = 
CÏu£Id_NULL
) {

90 
size_Ë¬Á
 = (
ps
.
size
(è<< 1è| ()
Ë¬Á
;

91 
	mi
 = 0; i < 
	mps
.
size
(); i++è
	md©a
[
i
] = 
ps
[i];

92 ià(
	mË¬Á
è
aùiv™y
() = 0;

93 ià(
	mid_
 !ð
CÏu£Id_NULL
è
id
(èð
id_
; }

96 
ä›nd
 
CÏu£
* 
CÏu£_Ãw
(
boÞ
, cÚ¡ 
vec
<
L™
>&, 
CÏu£Id
);

98 
	$size
 (ècÚ¡ {  
size_Ë¬Á
 >> 1; 
	}
}

99 
boÞ
 
	$Ë¬Á
 (ècÚ¡ {  
size_Ë¬Á
 & 1; 
	}
}

100 
L™
 
	gÝ”©Ü
 [] (
	gi
ècÚ¡ {  
	gd©a
[
i
]; }

101 
	gL™
& 
	gÝ”©Ü
 [] (
	gi
è{  
	gd©a
[
i
]; }

102 & 
	$aùiv™y
 () const {

103 *
p
 = 
cÚ¡_ÿ¡
<
L™
*>(&
d©a
[
	`size
()]);  *((*)p);

104 
	}
}

105 
	gCÏu£Id
& 
	$id
 (ècÚ¡ {  *((
CÏu£Id
*)&
d©a
[
	`size
(è+ ()
	`Ë¬Á
()]); 
	}
}

108 
šlše
 
CÏu£
* 
CÏu£_Ãw
(
boÞ
 
Ë¬Á
, cÚ¡ 
vec
<
L™
>& 
ps
, 
CÏu£Id
 
id
 = 
CÏu£Id_NULL
) {

109 
as£¹
((
L™
è=ð(
ušt
));

110 
as£¹
((è=ð(
ušt
));

111 
as£¹
((
CÏu£Id
è=ð(
ušt
));

112 * 
	gmem
 = 
xm®loc
<>((
CÏu£
è+ (
ušt
)*(
ps
.
size
(è+ ()
Ë¬Á
 + ()(
id
 !ð
CÏu£Id_NULL
)));

113  
Ãw
 (
mem
è
CÏu£
(
Ë¬Á
, 
ps
, 
id
); }

121 þas 
	cGCÏu£
 {

122 * 
	md©a
;

123 
	$GCÏu£
(* 
d
è: 
	$d©a
(
d
) {}

124 
public
:

125 
ä›nd
 
GCÏu£
 
	`GCÏu£_Ãw
(
L™
 
p
);

126 
ä›nd
 
GCÏu£
 
	`GCÏu£_Ãw
(
CÏu£
* 
c
);

128 
boÞ
 
	$isL™
 (ècÚ¡ {  ((
uš
)
d©a
 & 1è=ð1; 
	}
}

129 
L™
 
	$l™
 (ècÚ¡ {  
	`toL™
(((
š
)
d©a
è>> 1); 
	}
}

130 
CÏu£
* 
	$þau£
 (ècÚ¡ {  (
CÏu£
*)
d©a
; 
	}
}

131 
boÞ
 
	gÝ”©Ü
 =ð(
GCÏu£
 
c
ècÚ¡ {  
d©a
 == c.data; }

132 
boÞ
 
	gÝ”©Ü
 !ð(
GCÏu£
 
c
ècÚ¡ {  
d©a
 != c.data; }

134 
šlše
 
GCÏu£
 
	$GCÏu£_Ãw
(
L™
 
p
è{  
	`GCÏu£
((*)(((
š
)
	`šdex
Õè<< 1è+ 1)); 
	}
}

135 
šlše
 
GCÏu£
 
	$GCÏu£_Ãw
(
CÏu£
* 
c
è{ 
	`as£¹
(((
uš
)ø& 1è=ð0);  
	`GCÏu£
((*)c); 
	}
}

137 
	#GCÏu£_NULL
 
	`GCÏu£_Ãw
((
CÏu£
*)
NULL
)

	)

	@src/sat/Sort.h

20 #iâdeà
SÜt_h


21 
	#SÜt_h


	)

27 
	g‹m¶©e
<
þass
 
	gT
>

28 
	sLessThª_deçuÉ
 {

29 
boÞ
 
Ý”©Ü
 (è(
T
 
	mx
, T 
	my
) {  x < y; }

36 
	g‹m¶©e
 <
þass
 
	gT
, cÏs 
	gLessThª
>

37 
	$£ËùiÚSÜt
(
T
* 
¬¿y
, 
size
, 
LessThª
 
É
)

39 
i
, 
j
, 
be¡_i
;

40 
T
 
tmp
;

42 
i
 = 0; i < 
size
-1; i++){

43 
be¡_i
 = 
i
;

44 
j
 = 
i
+1; j < 
size
; j++){

45 ià(
	`É
(
¬¿y
[
j
],‡¼ay[
be¡_i
]))

46 
be¡_i
 = 
j
;

48 
tmp
 = 
¬¿y
[
i
];‡¼ay[i] =‡¼ay[
be¡_i
];‡rray[best_i] =mp;

50 
	}
}

51 
	g‹m¶©e
 <
þass
 
	gT
> 
šlše
 
	$£ËùiÚSÜt
(
T
* 
¬¿y
, 
size
) {

52 
	`£ËùiÚSÜt
(
¬¿y
, 
size
, 
LessThª_deçuÉ
<
T
>()); 
	}
}

55 
	g‹m¶©e
 <
þass
 
	gT
, cÏs 
	gLessThª
>

56 
	$sÜt
(
T
* 
¬¿y
, 
size
, 
LessThª
 
É
, & 
£ed
)

58 ià(
size
 <= 15)

59 
	`£ËùiÚSÜt
(
¬¿y
, 
size
, 
É
);

62 
T
 
pivÙ
 = 
¬¿y
[
	`œªd
(
£ed
, 
size
)];

63 
T
 
tmp
;

64 
i
 = -1;

65 
j
 = 
size
;

68 dØ
i
++; 
	`É
(
¬¿y
[i], 
pivÙ
));

69 dØ
j
--; 
	`É
(
pivÙ
, 
¬¿y
[j]));

71 ià(
i
 >ð
j
) ;

73 
tmp
 = 
¬¿y
[
i
];‡¼ay[i] =‡¼ay[
j
];‡rray[j] =mp;

76 
	`sÜt
(
¬¿y
 , 
i
 , 
É
, 
£ed
);

77 
	`sÜt
(&
¬¿y
[
i
], 
size
-i, 
É
, 
£ed
);

79 
	}
}

80 
	g‹m¶©e
 <
þass
 
	gT
, cÏs 
	gLessThª
> 
	$sÜt
(
T
* 
¬¿y
, 
size
, 
LessThª
 
É
) {

81 
£ed
 = 91648253; 
	`sÜt
(
¬¿y
, 
size
, 
É
, s“d); 
	}
}

82 
	g‹m¶©e
 <
þass
 
	gT
> 
šlše
 
	$sÜt
(
T
* 
¬¿y
, 
size
) {

83 
	`sÜt
(
¬¿y
, 
size
, 
LessThª_deçuÉ
<
T
>()); 
	}
}

86 
	g‹m¶©e
 <
þass
 
	gT
, cÏs 
	gLessThª
>

87 
	$sÜtUnique
(
T
* 
¬¿y
, & 
size
, 
LessThª
 
É
)

89 
i
, 
j
;

90 
T
 
Ï¡
;

92 ià(
size
 == 0) ;

94 
	`sÜt
(
¬¿y
, 
size
, 
É
);

96 
i
 = 1;

97 
Ï¡
 = 
¬¿y
[0];

98 
j
 = 1; j < 
size
; j++){

99 ià(
	`É
(
Ï¡
, 
¬¿y
[
j
])){

100 
Ï¡
 = 
¬¿y
[
i
] =‡¼ay[
j
];

101 
i
++; }

104 
size
 = 
i
;

105 
	}
}

106 
	g‹m¶©e
 <
þass
 
	gT
> 
šlše
 
	$sÜtUnique
(
T
* 
¬¿y
, & 
size
) {

107 
	`sÜtUnique
(
¬¿y
, 
size
, 
LessThª_deçuÉ
<
T
>()); 
	}
}

114 
	g‹m¶©e
 <
þass
 
	gT
, cÏs 
	gLessThª
> 
sÜt
(
vec
<
T
>& 
v
, 
LessThª
 
É
) {

115 
sÜt
((
T
*)
v
, v.
size
(), 
É
); }

116 
	g‹m¶©e
 <
þass
 
	gT
> 
sÜt
(
vec
<
T
>& 
v
) {

117 
sÜt
(
v
, 
LessThª_deçuÉ
<
T
>()); }

120 
	g‹m¶©e
 <
þass
 
	gT
, cÏs 
	gLessThª
> 
sÜtUnique
(
vec
<
T
>& 
v
, 
LessThª
 
É
) {

121 
	gsize
 = 
v
.
size
();

122 
T
* 
	gd©a
 = 
v
.
»Ëa£
();

123 
sÜtUnique
(
d©a
, 
size
, 
É
);

124 
	gv
.~
	gvec
<
	gT
>();

125 
Ãw
 (&
v
è
	gvec
<
	gT
>(
	gd©a
, 
	gsize
); }

126 
	g‹m¶©e
 <
þass
 
	gT
> 
sÜtUnique
(
vec
<
T
>& 
v
) {

127 
sÜtUnique
(
v
, 
LessThª_deçuÉ
<
T
>()); }

	@src/sat/VarOrder.h

20 #iâdeà
V¬Ord”_h


21 
	#V¬Ord”_h


	)

23 
	~"SÞv”Ty³s.h
"

24 
	~"H—p.h
"

30 
	sV¬Ord”_É
 {

31 cÚ¡ 
	mvec
<>& 
	maùiv™y
;

32 
boÞ
 
Ý”©Ü
 (è(
V¬
 
	mx
, V¬ 
	my
è{  
	maùiv™y
[
x
] >‡ùiv™y[
y
]; }

33 
V¬Ord”_É
(cÚ¡ 
vec
<>& 
aù
è: 
aùiv™y
(act) { }

36 þas 
	cV¬Ord”
 {

37 cÚ¡ 
	mvec
<>& 
	massigns
;

39 
	mH—p
<
	mV¬Ord”_É
> 
	mh—p
;

40 
	m¿ndom_£ed
;

42 
	mpublic
:

43 
V¬Ord”
(cÚ¡ 
vec
<>& 
ass
, cÚ¡ vec<>& 
aù
) :

45 
assigns
(
ass
), 
h—p
(
V¬Ord”_É
(
aù
)), 
	$¿ndom_£ed
(91648253)

48 
šlše
 
	`ÃwV¬
();

49 
šlše
 
	`upd©e
(
V¬
 
x
);

50 
šlše
 
	`undo
(
V¬
 
x
);

51 
šlše
 
V¬
 
	`£Ëù
(
¿ndom_äeq
 =.0);

52 
	}
};

55 
	gV¬Ord”
::
	$ÃwV¬
()

57 
h—p
.
	`£tBounds
(
assigns
.
	`size
());

58 
h—p
.
	`š£¹
(
assigns
.
	`size
()-1);

59 
	}
}

62 
	gV¬Ord”
::
	$upd©e
(
V¬
 
x
)

64 ià(
h—p
.
	`šH—p
(
x
))

65 
h—p
.
	`šü—£
(
x
);

66 
	}
}

69 
	gV¬Ord”
::
	$undo
(
V¬
 
x
)

71 ià(!
h—p
.
	`šH—p
(
x
))

72 
h—p
.
	`š£¹
(
x
);

73 
	}
}

76 
V¬
 
	gV¬Ord”
::
	$£Ëù
(
¿ndom_v¬_äeq
)

79 ià(
	`d¿nd
(
¿ndom_£ed
è< 
¿ndom_v¬_äeq
 && !
h—p
.
	`em±y
()){

80 
V¬
 
Ãxt
 = 
	`œªd
(
¿ndom_£ed
,
assigns
.
	`size
());

81 ià(
	`toLboÞ
(
assigns
[
Ãxt
]è=ð
l_Undef
)

82  
Ãxt
;

86 !
h—p
.
	`em±y
()){

87 
V¬
 
Ãxt
 = 
h—p
.
	`g‘mš
();

88 ià(
	`toLboÞ
(
assigns
[
Ãxt
]è=ð
l_Undef
)

89  
Ãxt
;

92  
v¬_Undef
;

93 
	}
}

	@src/sat/sat.h

9 #iâdeà
SAT_H


10 
	#SAT_H


	)

12 
	~<ÿs£¹
>

13 
	~<io¡»am
>

14 
	~"SÞv”.h
"

16 
usšg
 
Çme¥aû
 
	g¡d
;

19 þas 
	cS©SÞv”


21 
	mpublic
 :

22 
	$S©SÞv”
():
	$_sÞv”
(0) { }

23 ~
	$S©SÞv”
(è{ ià(
_sÞv”
è
d–‘e
 _sÞv”; 
	}
}

26 
	$š™Ÿlize
() {

27 
	`»£t
();

28 ià(
_curV¬
 =ð0è{ 
_sÞv”
->
	`ÃwV¬
(); ++_curVar; }

29 
	}
}

30 
	$»£t
() {

31 ià(
_sÞv”
è
d–‘e
 _solver;

32 
_sÞv”
 = 
Ãw
 
	`SÞv”
();

33 
_assump
.
	`þ—r
(); 
_curV¬
 = 0;

34 
	}
}

38 
šlše
 
V¬
 
	$ÃwV¬
(è{ 
_sÞv”
->
	`ÃwV¬
();  
_curV¬
++; 
	}
}

40 
	$addAigCNF
(
V¬
 
vf
, V¬ 
va
, 
boÞ
 
ç
, V¬ 
vb
, boÞ 
fb
) {

41 
vec
<
L™
> 
l™s
;

42 
L™
 
lf
 = 
	`L™
(
vf
);

43 
L™
 
Ï
 = 
ç
? ~
	`L™
(
va
): Lit(va);

44 
L™
 
lb
 = 
fb
? ~
	`L™
(
vb
): Lit(vb);

45 
l™s
.
	`push
(
Ï
);†™s.push(~
lf
);

46 
_sÞv”
->
	`addCÏu£
(
l™s
);†™s.
	`þ—r
();

47 
l™s
.
	`push
(
lb
);†™s.push(~
lf
);

48 
_sÞv”
->
	`addCÏu£
(
l™s
);†™s.
	`þ—r
();

49 
l™s
.
	`push
(~
Ï
);†™s.push(~
lb
);†™s.push(
lf
);

50 
_sÞv”
->
	`addCÏu£
(
l™s
);†™s.
	`þ—r
();

51 
	}
}

53 
	$addXÜCNF
(
V¬
 
vf
, V¬ 
va
, 
boÞ
 
ç
, V¬ 
vb
, boÞ 
fb
) {

54 
vec
<
L™
> 
l™s
;

55 
L™
 
lf
 = 
	`L™
(
vf
);

56 
L™
 
Ï
 = 
ç
? ~
	`L™
(
va
): Lit(va);

57 
L™
 
lb
 = 
fb
? ~
	`L™
(
vb
): Lit(vb);

58 
l™s
.
	`push
(~
Ï
);†™s.pushÐ
lb
);†™s.pushÐ
lf
);

59 
_sÞv”
->
	`addCÏu£
(
l™s
);†™s.
	`þ—r
();

60 
l™s
.
	`push
Ð
Ï
);†™s.push(~
lb
);†™s.pushÐ
lf
);

61 
_sÞv”
->
	`addCÏu£
(
l™s
);†™s.
	`þ—r
();

62 
l™s
.
	`push
Ð
Ï
);†™s.pushÐ
lb
);†™s.push(~
lf
);

63 
_sÞv”
->
	`addCÏu£
(
l™s
);†™s.
	`þ—r
();

64 
l™s
.
	`push
(~
Ï
);†™s.push(~
lb
);†™s.push(~
lf
);

65 
_sÞv”
->
	`addCÏu£
(
l™s
);†™s.
	`þ—r
();

66 
	}
}

69 
	$assumeR–—£
(è{ 
_assump
.
	`þ—r
(); 
	}
}

70 
	$assumePrÝ”ty
(
V¬
 
´Ý
, 
boÞ
 
v®
) {

71 
_assump
.
	`push
(
v®
? 
	`L™
(
´Ý
): ~Lit(prop));

72 
	}
}

73 
boÞ
 
	$assumpSÞve
(è{  
_sÞv”
->
	`sÞve
(
_assump
); 
	}
}

76 
	$as£¹PrÝ”ty
(
V¬
 
´Ý
, 
boÞ
 
v®
) {

77 
_sÞv”
->
	`addUn™
(
v®
? 
	`L™
(
´Ý
): ~Lit(prop));

78 
	}
}

79 
boÞ
 
	$sÞve
(è{ 
_sÞv”
->
	`sÞve
();  _sÞv”->
	`okay
(); 
	}
}

83 
	$g‘V®ue
(
V¬
 
v
) const {

84  (
_sÞv”
->
	`mod–V®ue
(
v
)==
l_True
?1:

85 (
_sÞv”
->
	`mod–V®ue
(
v
)==
l_F®£
?0:-1)); 
	}
}

86 
	$´štSts
(ècÚ¡ { 
cÚ¡_ÿ¡
<
SÞv”
*>(
_sÞv”
)->
	`´štSts
(); 
	}
}

88 
	g´iv©e
 :

89 
SÞv”
 *
_sÞv”
;

90 
V¬
 
	g_curV¬
;

91 
	gvec
<
	gL™
> 
	g_assump
;

	@src/sat/test/satTest.cpp

1 
	~<io¡»am
>

2 
	~<veùÜ
>

3 
	~"§t.h
"

5 
usšg
 
Çme¥aû
 
	g¡d
;

7 þas 
	cG©e


9 
	mpublic
:

10 
	$G©e
(
i
 = 0): 
	$_gid
(
i
) {}

11 ~
	$G©e
(è{
	}
}

13 
V¬
 
	$g‘V¬
(ècÚ¡ {  
_v¬
; 
	}
}

14 
	$£tV¬
(cÚ¡ 
V¬
& 
v
è{ 
_v¬
 = v; 
	}
}

16 
	g´iv©e
:

17 
_gid
;

18 
V¬
 
	g_v¬
;

33 
	gveùÜ
<
	gG©e
 *> 
	gg©es
;

36 
	$š™Cœcu™
()

39 
g©es
.
	`push_back
(
Ãw
 
	`G©e
(1));

40 
g©es
.
	`push_back
(
Ãw
 
	`G©e
(2));

41 
g©es
.
	`push_back
(
Ãw
 
	`G©e
(4));

42 
g©es
.
	`push_back
(
Ãw
 
	`G©e
(3));

43 
g©es
.
	`push_back
(
Ãw
 
	`G©e
(5));

44 
g©es
.
	`push_back
(
Ãw
 
	`G©e
(6));

45 
g©es
.
	`push_back
(
Ãw
 
	`G©e
(9));

46 
g©es
.
	`push_back
(
Ãw
 
	`G©e
(7));

47 
g©es
.
	`push_back
(
Ãw
 
	`G©e
(8));

48 
g©es
.
	`push_back
(
Ãw
 
	`G©e
(10));

51 
	}
}

54 
	$g’ProofMod–
(
S©SÞv”
& 
s
)

57 
size_t
 
i
 = 0, 
n
 = 
g©es
.
	`size
(); i <‚; ++i) {

58 
V¬
 
v
 = 
s
.
	`ÃwV¬
();

59 
g©es
[
i
]->
	`£tV¬
(
v
);

64 
s
.
	`addAigCNF
(
g©es
[2]->
	`g‘V¬
(), g©es[0]->g‘V¬(), 
çl£
,

65 
g©es
[1]->
	`g‘V¬
(), 
çl£
);

67 
s
.
	`addAigCNF
(
g©es
[4]->
	`g‘V¬
(), g©es[0]->g‘V¬(), 
çl£
,

68 
g©es
[3]->
	`g‘V¬
(), 
çl£
);

70 
s
.
	`addAigCNF
(
g©es
[5]->
	`g‘V¬
(), g©es[2]->g‘V¬(), 
Œue
,

71 
g©es
[4]->
	`g‘V¬
(), 
Œue
);

73 
s
.
	`addAigCNF
(
g©es
[7]->
	`g‘V¬
(), g©es[1]->g‘V¬(), 
Œue
,

74 
g©es
[3]->
	`g‘V¬
(), 
Œue
);

76 
s
.
	`addAigCNF
(
g©es
[8]->
	`g‘V¬
(), g©es[7]->g‘V¬(), 
Œue
,

77 
g©es
[0]->
	`g‘V¬
(), 
çl£
);

78 
	}
}

80 
	$»pÜtResuÉ
(cÚ¡ 
S©SÞv”
& 
sÞv”
, 
boÞ
 
»suÉ
)

82 
sÞv”
.
	`´štSts
();

83 
cout
 << (
»suÉ
? "SAT" : "UNSAT"è<< 
’dl
;

84 ià(
»suÉ
) {

85 
size_t
 
i
 = 0, 
n
 = 
g©es
.
	`size
(); i <‚; ++i)

86 
cout
 << 
sÞv”
.
	`g‘V®ue
(
g©es
[
i
]->
	`g‘V¬
()è<< 
’dl
;

88 
	}
}

90 
	$maš
()

92 
	`š™Cœcu™
();

94 
S©SÞv”
 
sÞv”
;

95 
sÞv”
.
	`š™Ÿlize
();

98 
	`g’ProofMod–
(
sÞv”
);

100 
boÞ
 
»suÉ
;

102 
V¬
 
ÃwV
 = 
sÞv”
.
	`ÃwV¬
();

103 
sÞv”
.
	`addXÜCNF
(
ÃwV
, 
g©es
[5]->
	`g‘V¬
(), 
çl£
, g©es[8]->g‘V¬(), 
Œue
);

104 
sÞv”
.
	`assumeR–—£
();

105 
sÞv”
.
	`assumePrÝ”ty
(
ÃwV
, 
Œue
);

106 
»suÉ
 = 
sÞv”
.
	`assumpSÞve
();

107 
	`»pÜtResuÉ
(
sÞv”
, 
»suÉ
);

109 
cout
 << 
’dl
 <<ƒndl << "======================" <<ƒndl;

112 
ÃwV
 = 
sÞv”
.
	`ÃwV¬
();

113 
sÞv”
.
	`addAigCNF
(
ÃwV
, 
g©es
[3]->
	`g‘V¬
(), 
çl£
, g©es[7]->g‘V¬(), 
Œue
);

114 
sÞv”
.
	`assumeR–—£
();

115 
sÞv”
.
	`assumePrÝ”ty
(
ÃwV
, 
Œue
);

116 
»suÉ
 = 
sÞv”
.
	`assumpSÞve
();

117 
	`»pÜtResuÉ
(
sÞv”
, 
»suÉ
);

118 
	}
}

	@src/util/myGetChar.cpp

8 
	~<io¡»am
>

9 
	~<‹rmios.h
>

10 
	~<¡dlib.h
>

11 
	~<ùy³.h
>

13 
usšg
 
Çme¥aû
 
	g¡d
;

18 
‹rmios
 
	g¡Üed_£‰šgs
;

20 
	$»£t_key´ess
()

22 
	`tc£‰r
(0,
TCSANOW
,&
¡Üed_£‰šgs
);

23 
	}
}

25 
	$£t_key´ess
()

27 
‹rmios
 
Ãw_£‰šgs
;

28 
	`tcg‘©Œ
(0,&
¡Üed_£‰šgs
);

29 
Ãw_£‰šgs
 = 
¡Üed_£‰šgs
;

30 
Ãw_£‰šgs
.
c_læag
 &ð(~
ICANON
);

31 
Ãw_£‰šgs
.
c_læag
 &ð(~
ECHO
);

32 
Ãw_£‰šgs
.
c_cc
[
VTIME
] = 0;

33 
	`tcg‘©Œ
(0,&
¡Üed_£‰šgs
);

34 
Ãw_£‰šgs
.
c_cc
[
VMIN
] = 1;

35 
	`tc£‰r
(0,
TCSANOW
,&
Ãw_£‰šgs
);

36 
	}
}

42 
	$myG‘Ch¬
(
i¡»am
& 
i¡r
)

44 
ch
;

45 
	`£t_key´ess
();

46 
i¡r
.
	`un£tf
(
ios_ba£
::
skws
);

47 
i¡r
 >> 
ch
;

48 
i¡r
.
	`£tf
(
ios_ba£
::
skws
);

49 
	`»£t_key´ess
();

50  
ch
;

51 
	}
}

53 
	$myG‘Ch¬
()

55  
	`myG‘Ch¬
(
cš
);

56 
	}
}

	@src/util/myHashMap.h

9 #iâdeà
MY_HASH_MAP_H


10 
	#MY_HASH_MAP_H


	)

12 
	~<veùÜ
>

14 
usšg
 
Çme¥aû
 
	g¡d
;

37 þas 
	cHashKey


39 
	mpublic
:

40 
	$HashKey
(
size_t
 
š0
 = 0, size_ˆ
š1
 = 0): 
	`_š0
(š0), 
	$_š1
(
š1
) {}

41 ~
	$HashKey
(è{
	}
}

43 
size_t
 
	$Ý”©Ü
 () () const {

44 
size_t
 
k
 = 0;

45 
size_t
 
n
 = (
_š0
 + 
_š1
) / 2;

46 
size_t
 
i
=0; i<
n
; ++i)

47 
k
 ^ð(
n
 << (
i
*6));

48  
k
;

49 
	}
}

50 
	gHashKey
& 
	gÝ”©Ü
 = (cÚ¡ 
HashKey
& 
k
è{ 
_š0
 = k._š0; 
	g_š1
 = k.
_š1
;  *
	gthis
; }

51 
boÞ
 
	gÝ”©Ü
 =ð(cÚ¡ 
HashKey
& 
k
) const {

52 if((
_š0
 =ð
k
._š0è&& (
_š1
 =ðk._š1)è 
Œue
;

53 if((
	g_š1
 =ð
k
.
_š0
è&& (_š0 =ðk.
_š1
)è 
Œue
;

54  
	gçl£
;

57 
	g´iv©e
:

58 
size_t
 
_š0
, 
	g_š1
;

62 
	g‹m¶©e
 <
þass
 
	gHashKey
, cÏs 
	gHashD©a
>

63 þas 
	cHashM­


65 
	m·œ
<
	tHashKey
, 
	tHashD©a
> 
	tHashNode
;

67 
	mpublic
:

68 
	$HashM­
(
size_t
 
b
=0è: 
	`_numBuck‘s
(0), 
	$_buck‘s
(0è{ ià(
b
 !ð0è
	`š™
(b); }

69 ~
	$HashM­
(è{ 
	`»£t
(); 
	}
}

80 þas 
	c™”©Ü


82 
ä›nd
 
þass
 
	gHashM­
<
	gHashKey
, 
	gHashD©a
>;

84 
	gpublic
:

85 
™”©Ü
(
HashM­
* 
h
, 
HashNode
* 
n
 = 0, 
size_t
 
i
 = 0, size_ˆ
j
 = 0)

86 : 
_hash
(
h
), 
_hashNode
(
n
), 
_i
(
i
), 
_j
(
j
) {}

87 ~
™”©Ü
() {}

89 cÚ¡ 
	gHashNode
& 
	gÝ”©Ü
 * (è{  *
	g_hashNode
; }

90 
	g™”©Ü
& 
	gÝ”©Ü
 = (cÚ¡ 
™”©Ü
& 
i
è{ 
_hashNode
 = i._hashNode;  *
	gthis
; }

91 
boÞ
 
	gÝ”©Ü
 =ð(cÚ¡ 
™”©Ü
& 
i
è{  
_hashNode
 == i._hashNode; }

92 
boÞ
 
	gÝ”©Ü
 !ð(cÚ¡ 
™”©Ü
& 
i
è{  
_hashNode
 != i._hashNode; }

94 
	g™”©Ü
& 
	gÝ”©Ü
 ++ () {

95 if(
	g_j
+1 < 
	g_hash
->
	g_buck‘s
[
_i
].
size
())

96 
	g_hashNode
 = &
_hash
->
_buck‘s
[
_i
][++
_j
];

98 if(
	g_i
+1 >ð
_hash
->
_numBuck‘s
è{ 
_hashNode
 = 0; _˜ð
_j
 = 0;  *
	gthis
; }

99 
	g_j
 = 0;

100 
	g_hash
->
	g_buck‘s
[++
_i
].
em±y
())

101 if(
	g_i
 >ð
_hash
->
_numBuck‘s
-1è{ 
_hashNode
 = 0; _˜ð0;  *
	gthis
; }

102 
	g_hashNode
 = &
_hash
->
_buck‘s
[
_i
][
_j
];

104  *
	gthis
;

107 
™”©Ü
 
	gÝ”©Ü
 ++ () {

108 
™”©Ü
 
tmp
(*
this
);

109 if(
	g_j
+1 < 
	g_hash
->
	g_buck‘s
[
_i
].
size
())

110 
	g_hashNode
 = &
_hash
->
_buck‘s
[
_i
][++
_j
];

112 if(
	g_i
+1 >ð
_hash
->
_numBuck‘s
è{ 
_hashNode
 = 0; _˜ð
_j
 = 0;  
	gtmp
; }

113 
	g_j
 = 0;

114 
	g_hash
->
	g_buck‘s
[++
_i
].
em±y
())

115 if(
	g_i
 >ð
_hash
->
_numBuck‘s
-1è{ 
_hashNode
 = 0; _˜ð0;  
	gtmp
; }

116 
	g_hashNode
 = &
_hash
->
_buck‘s
[
_i
][
_j
];

118  
	gtmp
;

121 
	g™”©Ü
& 
	gÝ”©Ü
 -- () {

122 if(
	g_j
 > 0)

123 
	g_hashNode
 = &
_hash
->
_buck‘s
[
_i
][--
_j
];

125 if(
	g_i
 =ð0è{ 
_hashNode
 = 0; _˜ð
_j
 = 0;  *
	gthis
; }

126 
	g_hash
->
	g_buck‘s
[--
_i
].
em±y
())

127 if(
	g_i
 =ð0è{ 
_hashNode
 = 0; _˜ð
_j
 = 0;  *
	gthis
; }

128 
	g_j
 = 
_buck‘s
[
_i
].
size
()-1;

129 
	g_hashNode
 = &
_hash
->
_buck‘s
[
_i
][
_j
];

131  *
	gthis
;

134 
™”©Ü
 
	gÝ”©Ü
 -- () {

135 
™”©Ü
 
tmp
(*
this
);

136 if(
	g_j
 > 0)

137 
	g_hashNode
 = &
_hash
->
_buck‘s
[
_i
][--
_j
];

139 if(
	g_i
 =ð0è{ 
_hashNode
 = 0; _˜ð
_j
 = 0;  
	gtmp
; }

140 
	g_hash
->
	g_buck‘s
[--
_i
].
em±y
())

141 if(
	g_i
 =ð0è{ 
_hashNode
 = 0; _˜ð
_j
 = 0;  
	gtmp
; }

142 
	g_j
 = 
_buck‘s
[
_i
].
size
()-1;

143 
	g_hashNode
 = &
_hash
->
_buck‘s
[
_i
][
_j
];

145  
	gtmp
;

148 
	g´iv©e
:

149 cÚ¡ 
HashM­
* 
_hash
;

150 
HashNode
* 
	g_hashNode
;

151 
size_t
 
	g_i
, 
	g_j
;

154 
	$š™
(
size_t
 
b
) {

155 
	`»£t
(); 
_numBuck‘s
 = 
b
; 
_buck‘s
 = 
Ãw
 
veùÜ
<
HashNode
>[b]; 
	}
}

156 
	$»£t
() {

157 
_numBuck‘s
 = 0;

158 ià(
_buck‘s
è{ 
d–‘e
 [] _buckets; _buckets = 0; }

159 
	}
}

160 
	$þ—r
() {

161 
size_t
 
i
 = 0; i < 
_numBuck‘s
; ++iè
_buck‘s
[i].
	`þ—r
();

162 
	}
}

163 
size_t
 
	$numBuck‘s
(ècÚ¡ {  
_numBuck‘s
; 
	}
}

165 
	gveùÜ
<
	gHashNode
>& 
	gÝ”©Ü
 [] (
size_t
 
	gi
è{  
	g_buck‘s
[
i
]; }

166 cÚ¡ 
	gveùÜ
<
	gHashNode
>& 
	gÝ”©Ü
 [](
size_t
 
	gi
ècÚ¡ {  
	g_buck‘s
[
i
]; }

171 
™”©Ü
 
	$begš
() const {

172 
™”©Ü
 
	`™
(
cÚ¡_ÿ¡
<
HashM­
<
HashKey
, 
HashD©a
>*>(
this
));

173 
size_t
 
i
=0; i<
_numBuck‘s
; ++i)

174 if(!
_buck‘s
[
i
].
	`em±y
())

175  
	`™”©Ü
(
cÚ¡_ÿ¡
<
HashM­
<
HashKey
, 
HashD©a
>*>(
this
), &
_buck‘s
[
i
][0], i, 0);

176  
™
;

177 
	}
}

179 
™”©Ü
 
	$’d
(ècÚ¡ {  
	`™”©Ü
(
cÚ¡_ÿ¡
<
HashM­
<
HashKey
, 
HashD©a
>*>(
this
)); 
	}
}

181 
boÞ
 
	$em±y
() const {

182 
size_t
 
i
=0; i<
_buck‘s
->
	`_size
(); ++i)

183 if(!
_buck‘s
[
i
].
	`em±y
()è 
çl£
;

184  
Œue
;

185 
	}
}

187 
size_t
 
	$size
() const {

188 
size_t
 
s
 = 0;

189 
size_t
 
i
=0; i<
_numBuck‘s
; ++i)

190 
s
 +ð
_buck‘s
[
i
].
	`size
();

191  
s
;

192 
	}
}

197 
boÞ
 
	$check
(cÚ¡ 
HashKey
& 
k
) const {

198 
size_t
 
num
 = 
	`buck‘Num
(
k
);

199 
size_t
 
i
=0; i<
_buck‘s
[
num
].
	`size
(); ++i)

200 if(
_buck‘s
[
num
][
i
].
fœ¡
 =ð
k
è 
Œue
;

201  
çl£
;

202 
	}
}

207 
boÞ
 
	$qu”y
(cÚ¡ 
HashKey
& 
k
, 
HashD©a
& 
d
) const {

208 
size_t
 
num
 = 
	`buck‘Num
(
k
);

209 
size_t
 
i
=0; i<
_buck‘s
[
num
].
	`size
(); ++i)

210 if(
_buck‘s
[
num
][
i
].
fœ¡
 =ð
k
){

211 
d
 = 
_buck‘s
[
num
][
i
].
£cÚd
;

212  
Œue
;

214  
çl£
;

215 
	}
}

220 
boÞ
 
	$upd©e
(cÚ¡ 
HashKey
& 
k
, 
HashD©a
& 
d
) {

221 
size_t
 
num
 = 
	`buck‘Num
(
k
);

222 
size_t
 
i
=0; i<
_buck‘s
[
num
].
	`size
(); ++i)

223 if(
_buck‘s
[
num
][
i
].
fœ¡
 =ð
k
){

224 if(
i
 =ð0è{ 
_buck‘s
[
num
][i].
£cÚd
 = 
d
;  
Œue
; }

225 
HashNode
 
tmp
 = 
_buck‘s
[
num
][0];

226 
_buck‘s
[
num
][0].
fœ¡
 = 
k
;

227 
_buck‘s
[
num
][0].
£cÚd
 = 
d
;

228 
_buck‘s
[
num
][
i
] = 
tmp
;

229  
Œue
;

232 
HashNode
 
tmp
 = 
_buck‘s
[
num
][0];

233 
_buck‘s
[
num
][0].
fœ¡
 = 
k
;

234 
_buck‘s
[
num
][0].
£cÚd
 = 
d
;

235 
_buck‘s
[
num
].
	`push_back
(
tmp
);

236  
çl£
;

237 
	}
}

241 
boÞ
 
	$š£¹
(cÚ¡ 
HashKey
& 
k
, cÚ¡ 
HashD©a
& 
d
) {

242 if(
	`check
(
k
)è 
çl£
;

243 
HashNode
 
ÃwNode
 = 
	`make_·œ
(
k
, 
d
);

244 
_buck‘s
[
	`buck‘Num
(
k
)].
	`push_back
(
ÃwNode
);

245  
Œue
;

246 
	}
}

250 
boÞ
 
	$»move
(cÚ¡ 
HashKey
& 
k
) {

251 
size_t
 
num
 = 
	`buck‘Num
(
k
);

252 
size_t
 
i
=0; i<
_buck‘s
[
num
].
	`size
(); ++i)

253 if(
_buck‘s
[
num
][
i
].
fœ¡
 =ð
k
){

254 
_buck‘s
[
num
].
	`”a£
(_buck‘s[num].
”a£
+
i
);

255  
Œue
;

257  
çl£
;

258 
	}
}

260 
	g´iv©e
:

262 
size_t
 
_numBuck‘s
;

263 
	gveùÜ
<
	gHashNode
>* 
	g_buck‘s
;

265 
size_t
 
	$buck‘Num
(cÚ¡ 
HashKey
& 
k
) const {

266  (
	`k
(è% 
_numBuck‘s
); 
	}
}

289 
	g‹m¶©e
 <
þass
 
	gCacheKey
, cÏs 
	gCacheD©a
>

290 þas 
	cCache


292 
	m·œ
<
	tCacheKey
, 
	tCacheD©a
> 
	tCacheNode
;

294 
	mpublic
:

295 
	$Cache
(è: 
	`_size
(0), 
	$_ÿche
(0) {}

296 
	$Cache
(
size_t
 
s
è: 
	`_size
(0), 
	$_ÿche
(0è{ 
	`š™
(
s
); 
	}
}

297 ~
	$Cache
(è{ 
	`»£t
(); 
	}
}

304 
	$š™
(
size_t
 
s
è{ 
	`»£t
(); 
_size
 = s; 
_ÿche
 = 
Ãw
 
CacheNode
[s]; 
	}
}

305 
	$»£t
(è{ 
_size
 = 0; ià(
_ÿche
è{ 
d–‘e
 [] _ÿche; _ÿchð0; } 
	}
}

307 
size_t
 
	$size
(ècÚ¡ {  
_size
; 
	}
}

309 
	gCacheNode
& 
	gÝ”©Ü
 [] (
size_t
 
	gi
è{  
	g_ÿche
[
i
]; }

310 cÚ¡ 
	gCacheNode
& 
	gÝ”©Ü
 [](
size_t
 
	gi
ècÚ¡ {  
	g_ÿche
[
i
]; }

313 
boÞ
 
	$»ad
(cÚ¡ 
CacheKey
& 
k
, 
CacheD©a
& 
d
) const {

314 
size_t
 
i
 = 
	`k
(è% 
_size
;

315 ià(
k
 =ð
_ÿche
[
i
].
fœ¡
) {

316 
d
 = 
_ÿche
[
i
].
£cÚd
;

317  
Œue
;

319  
çl£
;

320 
	}
}

322 
	$wr™e
(cÚ¡ 
CacheKey
& 
k
, cÚ¡ 
CacheD©a
& 
d
) {

323 
size_t
 
i
 = 
	`k
(è% 
_size
;

324 
_ÿche
[
i
].
fœ¡
 = 
k
;

325 
_ÿche
[
i
].
£cÚd
 = 
d
;

326 
	}
}

328 
	g´iv©e
:

330 
size_t
 
_size
;

331 
CacheNode
* 
	g_ÿche
;

	@src/util/myHashSet.h

9 #iâdeà
MY_HASH_SET_H


10 
	#MY_HASH_SET_H


	)

12 
	~<veùÜ
>

14 
usšg
 
Çme¥aû
 
	g¡d
;

30 
	g‹m¶©e
 <
þass
 
	gD©a
>

31 þas 
	cHashS‘


33 
	mpublic
:

34 
	$HashS‘
(
size_t
 
b
 = 0è: 
	`_numBuck‘s
(0), 
	$_buck‘s
(0è{ ià(
b
 !ð0è
	`š™
(b); }

35 ~
	$HashS‘
(è{ 
	`»£t
(); 
	}
}

46 þas 
	c™”©Ü


48 
ä›nd
 
þass
 
	gHashS‘
<
	gD©a
>;

50 
	gpublic
:

51 
™”©Ü
(
HashS‘
* 
h
, 
D©a
* 
d
 = 0, 
size_t
 
i
 = 0, size_ˆ
j
 = 0)

52 : 
_hash
(
h
), 
_d©a
(
d
), 
_i
(
i
), 
_j
(
j
) {}

53 
™”©Ü
(cÚ¡ i‹¿tÜ& 
i
)

54 : 
_hash
(
i
._hash), 
_d©a
(i._d©a), 
_i
(i._i), 
_j
(i._j) {}

55 ~
™”©Ü
() {}

57 cÚ¡ 
	gD©a
& 
	gÝ”©Ü
 * (ècÚ¡ {  *
	g_d©a
; }

58 
	g™”©Ü
& 
	gÝ”©Ü
 = (cÚ¡ 
™”©Ü
& 
i
è{ 
_d©a
 = i._d©a; 
	g_i
 = i.
_i
; 
	g_j
 = i.
_j
;  *
	gthis
; }

59 
boÞ
 
	gÝ”©Ü
 !ð(cÚ¡ 
™”©Ü
& 
i
è{  
_d©a
 != i._data; }

60 
boÞ
 
	gÝ”©Ü
 =ð(cÚ¡ 
™”©Ü
& 
i
è{  
_d©a
 == i._data; }

62 
	g™”©Ü
& 
	gÝ”©Ü
 ++ () {

63 if(
	g_j
+1 < 
	g_hash
->
	g_buck‘s
[
_i
].
size
())

64 
	g_d©a
 = &
_hash
->
_buck‘s
[
_i
][++
_j
];

66 if(
	g_i
+1 >ð
_hash
->
_numBuck‘s
){ 
_d©a
 = 0; _˜ð
_j
 = 0;  *
	gthis
; }

67 
	g_j
 = 0;

68 
	g_hash
->
	g_buck‘s
[++
_i
].
em±y
())

69 if(
	g_i
 >ð
_hash
->
_numBuck‘s
-1è{ 
_d©a
 = 0; _˜ð0;  *
	gthis
; }

70 
	g_d©a
 = &
_hash
->
_buck‘s
[
_i
][
_j
];

72  *
	gthis
;

75 
™”©Ü
 
	gÝ”©Ü
 ++ () {

76 
™”©Ü
 
tmp
(*
this
);

77 if(
	g_j
+1 < 
	g_hash
->
	g_buck‘s
[
_i
].
size
())

78 
	g_d©a
 = &
_hash
->
_buck‘s
[
_i
][++
_j
];

80 if(
	g_i
+1 >ð
_hash
->
_numBuck‘s
è{ 
_d©a
 = 0; _˜ð
_j
 = 0;  *
	gthis
; }

81 
	g_j
 = 0;

82 
	g_hash
->
	g_buck‘s
[++
_i
].
em±y
())

83 if(
	g_i
 >ð
_hash
->
_numBuck‘s
-1è{ 
_d©a
 = 0; _˜ð0;  *
	gthis
; }

84 
	g_d©a
 = &
_hash
->
_buck‘s
[
_i
][
_j
];

86  
	gtmp
;

89 
	g™”©Ü
& 
	gÝ”©Ü
 -- () {

90 if(
	g_j
 > 0)

91 
	g_d©a
 = &
_hash
->
_buck‘s
[
_i
][--
_j
];

93 if(
	g_i
 =ð0è{ 
_d©a
 = 0; _˜ð
_j
 = 0;  *
	gthis
; }

94 
	g_hash
->
	g_buck‘s
[--
_i
].
em±y
())

95 if(
	g_i
 =ð0è{ 
_d©a
 = 0; _˜ð
_j
 = 0;  *
	gthis
; }

96 
	g_j
 = 
_buck‘s
[
_i
].
size
()-1;

97 
	g_d©a
 = &
_hash
->
_buck‘s
[
_i
][
_j
];

99  *
	gthis
;

102 
™”©Ü
 
	gÝ”©Ü
 -- () {

103 
™”©Ü
 
tmp
(*
this
);

104 if(
	g_j
 > 0)

105 
	g_d©a
 = &
_hash
->
_buck‘s
[
_i
][--
_j
];

107 if(
	g_i
 =ð0è{ 
_d©a
 = 0; _˜ð
_j
 = 0;  *
	gthis
; }

108 
	g_hash
->
	g_buck‘s
[--
_i
].
em±y
())

109 if(
	g_i
 =ð0è{ 
_d©a
 = 0; _˜ð
_j
 = 0;  *
	gthis
; }

110 
	g_j
 = 
_buck‘s
[
_i
].
size
()-1;

111 
	g_d©a
 = &
_hash
->
_buck‘s
[
_i
][
_j
];

113  
	gtmp
;

116 
	g´iv©e
:

117 cÚ¡ 
HashS‘
* 
_hash
;

118 
D©a
* 
	g_d©a
;

119 
size_t
 
	g_i
;

120 
size_t
 
	g_j
;

123 
	$š™
(
size_t
 
b
è{ 
_numBuck‘s
 = b; 
_buck‘s
 = 
Ãw
 
veùÜ
<
D©a
>[b]; 
	}
}

124 
	$»£t
() {

125 
_numBuck‘s
 = 0;

126 ià(
_buck‘s
è{ 
d–‘e
 [] _buckets; _buckets = 0; }

127 
	}
}

128 
	$þ—r
() {

129 
size_t
 
i
 = 0; i < 
_numBuck‘s
; ++iè
_buck‘s
[i].
	`þ—r
();

130 
	}
}

131 
size_t
 
	$numBuck‘s
(ècÚ¡ {  
_numBuck‘s
; 
	}
}

133 
	gveùÜ
<
	gD©a
>& 
	gÝ”©Ü
 [] (
size_t
 
	gi
è{  
	g_buck‘s
[
i
]; }

134 cÚ¡ 
	gveùÜ
<
	gD©a
>& 
	gÝ”©Ü
 [](
size_t
 
	gi
ècÚ¡ {  
	g_buck‘s
[
i
]; }

139 
™”©Ü
 
	$begš
() const {

140 
™”©Ü
 
	`™
(
cÚ¡_ÿ¡
<
HashS‘
<
D©a
>*>(
this
));

141 
size_t
 
i
=0; i<
_numBuck‘s
; ++i)

142 if(!
_buck‘s
[
i
].
	`em±y
())

143  
	`™”©Ü
(
cÚ¡_ÿ¡
<
HashS‘
<
D©a
>*>(
this
), &
_buck‘s
[
i
][0], i, 0);

144  
™
;

145 
	}
}

147 
™”©Ü
 
	$’d
(ècÚ¡ {  
	`™”©Ü
(
cÚ¡_ÿ¡
<
HashS‘
<
D©a
>*>(
this
)); 
	}
}

149 
boÞ
 
	$em±y
() const {

150 
size_t
 
i
=0; i<
_buck‘s
->
	`size
(); ++i)

151 if(!
_buck‘s
[
i
].
	`em±y
()è 
çl£
;

152  
Œue
;

153 
	}
}

155 
size_t
 
	$size
() const {

156 
size_t
 
s
 = 0;

157 
size_t
 
i
=0; i<
_numBuck‘s
; ++i)

158 
s
 +ð
_buck‘s
[
i
].
	`size
();

159  
s
;

160 
	}
}

165 
boÞ
 
	$check
(cÚ¡ 
D©a
& 
d
) const {

166 
size_t
 
num
 = 
	`buck‘Num
(
d
);

167 
size_t
 
i
=0; i<
_buck‘s
[
num
].
	`size
(); ++i)

168 if(
_buck‘s
[
num
][
i
] =ð
d
è 
Œue
;

169  
çl£
;

170 
	}
}

175 
boÞ
 
	$qu”y
(
D©a
& 
d
) const {

176 
size_t
 
num
 = 
	`buck‘Num
(
d
);

177 
size_t
 
i
=0; i<
_buck‘s
[
num
].
	`size
(); ++i)

178 if(
_buck‘s
[
num
][
i
] =ð
d
){

179 
d
 = 
_buck‘s
[
num
][
i
];

180  
Œue
;

182  
çl£
;

183 
	}
}

188 
boÞ
 
	$upd©e
(cÚ¡ 
D©a
& 
d
) {

189 
size_t
 
num
 = 
	`buck‘Num
(
d
);

190 
size_t
 
i
=0; i<
_buck‘s
[
num
].
	`size
(); ++i){

191 if(
_buck‘s
[
num
][
i
] =ð
d
){

192 if(
i
 =ð0è{ 
_buck‘s
[
num
][i] = 
d
;  
Œue
; }

193 
D©a
 
tmp
 = 
_buck‘s
[
num
][0];

194 
_buck‘s
[
num
][0] = 
d
;

195 
_buck‘s
[
num
][
i
] = 
tmp
;

196  
Œue
;

200 
D©a
 
tmp
 = 
_buck‘s
[
num
][0];

201 
_buck‘s
[
num
][0] = 
d
;

202 
_buck‘s
[
num
].
	`push_back
(
tmp
);

203  
çl£
;

204 
	}
}

208 
boÞ
 
	$š£¹
(cÚ¡ 
D©a
& 
d
) {

209 if(
	`check
(
d
)è 
çl£
;

211 
_buck‘s
[
	`buck‘Num
(
d
)].
	`push_back
(d);

212  
Œue
;

213 
	}
}

217 
boÞ
 
	$»move
(cÚ¡ 
D©a
& 
d
) {

218 
size_t
 
num
 = 
	`buck‘Num
(
d
);

219 
size_t
 
i
=0; i<
_buck‘s
[
num
].
	`size
(); ++i)

220 if(
_buck‘s
[
num
][
i
] =ð
d
){

221 
_buck‘s
[
num
].
	`”a£
(_buck‘s[num].
	`begš
()+
i
);

222  
Œue
;

224  
çl£
;

225 
	}
}

227 
	g´iv©e
:

229 
size_t
 
_numBuck‘s
;

230 
	gveùÜ
<
	gD©a
>* 
	g_buck‘s
;

232 
size_t
 
	$buck‘Num
(cÚ¡ 
D©a
& 
d
) const {

233  (
	`d
(è% 
_numBuck‘s
); 
	}
}

	@src/util/myString.cpp

8 
	~<¡ršg
>

9 
	~<ùy³.h
>

10 
	~<c¡ršg
>

11 
	~<ÿs£¹
>

13 
usšg
 
Çme¥aû
 
	g¡d
;

23 
	$mySŒNCmp
(cÚ¡ 
¡ršg
& 
s1
, cÚ¡ sŒšg& 
s2
, 
n
)

25 
	`as£¹
(
n
 > 0);

26 
n2
 = 
s2
.
	`size
();

27 ià(
n2
 == 0)  -1;

28 
n1
 = 
s1
.
	`size
();

29 
	`as£¹
(
n1
 >ð
n
);

30 
i
 = 0; i < 
n1
; ++i) {

31 ià(
i
 =ð
n2
)

32  (
i
 < 
n
)? 1 : 0;

33 
ch1
 = (
	`isuµ”
(
s1
[
i
]))? 
	`tÞow”
(s1[i]) : s1[i];

34 
ch2
 = (
	`isuµ”
(
s2
[
i
]))? 
	`tÞow”
(s2[i]) : s2[i];

35 ià(
ch1
 !ð
ch2
)

36  (
ch1
 - 
ch2
);

38  (
n1
 - 
n2
);

39 
	}
}

47 
size_t


48 
mySŒG‘Tok
(cÚ¡ 
¡ršg
& 
¡r
, sŒšg& 
tok
, 
size_t
 
pos
 = 0,

49 cÚ¡ 
d–
 = ' ')

51 
size_t
 
begš
 = 
¡r
.
fšd_fœ¡_nÙ_of
(
d–
, 
pos
);

52 ià(
	gbegš
 =ð
¡ršg
::
Åos
è{ 
tok
 = "";  begin; }

53 
size_t
 
	g’d
 = 
¡r
.
fšd_fœ¡_of
(
d–
, 
begš
);

54 
	gtok
 = 
¡r
.
sub¡r
(
begš
, 
’d
 - begin);

55  
	g’d
;

61 
boÞ


62 
	$mySŒ2IÁ
(cÚ¡ 
¡ršg
& 
¡r
, & 
num
)

64 
num
 = 0;

65 
size_t
 
i
 = 0;

66 
sign
 = 1;

67 ià(
¡r
[0] =ð'-'è{ 
sign
 = -1; 
i
 = 1; }

68 
boÞ
 
v®id
 = 
çl£
;

69 ; 
i
 < 
¡r
.
	`size
(); ++i) {

70 ià(
	`isdig™
(
¡r
[
i
])) {

71 
num
 *= 10;

72 
num
 +ð(
¡r
[
i
] - '0');

73 
v®id
 = 
Œue
;

75  
çl£
;

77 
num
 *ð
sign
;

78  
v®id
;

79 
	}
}

85 
boÞ


86 
	$isV®idV¬Name
(cÚ¡ 
¡ršg
& 
¡r
)

88 
size_t
 
n
 = 
¡r
.
	`size
();

89 ià(
n
 =ð0è 
çl£
;

90 ià(!
	`i§Íha
(
¡r
[0]) && str[0] != '_')

91  
çl£
;

92 
size_t
 
i
 = 1; i < 
n
; ++i)

93 ià(!
	`i§Êum
(
¡r
[
i
]) && str[i] != '_')

94  
çl£
;

95  
Œue
;

96 
	}
}

	@src/util/myUsage.h

9 #iâdeà
MY_USAGE_H


10 
	#MY_USAGE_H


	)

12 
	~<uni¡d.h
>

13 
	~<io¡»am
>

14 
	~<iomª
>

15 
	~<sys/times.h
>

16 
	~<sys/»sourû.h
>

18 
usšg
 
Çme¥aû
 
	g¡d
;

21 #undeà
MYCLK_TCK


22 
	#MYCLK_TCK
 
	`syscÚf
(
_SC_CLK_TCK
)

	)

25 þas 
	cMyU§ge


27 
	mpublic
:

28 
	$MyU§ge
(è{ 
	`»£t
(); }

30 
	$»£t
() {

31 
_š™Mem
 = 
	`checkMem
();

32 
_cu¼’tTick
 = 
	`checkTick
();

33 
_³riodU£dTime
 = 
_tÙ®U£dTime
 = 0.0;

34 
	}
}

36 
	$»pÜt
(
boÞ
 
»pTime
, boÞ 
»pMem
) {

37 ià(
»pTime
) {

38 
	`£tTimeU§ge
();

39 
cout
 << "P”iodimu£d : " << 
	`£»cisiÚ
(4)

40 << 
_³riodU£dTime
 << " secÚds" << 
’dl
;

41 
cout
 << "TÙ®imu£d : " << 
	`£»cisiÚ
(4)

42 << 
_tÙ®U£dTime
 << " secÚds" << 
’dl
;

44 ià(
»pMem
) {

45 
	`£tMemU§ge
();

46 
cout
 << "TÙ® memÜy u£d: " << 
	`£»cisiÚ
(4)

47 << 
_cu¼’tMem
 << " M By‹s" << 
’dl
;

49 
	}
}

51 
	g´iv©e
:

53 
_š™Mem
;

54 
	g_cu¼’tMem
;

57 
	g_cu¼’tTick
;

58 
	g_³riodU£dTime
;

59 
	g_tÙ®U£dTime
;

62 
	$checkMem
() const {

63 
ru§ge
 
u§ge
;

64 if(0 =ð
	`g‘ru§ge
(
RUSAGE_SELF
, &
u§ge
))

65 #ifdeà
__APPLE__


66  
u§ge
.
ru_maxrss
/(1<<20);

68  
u§ge
.
ru_maxrss
/(1<<10);

72 
	}
}

73 
	$checkTick
() const {

74 
tms
 
tBufãr
;

75 
	`times
(&
tBufãr
);

76  
tBufãr
.
tms_utime
;

77 
	}
}

78 
	$£tMemU§ge
(è{ 
_cu¼’tMem
 = 
	`checkMem
(è- 
_š™Mem
; 
	}
}

79 
	$£tTimeU§ge
() {

80 
thisTick
 = 
	`checkTick
();

81 
_³riodU£dTime
 = (
thisTick
 - 
_cu¼’tTick
è/ (
MYCLK_TCK
);

82 
_tÙ®U£dTime
 +ð
_³riodU£dTime
;

83 
_cu¼’tTick
 = 
thisTick
;

84 
	}
}

	@src/util/rnGen.h

8 #iâdeà
RN_GEN_H


9 
	#RN_GEN_H


	)

11 
	~<uni¡d.h
>

12 
	~<sys/ty³s.h
>

13 
	~<¡dlib.h
>

14 
	~<lim™s.h
>

16 
	#my_¤ªdom
 
¤ªdom


	)

17 
	#my_¿ndom
 
¿ndom


	)

19 þas 
	cRªdomNumG’


21 
	mpublic
:

22 
	$RªdomNumG’
(è{ 
	`my_¤ªdom
(
	`g‘pid
()); }

23 
	$RªdomNumG’
(
£ed
è{ 
	`my_¤ªdom
(£ed); 
	}
}

24 cÚ¡ 
	$Ý”©Ü
(è(cÚ¡ 
¿nge
) const {

25  (
¿nge
 * ((
	`my_¿ndom
()è/ 
INT_MAX
));

26 
	}
}

	@src/util/util.cpp

8 
	~<sys/ty³s.h
>

9 
	~<dœ’t.h
>

10 
	~<”ºo.h
>

11 
	~<veùÜ
>

12 
	~<¡ršg
>

13 
	~<c¡ršg
>

14 
	~<io¡»am
>

15 
	~<iomª
>

16 
	~<®gÜ™hm
>

17 
	~"ºG’.h
"

18 
	~"myU§ge.h
"

20 
usšg
 
Çme¥aû
 
	g¡d
;

26 
RªdomNumG’
 
ºG’
(0);

27 
MyU§ge
 
	gmyU§ge
;

37 
	gli¡Dœ


38 (
	gveùÜ
<
	g¡ršg
>& 
	gfžes
, cÚ¡ sŒšg& 
	g´efix
, cÚ¡ sŒšg& 
	gdœ
 = ".")

40 
DIR
 *
dp
;

41 
dœ’t
 *
	gdœp
;

42 ià((
	gdp
 = 
Ý’dœ
(
dœ
.
c_¡r
())è=ð
NULL
) {

43 
û¼
 << "E¼Ü(" << 
”ºo
 << "): fažedØÝ’ " << 
dœ
 << "!!\n";

44  
	g”ºo
;

47 cÚ¡ *
	gµ
 = 
´efix
.
size
()?…»fix.
c_¡r
(): 0;

48 (
	gdœp
 = 
»addœ
(
dp
)è!ð
NULL
) {

49 ià(
¡ršg
(
dœp
->
d_Çme
) == "." ||

50 
¡ršg
(
dœp
->
d_Çme
) == "..") ;

51 ià(!
	gµ
 || 
¡ºcmp
(
dœp
->
d_Çme
, 
µ
, 
´efix
.
size
()) == 0)

52 
fžes
.
push_back
(
¡ršg
(
dœp
->
d_Çme
));

54 
sÜt
(
fžes
.
begš
(), fžes.
’d
());

55 
þo£dœ
(
dp
);

59 
size_t
 
	$g‘HashSize
(
size_t
 
s
) {

60 ià(
s
 < 8)  7;

61 ià(
s
 < 16)  13;

62 ià(
s
 < 32)  31;

63 ià(
s
 < 64)  61;

64 ià(
s
 < 128)  127;

65 ià(
s
 < 512)  509;

66 ià(
s
 < 2048)  1499;

67 ià(
s
 < 8192)  4999;

68 ià(
s
 < 32768)  13999;

69 ià(
s
 < 131072)  59999;

70 ià(
s
 < 524288)  100019;

71 ià(
s
 < 2097152)  300007;

72 ià(
s
 < 8388608)  900001;

73 ià(
s
 < 33554432)  1000003;

74 ià(
s
 < 134217728)  3000017;

75 ià(
s
 < 536870912)  5000011;

77 
	}
}

	@src/util/util.h

8 #iâdeà
UTIL_H


9 
	#UTIL_H


	)

11 
	~<i¡»am
>

12 
	~<veùÜ
>

13 
	~"ºG’.h
"

14 
	~"myU§ge.h
"

16 
usšg
 
Çme¥aû
 
	g¡d
;

19 
RªdomNumG’
 
ºG’
;

20 
MyU§ge
 
myU§ge
;

23 
mySŒNCmp
(cÚ¡ 
¡ršg
& 
s1
, cÚ¡ sŒšg& 
s2
, 
n
);

24 
size_t
 
mySŒG‘Tok
(cÚ¡ 
¡ršg
& 
¡r
, sŒšg& 
tok
, size_ˆ
pos
 = 0,

25 cÚ¡ 
d–
 = ' ');

26 
boÞ
 
mySŒ2IÁ
(cÚ¡ 
¡ršg
& 
¡r
, & 
num
);

27 
boÞ
 
isV®idV¬Name
(cÚ¡ 
¡ršg
& 
¡r
);

30 
myG‘Ch¬
(
i¡»am
&);

31 
myG‘Ch¬
();

34 
li¡Dœ
(
veùÜ
<
¡ršg
>&, const string&, const string&);

35 
size_t
 
g‘HashSize
(size_ˆ
s
);

38 
	g‹m¶©e
<
þass
 
	gT
>

39 
	$þ—rLi¡
(
T
& 
l
)

41 
T
 
tmp
;

42 
l
.
	`sw­
(
tmp
);

43 
	}
}

45 
	g‹m¶©e
<
þass
 
	gT
, cÏs 
	gD
>

46 
	$»moveD©a
(
T
& 
l
, cÚ¡ 
D
& 
d
)

48 
size_t
 
des
 = 0;

49 
size_t
 
i
 = 0, 
n
 = 
l
.
	`size
(); i <‚; ++i) {

50 ià(
l
[
i
] !ð
d
) {

51 ià(
i
 !ð
des
è
l
[des] =†[i];

52 ++
des
;

56 
l
.
	`»size
(
des
);

57 
	}
}

	@
1
.
0
34
631
src/cir/cirCmd.cpp
src/cir/cirCmd.h
src/cir/cirDef.h
src/cir/cirFraig.cpp
src/cir/cirGate.cpp
src/cir/cirGate.h
src/cir/cirMgr.cpp
src/cir/cirMgr.h
src/cir/cirOpt.cpp
src/cir/cirSim.cpp
src/cmd/cmdCharDef.h
src/cmd/cmdParser.h
src/main/main.cpp
src/sat/File.cpp
src/sat/File.h
src/sat/Global.h
src/sat/Heap.h
src/sat/Proof.cpp
src/sat/Proof.h
src/sat/Solver.cpp
src/sat/Solver.h
src/sat/SolverTypes.h
src/sat/Sort.h
src/sat/VarOrder.h
src/sat/sat.h
src/sat/test/satTest.cpp
src/util/myGetChar.cpp
src/util/myHashMap.h
src/util/myHashSet.h
src/util/myString.cpp
src/util/myUsage.h
src/util/rnGen.h
src/util/util.cpp
src/util/util.h
